// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/AddData/search/SearchContext":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(q,l){return q(null,{allowArcGISOnline:!0,arcgisOnlinePortal:null,orgId:null,portal:null,username:null,constructor:function(n){l.mixin(this,n)}})})},"widgets/AddData/search/util":function(){define(["dojo/_base/array"],function(q){return{checkMixedContent:function(l){"string"===typeof window.location.href&&0===window.location.href.indexOf("https://")&&"string"===typeof l&&0===l.indexOf("http://")&&
(l="https:"+l.substring("5"));return l},escapeForLucene:function(l){return l.replace(RegExp('(\\+|\\-|\\\x26|\\!|\\(|\\)|\\{|\\}|\\[|\\]|\\^|\\"|\\~|\\*|\\?|\\:|\\\\)',"g"),"\\$1")},findLayersAdded:function(l,n){var e=[],k=[],u=[],d={itemIds:k,layers:u};if(!l)return d;var t="string"===typeof n&&0<n.length;q.forEach(l.layerIds,function(c){e.push(c)});q.forEach(l.graphicsLayerIds,function(c){e.push(c)});q.forEach(e,function(c){if((c=l.getLayer(c))&&("string"===typeof c.xtnItemId&&0<c.xtnItemId.length)&&
(!t||c.xtnItemId===n))u.push(c),-1===k.indexOf(c.xtnItemId)&&k.push(c.xtnItemId)});return d},setNodeText:function(l,n){l.innerHTML="";n&&l.appendChild(document.createTextNode(n))}}})},"widgets/AddData/search/SearchPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SearchPane.html dojo/i18n!../nls/strings jimu/dijit/TabContainer3 ./AddFromUrlPane ./SearchBox ./BBoxOption ./ScopeOptions ./TypeOptions ./SortOptions ./ResultsPane ./Paging ./ResultCount".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E){return q([d,t,c],{i18n:x,templateString:g,qDefaultFilter:null,qRequiredFilter:null,searchOnStart:!0,searchContext:null,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);n.forEach(this.getComponents(),function(c){c.searchPane=this},this);this.initTabs()},startup:function(){this._started||(this.inherited(arguments),this.bindEvents(),this.initOptions(),this.searchOnStart&&this.search())},initTabs:function(){this.addFromUrlPane=new E({searchPane:this});
e.place(this.addFromUrlPane.domNode,this.urlPane);this.tab=new A({tabs:[{title:this.nls.search.searchBox.search,content:this.onlinePane},{title:this.nls.search.url,content:this.urlPane}]},this.tabNode);e.place(this.tab.domNode,this.domNode)},_onFilterPlaceholderChanged:function(){u.contains(this.filterPlaceholder,"opened")?(u.remove(this.filterPlaceholder,"opened"),u.remove(this.filterWrapper,"show")):(this.filterWrapper.style.top=this.headerNode.clientHeight+"px",u.add(this.filterPlaceholder,"opened"),
u.add(this.filterWrapper,"show"))},_onSearchBoxPlaceholderChanged:function(){this.searchBox&&(u.contains(this.searchBoxPlaceholder,"opened")?(u.remove(this.searchBoxPlaceholder,"opened"),u.remove(this.searchBox.domNode,"show")):(u.add(this.searchBoxPlaceholder,"opened"),u.add(this.searchBox.domNode,"show"),this.searchBox.searchTextBox.focus()))},bindEvents:function(){this.own(k(this.filterPlaceholder,"click",l.hitch(this,this._onFilterPlaceholderChanged)));this.own(k(this.searchBoxPlaceholder,"click",
l.hitch(this,this._onSearchBoxPlaceholderChanged)))},buildQueryParams:function(c){var d=null;"string"===typeof this.qRequiredFilter&&0<this.qRequiredFilter.length&&(d=this.qRequiredFilter);var g={q:d,canSortByRelevance:!1};n.forEach(this.getComponents(),function(d){d.appendQueryParams(g,c)});delete g.canSortByRelevance;null===g.q&&("string"===typeof this.qDefaultFilter&&0<this.qDefaultFilter.length)&&(g.q=this.qDefaultFilter);return g},getComponents:function(){return[this.searchBox,this.bboxOption,
this.scopeOptions,this.typeOptions,this.sortOptions,this.resultsPane,this.paging,this.resultCount]},initOptions:function(){},resize:function(){this.contentNode.style.top=this.headerNode.clientHeight+1+"px";this.contentNode.style.bottom=this.footerNode.clientHeight+1+"px"},search:function(){var c=this,d={},g=this.buildQueryParams(d);if(!(null===g||null===g.q)){g&&null===g.sortField&&(g.sortOrder="desc");var t=this.searchContext.portal;d.scopeIsArcGISOnline&&this.searchContext.arcgisOnlinePortal&&(t=
this.searchContext.arcgisOnlinePortal);null!==this._dfd&&this._dfd.cancel("Search aborted.",!1);var b=null;this._dfd=b=t.queryItems(g).then(function(v){b.isCanceled()||(v.queryParams||(v.queryParams={start:v.start,num:v.num},!v.nextQueryParams&&("undefined"!==typeof v.nextStart&&-1!==v.nextStart)&&(v.nextQueryParams={start:v.nextStart})),n.forEach(c.getComponents(),function(b){b.processResults(v)}))}).otherwise(function(b){console.warn("searchError",b)})}}})})},"widgets/AddData/search/AddFromUrlPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/Deferred dojo/promise/all dojo/dom-class dojo/window dijit/Viewport dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromUrlPane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/CSVLayer esri/layers/FeatureLayer esri/layers/GeoRSSLayer esri/layers/KMLLayer esri/layers/StreamLayer esri/layers/VectorTileLayer esri/layers/WFSLayer esri/layers/WMSLayer esri/layers/WMTSLayer esri/InfoTemplate".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C,b,v,H,s,f,G,z,w,a,m,p,h,r){return q([x,A,E],{i18n:B,templateString:F,searchPane:null,_dfd:null,postCreate:function(){this.inherited(arguments);this._updateExamples("ArcGIS");var a=this;this.own(e(this.urlTextBox,"keyup",function(h){h.keyCode===k.ENTER?a.addClicked():t.contains(a.addButton,"disabled")||C.setNodeText(a.messageNode,"")}));this.own(e(this.typeSelect,"change",function(h){a._updateExamples(h)}));this.own(e(this.typeSelect.dropDown,"open",function(){var a=
this.domNode.parentElement;a&&t.add(a,"add-data-widget-popup")}));this.own(g.on("resize",a.resize()))},destroy:function(){this.inherited(arguments)},addClicked:function(){var a=this,h=!1,m=this.addButton;if(!t.contains(m,"disabled")){var r=this.typeSelect.get("value"),p=l.trim(this.urlTextBox.value);if(0<p.length&&(0===p.indexOf("http://")||0===p.indexOf("https://")))h=!0;h&&(t.add(m,"disabled"),C.setNodeText(a.messageNode,B.search.item.messages.adding),h=new u,this._handleAdd(h,this.searchPane.wabWidget.map,
r,p),h.then(function(h){h?C.setNodeText(a.messageNode,""):C.setNodeText(a.messageNode,B.search.item.messages.addFailed);t.remove(m,"disabled")}).otherwise(function(h){"string"===typeof h&&"Unsupported"===h?(C.setNodeText(a.messageNode,B.search.item.messages.unsupported),t.remove(m,"disabled")):(console.warn("Add layer failed."),console.warn(h),C.setNodeText(a.messageNode,B.search.item.messages.addFailed),t.remove(m,"disabled"),h&&("string"===typeof h.message&&0<h.message.length)&&console.log(""))}))}},
examplesExpanderClicked:function(){t.toggle(this.examplesNode,"show")},preHide:function(){},resize:function(){var a=c.getBox(this.ownerDocument);a&&"undefined"!==typeof a.w&&(600<a.w?t.add(this.urlTextBox,"url-textbox-wide"):t.remove(this.urlTextBox,"url-textbox-wide"))},_checkVTSupport:function(){var a=new u;require(["esri/layers/vector-tile"],function(h){h=h.supported();a.resolve(h)});return a},_handleAdd:function(D,c,g,t){t=C.checkMixedContent(t);var k=t.toLowerCase(),e=new y,A=e._generateLayerId(),
E=this,x=null;"ArcGIS"===g?0<k.indexOf("/featureserver")||0<k.indexOf("/mapserver")?e._readRestInfo(t).then(function(a){if(a&&"string"===typeof a.type&&"Feature Layer"===a.type)x=new f(t,{id:A,outFields:["*"],infoTemplate:new r}),E._waitThenAdd(D,c,g,e,x);else if(0<k.indexOf("/featureserver")){var h=[];n.forEach(a.layers,function(a){a=new f(t+"/"+a.id,{id:e._generateLayerId(),outFields:["*"],infoTemplate:new r});h.push(e._waitForLayer(a))});d(h).then(function(a){var h=[];n.forEach(a,function(a){h.push(a)});
h.reverse();n.forEach(h,function(a){e._setFeatureLayerInfoTemplate(a);c.addLayer(a)});D.resolve(h)}).otherwise(function(a){D.reject(a)})}else 0<k.indexOf("/mapserver")&&(x=a.tileInfo?new H(t,{id:A}):new b(t,{id:A}),E._waitThenAdd(D,c,g,e,x))}).otherwise(function(a){D.reject(a)}):0<k.indexOf("/imageserver")?(x=new v(t,{id:A}),this._waitThenAdd(D,c,g,e,x)):0<k.indexOf("/vectortileserver")||0<k.indexOf("/resources/styles/root.json")?this._checkVTSupport().then(l.hitch(this,function(h){h?e._checkVectorTileUrl(t,
{}).then(function(h){x=new a(h,{id:A});E._waitThenAdd(D,c,g,e,x)}).otherwise(function(a){D.reject(a)}):D.reject("Unsupported")})):0<k.indexOf("/streamserver")?(x=new w(t,{id:A,purgeOptions:{displayCount:1E4},infoTemplate:new r}),this._waitThenAdd(D,c,g,e,x)):D.reject("Unsupported"):"WMS"===g?(x=new p(t,{id:A}),this._waitThenAdd(D,c,g,e,x)):"WMTS"===g?x=new h(t,{id:A}):"WFS"===g?(x=new m({id:A,url:t,infoTemplate:new r}),this._waitThenAdd(D,c,g,e,x),console.warn("WFSLayer",x)):"KML"===g?(x=new z(t,
{id:A}),this._waitThenAdd(D,c,g,e,x)):"GeoRSS"===g?(x=new G(t,{id:A}),this._waitThenAdd(D,c,g,e,x)):"CSV"===g&&(x=new s(t,{id:A}),x.setInfoTemplate(e._newInfoTemplate()),this._waitThenAdd(D,c,g,e,x))},_persist:function(){try{var a=this.typeSelect.get("value"),h=l.trim(this.urlTextBox.value);this.searchPane.wabWidget.xtnAddFromUrlPane={type:a,url:h}}catch(m){}},_restore:function(){try{var a=this.searchPane.wabWidget.xtnAddFromUrlPane;a&&("string"===typeof a.type&&0<a.type.length)&&this.typeSelect.set("value",
a.type);a&&("string"===typeof a.url&&0<a.url.length)&&(this.urlTextBox.value=a.url)}catch(h){}},_updateExamples:function(a){n.forEach(this.examplesNode.children,function(h){var m=h.getAttribute("data-examples-type");"string"===typeof m&&0<m.length&&(h.style.display=m===a?"":"none")})},_waitThenAdd:function(a,h,m,r,p){r._waitForLayer(p).then(function(p){if("WMS"===m)r._setWMSVisibleLayers(p);else if(!p||!("esri.layers.ArcGISDynamicMapServiceLayer"===p.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===
p.declaredClass))p&&"esri.layers.FeatureLayer"===p.declaredClass?r._setFeatureLayerInfoTemplate(p):p&&"esri.layers.CSVLayer"===p.declaredClass&&r._setFeatureLayerInfoTemplate(p);h.addLayer(p);a.resolve(p)}).otherwise(function(h){a.reject(h)})}})})},"widgets/AddData/search/LayerLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/json dojo/i18n!../nls/strings ./util esri/lang esri/request esri/arcgis/utils esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/FeatureLayer esri/layers/ImageServiceParameters esri/layers/KMLLayer esri/layers/MosaicRule esri/layers/RasterFunction esri/layers/VectorTileLayer esri/layers/WMSLayer esri/dijit/PopupTemplate esri/InfoTemplate esri/renderers/jsonUtils jimu/utils".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C,b,v,H,s,f,G,z,w){return q(null,{item:null,itemUrl:null,map:null,serviceUrl:null,constructor:function(a){l.mixin(this,a)},addItem:function(a,m){var p=new k;this.map=m;this.item=a;this.itemUrl=this._checkMixedContent(a.itemUrl);this.serviceUrl=this._checkMixedContent(a.url);if("Feature Service"===a.type)return this._addFeatureService();if("Image Service"===a.type)return this._addImageService();if("KML"===a.type)return this._addKML();if("Map Service"===a.type)return this._addMapService();
if("Vector Tile Service"===a.type)return this._addVectorTileService();if("WMS"===a.type)return this._addWMS();console.warn("Unsupported item type: ",a.type);p.resolve(null);return p},_addFeatureService:function(){var a=this,m=new k,p=this.serviceUrl,h=this.item,r={},f=null,z=[],b=[];a._readItemJsonData().then(function(h){(r=h||{})&&(r.layers&&0<r.layers.length)&&n.forEach(r.layers,function(a){"undefined"!==typeof a.id&&null!==a.id&&(null===f&&(f=[]),f.push(a.id))});return a._readRestInfo(p)}).then(function(h){h&&
"string"===typeof h.type&&"Feature Layer"===h.type?(h=new B(p,{id:a._generateLayerId(),outFields:["*"]}),z.push(a._waitForLayer(h))):h&&(h.layers&&0<h.layers.length)&&n.forEach(h.layers,function(h){var m=!0;null!==f&&0<f.length&&(m=n.some(f,function(a){return a===h.id}));m&&(m=new B(p+"/"+h.id,{id:a._generateLayerId(),outFields:["*"]}),z.push(a._waitForLayer(m)))});return e(z)}).then(function(a){n.forEach(a,function(a){b.push(a)});b.reverse();return b}).then(function(){n.forEach(b,function(m){var p=
a._processFeatureLayer(m,h,r);m.arcgisProps={title:p.title};m._titleForLegend=p.title;c.isDefined(m.title)||(m.title=p.title);a._addLayer(m)})}).then(function(){m.resolve(b)}).otherwise(function(a){m.reject(a)});return m},_addImageService:function(){var a=this,m=new k;a._readItemJsonData().then(function(m){return a._newImageServiceLayer(m||{})}).then(function(p){a._addLayer(p);m.resolve(p)}).otherwise(function(a){m.reject(a)});return m},_addKML:function(){var a=this,m=new k;a._newKMLLayer().then(function(p){p&&
(p.title=a.item.title);a._addLayer(p);m.resolve(p)}).otherwise(function(a){m.reject(a)});return m},_addMapService:function(){var a=this,m=new k;a._readItemJsonData().then(function(m){return a._newMapServiceLayer(m||{})}).then(function(p){a._addLayer(p);m.resolve(p)}).otherwise(function(a){m.reject(a)});return m},_addVectorTileService:function(){var a=this,m=new k;a._newVectorTileLayer().then(function(p){a._addLayer(p);m.resolve(p)}).otherwise(function(a){m.reject(a)});return m},_addWMS:function(){var a=
this,m=new k;a._readItemJsonData().then(function(m){return a._newWMSLayer(m||{})}).then(function(p){p&&(p.title=a.item.title);a._addLayer(p);m.resolve(p)}).otherwise(function(a){m.reject(a)});return m},_addLayer:function(a){var m=this.item;a&&(a.xtnItemId=m.id,!a.arcgisProps&&m&&(a.arcgisProps={title:m.title},a._titleForLegend=m.title),c.isDefined(a.title)||(a.title=m.title),this.map.addLayer(a))},_checkMixedContent:function(a){return t.checkMixedContent(a)},_checkUrl:function(a){return x._checkUrl(a)},
_checkVectorTileUrl:function(a,m){var p=new k;if(-1!==a.indexOf(".json",a.length-5))return m.styleUrl=a,p.resolve(a),p;var h={url:null,content:{},handleAs:"json",callbackParamName:"callback"};this.itemUrl?(h.url=this.itemUrl+"/resources/styles/root.json",g(h,{}).then(function(){m.styleUrl=h.url;p.resolve(h.url)}).otherwise(function(){h.url=a+"/resources/styles/root.json";g(h,{}).then(function(){m.styleUrl=h.url;p.resolve(h.url)}).otherwise(function(){m.url=a;p.resolve(a)})})):(h.url=a+"/resources/styles/root.json",
g(h,{}).then(function(){m.styleUrl=h.url;p.resolve(h.url)}).otherwise(function(){m.url=a;p.resolve(a)}));return p},_generateLayerId:function(){return this._generateLayerIds(1)[0]},_generateLayerIds:function(a){var m,p=[];for(m=0;m<a;m++)p.push(this._generateRandomId());return p},_generateRandomId:function(){var a=null,a="function"===typeof Date.now?Date.now():(new Date).getTime(),m=(""+Math.random()).replace("0.","r");return(a+""+m).replace(/-/g,"")},_makeFeatureLayerTitle:function(a,m,p){var h,r,
f;try{if(m&&p&&m===p||m&&p&&(h=p.indexOf(m),0===h&&(r=p.substring(h+m.length+1),13<=r.length&&(f=/^\d+$/,f.test(r)))))return m}catch(z){}return a.replace("{serviceName}",m).replace("{layerName}",p)},_newImageServiceLayer:function(a){var m=new k,p=this._generateLayerId(),h=this.serviceUrl,r={mapLayerId:p,bandIds:null,format:null,compressionQuality:null,opacity:1,visibility:!0};c.isDefined(a.visibility)&&!1===a.visibility&&(r.visibility=!1);c.isDefined(a.opacity)&&(r.opacity=a.opacity);c.isDefined(a.minScale)&&
!c.isDefined(r.minScale)&&(r.minScale=a.minScale);c.isDefined(a.maxScale)&&!c.isDefined(r.maxScale)&&(r.maxScale=a.maxScale);c.isDefined(a.refreshInterval)&&!c.isDefined(r.refreshInterval)&&(r.refreshInterval=a.refreshInterval);a.popupInfo&&(!r.popupInfo&&!r.disablePopup)&&(r.popupInfo=a.popupInfo);a.renderingRule&&!r.renderingRule&&(r.renderingRule=a.renderingRule,a.renderingRule.functionName&&(r.renderingRule.rasterFunction=a.renderingRule.functionName));a.bandIds&&!r.bandIds&&(r.bandIds=a.bandIds);
a.mosaicRule&&!r.mosaicRule&&(r.mosaicRule=a.mosaicRule);a.format&&!r.format&&(r.format=a.format);c.isDefined(a.compressionQuality)&&!c.isDefined(r.compressionQuality)&&(r.compressionQuality=a.compressionQuality);if(a.layerDefinition&&a.layerDefinition.definitionExpression&&(!c.isDefined(r.layerDefinition)||!c.isDefined(r.layerDefinition.definitionExpression)))r.layerDefinition=r.layerDefinition||{},r.layerDefinition.definitionExpression=a.layerDefinition.definitionExpression;a=new y;null!==r.bandIds&&
(a.bandIds=r.bandIds);null!==r.format&&(a.format=r.format,null!==r.compressionQuality&&(a.compressionQuality=r.compressionQuality));r.renderingRule&&r.renderingRule.rasterFunction&&(p=new v(r.renderingRule),a.renderingRule=p);r.mosaicRule&&(p=new b(r.mosaicRule),a.mosaicRule=p);c.isDefined(r.noData)&&(a.noData=r.noData);c.isDefined(r.noDataInterpretation)&&(a.noDataInterpretation=r.noDataInterpretation);c.isDefined(r.interpolation)&&(a.interpolation=r.interpolation);a={imageServiceParameters:a,opacity:r.opacity,
visible:r.visibility};c.isDefined(r.mapLayerId)&&(a.id=r.mapLayerId);c.isDefined(r.minScale)&&(a.minScale=r.minScale);c.isDefined(r.maxScale)&&(a.maxScale=r.maxScale);c.isDefined(r.refreshInterval)&&(a.refreshInterval=r.refreshInterval);c.isDefined(r.resourceInfo)&&(a.resourceInfo=r.resourceInfo);h=new E(this._checkUrl(h),a);this._waitForLayer(h).then(function(a){r.layerDefinition&&r.layerDefinition.definitionExpression&&a.setDefinitionExpression(r.layerDefinition.definitionExpression,!0);m.resolve(a)},
function(a){m.reject(a)});return m},_newInfoTemplate:function(a,m){if(a)try{return new f({description:a.description,title:a.title,showAttachments:a.showAttachments,fieldInfos:a.fieldInfos,mediaInfos:a.mediaInfos})}catch(p){console.error(p)}var h=new G;c.isDefined(m)&&h.setTitle(m);return h},_newKMLLayer:function(){var a={id:this._generateLayerId()},a=new C(this.serviceUrl,a);return this._waitForLayer(a)},_newMapServiceLayer:function(a){var m=this,p=new k,h=this.serviceUrl,r=this._generateLayerId();
g({url:h,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{}).then(function(f){var z=null,z={id:r},z=f.tileInfo?new F(h,z):new A(h,z);m._waitForLayer(z).then(function(h){var r=null;n.forEach(h.layerInfos,function(h){var p=null;a&&n.some(a.layers,function(a){if(h.id===a.id)return p=a,!0});var f=null;p&&p.popupInfo&&(f=p.popupInfo);f&&(null===r&&(r={}),r[h.id]={infoTemplate:m._newInfoTemplate(f,h.name)})});null===h.infoTemplates&&r&&(h.infoTemplates=r);p.resolve(h)},function(a){p.reject(a)})},
function(a){p.reject(a)});return p},_newPopupInfo:function(a,m){if(a&&a.fields){var p={title:a.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]};"string"===typeof m&&0<m.length&&(p.title=m);n.forEach(a.fields,function(a){var m=w.getDefaultPortalFieldInfo(a);m.visible=!0;m.isEditable=a.editable;p.fieldInfos.push(m)});return p}return null},_newVectorTileLayer:function(){var a=this,m=new k,p={},h=this.serviceUrl,r=this._generateLayerId();"string"===typeof h&&0<h.length?this._checkVectorTileUrl(h,
p).then(function(h){"string"===typeof h&&0<h.length?(h=a._checkMixedContent(h),h=new H(h,{id:r,opacity:1,visible:!0}),a._waitForLayer(h).then(function(a){m.resolve(a)},function(a){m.reject(a)})):m.resolve(null)},function(a){m.reject(a)}):m.resolve(null);return m},_newWMSLayer:function(){var a={id:this._generateLayerId()},a=new s(this.serviceUrl,a),m=this,a=this._waitForLayer(a);a.then(function(a){m._setWMSVisibleLayers(a)});return a},_processFeatureLayer:function(a,m,p){var h=this,r=d.search.featureLayerTitlePattern,
b=null;p&&p.layers&&0<p.layers.length?n.some(p.layers,function(p){var w,v,G,s=!1;if(p.id===a.layerId){p.popupInfo&&(w=p.popupInfo,w=u.parse(u.stringify(w)),w=new f(w),a.setInfoTemplate(w),s=!0);c.isDefined(p.showLabels)&&a.setShowLabels(p.showLabels);c.isDefined(p.refreshInterval)&&a.setRefreshInterval(p.refreshInterval);c.isDefined(p.showLegend)&&console.log("");c.isDefined(p.timeAnimation)&&!1===p.timeAnimation&&console.log("");if(w=p.layerDefinition)w.definitionExpression&&a.setDefinitionExpression(w.definitionExpression),
w.displayField&&a.displayField(w.displayField),w.drawingInfo&&(w.drawingInfo.renderer&&(v=u.parse(u.stringify(w.drawingInfo.renderer)),G=z.fromJson(v),v.type&&"classBreaks"===v.type&&(G.isMaxInclusive=!0),a.setRenderer(G)),c.isDefined(w.drawingInfo.transparency)&&a.setOpacity(1-w.drawingInfo.transparency/100)),c.isDefined(w.minScale)&&a.setMinScale(w.minScale),c.isDefined(w.maxScale)&&a.setMaxScale(w.maxScale),c.isDefined(w.defaultVisibility)&&!1===w.defaultVisibility&&a.setVisibility(!1);s||h._setFeatureLayerInfoTemplate(a,
p.popupInfo);b={url:a.url,id:a.id,itemId:m.id,title:h._makeFeatureLayerTitle(r,m.title,a.name)};return!0}}):(b={url:a.url,id:a.id,itemId:m.id,title:h._makeFeatureLayerTitle(r,m.title,a.name)},h._setFeatureLayerInfoTemplate(a,null,b.title));return b},_readItemJsonData:function(){return g({url:this.itemUrl+"/data",content:{f:"json"},handleAs:"json"},{})},_readRestInfo:function(a){return g({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{})},_setFeatureLayerInfoTemplate:function(a,
m,p){m||(m=this._newPopupInfo(a,p));m=this._newInfoTemplate(m,p);a.setInfoTemplate(m)},_setWMSVisibleLayers:function(a){var m=[];a&&(n.some(a.layerInfos,function(a){if("string"===typeof a.name&&0<a.name.length)if(10>m.length)m.push(a.name);else return!0}),10>=m.length&&a.setVisibleLayers(m))},_waitForLayer:function(a){var m=new k,p=[];if(a.loaded)return m.resolve(a),m;if(a.loadError)return m.reject(a.loadError),m;var h=function(){n.forEach(p,function(a){a.remove()})};p.push(a.on("load",function(a){h();
m.resolve(a.layer)}));p.push(a.on("error",function(a){h();a=a.error;try{a.message&&-1!==a.message.indexOf("Unable to complete")?(console.warn("layerAccessError",a),m.reject(Error(d.search.layerInaccessible))):m.reject(a)}catch(p){m.reject(a)}}));return m}})})},"esri/layers/ArcGISImageServiceLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../config ./DynamicMapServiceLayer ./ImageServiceLayerMixin".split(" "),function(q,l,n,e,k,u,d){return q([u,d],{declaredClass:"esri.layers.ArcGISImageServiceLayer",
constructor:function(d,c){this._initialize(d,c);this.useMapImage=c&&c.useMapImage||!1},refresh:function(d){if(d)this.inherited(arguments);else{var c=this.disableClientCaching;this.disableClientCaching=!0;this.inherited(arguments);this.disableClientCaching=c}},exportMapImage:function(d,c){var g=k.defaults.map,g=l.mixin({size:g.width+","+g.height},this._params,d?d.toJson(this.normalization):{},{f:"json"});delete g._ts;this._exportMapImage(this._url.path+"/exportImage",g,c)}})})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),
function(q,l,n,e,k,u){q=q(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,mosaicRule:null,renderingRule:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,toJson:function(d){var t=this.bbox||this.extent;d=(t=t&&d&&t._normalize(!0))?t.spatialReference.wkid||n.toJson(t.spatialReference.toJson()):null;var c=this.imageSpatialReference,
t={bbox:t?t.xmin+","+t.ymin+","+t.xmax+","+t.ymax:null,bboxSR:d,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:c?c.wkid||n.toJson(c.toJson()):d,format:this.format,interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?n.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?n.toJson(this.renderingRule.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,
compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio};d=this.timeExtent;t.time=d?d.toJson().join(","):null;return u.filter(t,function(c){if(null!==c&&void 0!==c)return!0})}});l.mixin(q,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});return q})},
"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C,b,v,H,s,f){var G=l([b],{declaredClass:"esri.layers.KMLLayer",
serviceUrl:location.protocol+"//utility.arcgis.com/sharing/kml",constructor:function(f,b){f||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new B({wkid:4326});this._options=e.mixin({},b);A.defaults.kmlService&&(this.serviceUrl=A.defaults.kmlService);var a=this.linkInfo=b&&b.linkInfo;a&&(this.visible=!!a.visibility,this._waitingForMap=!!a.viewFormat);(!a||a&&a.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=e.hitch(this,this.refresh);
this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(f){if(f){var b=f.type,a=f.id,m;switch(b){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(f=this["_"+b])&&(m=e.getObject("_mode._featureMap."+a,!1,f));break;case "GroundOverlay":if(f=this._groundLyr){var p=f.getImages(),b=p.length;for(f=0;f<b;f++)if(p[f].id===a){m=p[f];break}}break;case "ScreenOverlay":break;case "NetworkLink":k.some(this._links,function(h){return h.linkInfo&&h.linkInfo.id===
a?(m=h,!0):!1});break;case "Folder":b=(p=this.folders)?p.length:0;for(f=0;f<b;f++)if(p[f].id===a){m=p[f];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return m}},getLayers:function(){var f=[];this._groundLyr&&f.push(this._groundLyr);this._fLayers&&(f=f.concat(this._fLayers));this._links&&k.forEach(this._links,function(b){b.declaredClass&&f.push(b)});return f},setFolderVisibility:function(f,b){f&&(this._fireUpdateStart(),(f.visible=b)&&(b=this._areLocalAncestorsVisible(f)),
this._setState(f,b),this._fireUpdateEnd())},onRefresh:function(){},onOpacityChange:function(){},_parseKml:function(f){var b=this;this._fireUpdateStart();this._io=F({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(f),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:u.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){b._io=null;b._initLayer(a)},error:function(a){b._io=null;a=e.mixin(Error(),a);a.message="Unable to load KML: "+(a.message||
"");b._fireUpdateEnd(a);b.onError(a)}})},_initLayer:function(b){var w;this.loaded&&(w=[],k.forEach(this.folders,function(a){a.visible&&w.push(a.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=b.name;this.description=b.description;this.snippet=b.snippet;this.visibility=b.visibility;this.featureInfos=b.featureInfos;var a,m,p=this.folders=b.folders,h=[],r;if(p){m=p.length;for(a=0;a<m;a++)r=p[a]=
new v(p[a]),-1===r.parentFolderId&&h.push(r)}var p=this._links=b.networkLinks,D;m=p?p.length:0;for(a=0;a<m;a++)p[a].viewRefreshMode&&-1!==p[a].viewRefreshMode.toLowerCase().indexOf("onregion")||(D=e.mixin({},this._options),D.linkInfo=p[a],D.id&&(D.id=D.id+"_"+a),p[a]=new G(p[a].href,D),p[a]._parentLayer=this,p[a]._parentFolderId=this._getLinkParentId(p[a].linkInfo.id));if((p=b.groundOverlays)&&0<p.length){D=e.mixin({},this._options);D.id&&(D.id+="_mapImage");r=this._groundLyr=new s(D);m=p.length;
for(a=0;a<m;a++)r.addImage(new H(p[a]))}if((b=e.getObject("featureCollection.layers",!1,b))&&0<b.length)this._fLayers=[],k.forEach(b,function(a,h){var m=e.getObject("featureSet.features",!1,a);m&&0<m.length&&(D=e.mixin({outFields:["*"],infoTemplate:a.popupInfo?new C(a.popupInfo):null,editable:!1},this._options),D.id&&(D.id=D.id+"_"+h),a.layerDefinition.capabilities="Query,Data",m=new f(a,D),m.geometryType&&(this["_"+m.geometryType]=m),this._fLayers.push(m))},this),0===this._fLayers.length&&delete this._fLayers;
if(!this.loaded){m=h.length;for(a=0;a<m;a++)r=h[a],this._setState(r,r.visible)}this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),k.forEach(this.folders,function(a){-1<k.indexOf(w,a.id)?this.setFolderVisibility(a,!0):this.setFolderVisibility(a,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var f=this._map;this._fireUpdateStart();this._links&&k.forEach(this._links,function(a){a.declaredClass&&(f.addLayer(a),a._waitingForMap&&(a._waitingForMap=
null,a.visible?a._parseKml(f):a._wMap=f))});var b=f.spatialReference,a=this._outSR,m;if(!b.equals(a))if(b.isWebMercator()&&4326===a.wkid)m=y.geographicToWebMercator;else if(a.isWebMercator()&&4326===b.wkid)m=y.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");return}this._groundLyr&&(m&&k.forEach(this._groundLyr.getImages(),function(a){a.extent=m(a.extent)}),
f.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&k.forEach(b,function(a){if(m){var h=a.graphics,r,b,w=h?h.length:0;for(r=0;r<w;r++)(b=h[r].geometry)&&h[r].setGeometry(m(b))}f.addLayer(a)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var f=this._map;this._links&&k.forEach(this._links,function(f){f.declaredClass&&f._io&&f._io.cancel()});f&&k.forEach(this.getLayers(),f.removeLayer,f)},_setState:function(f,b){var a=f.featureInfos,m,p,h,r=a?a.length:0,D=b?"show":
"hide";for(h=0;h<r;h++)if(m=a[h],p=this.getFeature(m))if("Folder"===m.type)this._setState(p,b&&p.visible);else if("NetworkLink"===m.type)this._setInternalVisibility(p,b);else p[D]()},_areLocalAncestorsVisible:function(f){var b=f.parentFolderId;for(f=f.visible;f&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),f=f&&b.visible,b=b.parentFolderId;return f},_setInternalVisibility:function(f,b){var a=f._parentLayer,m=f._parentFolderId;for(b=b&&f.visible;b&&a;)b=b&&a.visible,-1<m&&(b=b&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",
id:m}))),m=a._parentFolderId,a=a._parentLayer;this._setIntState(f,b)},_setIntState:function(f,b){f&&k.forEach(f.getLayers(),function(a){a.linkInfo?f._setIntState(a,b&&a.visible&&f._areLocalAncestorsVisible(f.getFeature({type:"Folder",id:a._parentFolderId}))):a.setVisibility(b)})},_getLinkParentId:function(f){var b=-1;this.folders&&k.some(this.folders,function(a){return a.networkLinkIds&&-1!==k.indexOf(a.networkLinkIds,f)?(b=a.id,!0):!1});return b},_checkAutoRefresh:function(){var f=this.linkInfo;
if(f)if(this.visible){if(this.loaded&&this._map){var b=f.refreshMode,a=f.refreshInterval,m=f.viewRefreshMode,f=f.viewRefreshTime;b&&(-1!==b.toLowerCase().indexOf("oninterval")&&0<a)&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*a));m&&(-1!==m.toLowerCase().indexOf("onstop")&&0<f)&&!this._extChgHandle&&(this._extChgHandle=n.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),n.disconnect(this._extChgHandle),delete this._extChgHandle},
_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(f){f=f||this._map;var b={},a=this.linkInfo,m=f&&f.extent,p;this._url.query&&(e.mixin(b,this._url.query),p=!!this._url.query.token);if(x.id&&!p&&(p=x.id.findCredential(this._url.path)))b.token=p.token;if(a){p=a.viewFormat;var h=a.httpQuery,a=a.viewBoundScale;if(m&&p){var r=m,D=m,v=m.spatialReference;v&&(v.isWebMercator()?r=y.webMercatorToGeographic(m):4326===v.wkid&&(D=y.geographicToWebMercator(m)));
m=r.getCenter();D=Math.max(D.getWidth(),D.getHeight());a&&(r=r.expand(a));p=p.replace(/\[bboxWest\]/ig,r.xmin).replace(/\[bboxEast\]/ig,r.xmax).replace(/\[bboxSouth\]/ig,r.ymin).replace(/\[bboxNorth\]/ig,r.ymax).replace(/\[lookatLon\]/ig,m.x).replace(/\[lookatLat\]/ig,m.y).replace(/\[lookatRange\]/ig,D).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,m.x).replace(/\[lookatTerrainLat\]/ig,m.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,
m.x).replace(/\[cameraLat\]/ig,m.y).replace(/\[cameraAlt\]/ig,D).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,f.width).replace(/\[vertPixels\]/ig,f.height).replace(/\[terrainEnabled\]/ig,0);e.mixin(b,t.queryToObject(p))}h&&(h=h.replace(/\[clientVersion\]/ig,x.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,q.locale),e.mixin(b,t.queryToObject(h)))}f=[];for(var c in b)E.isDefined(b[c])&&
f.push(c+"\x3d"+b[c]);return(f=f.join("\x26"))?"?"+f:""},setScaleRange:function(f,b){this.inherited(arguments);k.forEach(this.getLayers(),function(a){a.setScaleRange(f,b)})},setOpacity:function(f){this.opacity!=f&&(k.forEach(this.getLayers(),function(b){b.setOpacity(f)}),this.opacity=f,this.onOpacityChange(f))},_setMap:function(f,b){this.inherited(arguments);this._map=f;var a=this._div=c.create("div",null,b);g.set(a,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return a},
_unsetMap:function(f,b){this._io&&this._io.cancel();this._stopAutoRefresh();n.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var a=this._div;a&&(b.removeChild(a),c.destroy(a));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(f){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,f),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&f&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&
(this._map&&!this._io&&this.visible)&&this._parseKml()},getFeatureCollection:function(f){var b,a=[];if(f=this.getFeature({type:"Folder",id:f}))(b=k.map(f.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<b.length&&k.forEach(this._fLayers,function(m){var p,h;p=m.toJson();p.featureSet.features&&0<p.featureSet.features.length&&(h=k.filter(p.featureSet.features,function(a){if(-1!==k.indexOf(b,a.attributes[m.objectIdField]))return a},
this));h&&0<h.length&&(p.featureSet.features=h,a.push(p))},this);return a},getFeatureCount:function(f){f=this.getFeature({type:"Folder",id:f});var b={points:0,polylines:0,polygons:0};f&&k.forEach(f.featureInfos,function(a){"esriGeometryPoint"===a.type&&(b.points+=1);"esriGeometryPolyline"===a.type&&(b.polylines+=1);"esriGeometryPolygon"===a.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});
return G})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(q,l,n,e,k){return q(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(e){l.mixin(this,e);k.isDefined(this.visibility)&&(this.visible=!!this.visibility)}})})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(q,l,n,e,k,u){return q([u],{declaredClass:"esri.layers.KMLGroundOverlay",
constructor:function(d){k.isDefined(this.visibility)&&(this.visible=!!this.visibility)}})})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C){return n([y],{declaredClass:"esri.layers.WMSLayer",
_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,
21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(b,v){var c=x.urlToObject(b);if(c.query&&(c.query.version||c.query.Version||c.query.VERSION))this.version=c.query.version||c.query.Version||c.query.VERSION;this.url=
b=this._stripParameters(b,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));this._url=x.urlToObject(b);this._getCapabilitiesURL=b;this._initLayer=e.hitch(this,this._initLayer);this._parseCapabilities=e.hitch(this,this._parseCapabilities);this._getCapabilitiesError=e.hitch(this,this._getCapabilitiesError);v?(this.imageFormat=this._getImageFormat(v.format),this.imageTransparency=!1!==v.transparent,this.visibleLayers=
v.visibleLayers?v.visibleLayers:[],this.version=v.version||this.version,v.resourceInfo?this._readResourceInfo(v.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=q.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);this._createChildLayer()},setVisibleLayers:function(b){this.visibleLayers=(b=this._checkVisibleLayersList(b))?b:[];this.refresh(!0)},setImageFormat:function(b){this.imageFormat=
this._getImageFormat(b);this.refresh(!0)},setImageTransparency:function(b){this.imageTransparency=b;this.refresh(!0)},refresh:function(){this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,arguments)},getImageUrl:function(b,v,c,s){if(!this.visibleLayers||0===this.visibleLayers.length)s(this._blankImageURL);else{b=this._getImageParams(b,v,c);v=this.getMapURL;var f;v+=-1===v.indexOf("?")?"?":"";for(f in b)b.hasOwnProperty(f)&&(v+="?"===v.substring(v.length-1,
v.length)?"":"\x26",v+=f+"\x3d"+b[f]);s(x.addProxy(v))}},_setMap:function(b,c,d){var s=this.inherited(arguments);b.wrapAround180?this._childLayer&&(this.suspended&&this._childLayer.suspend(),this._childLayer._setMap(b,s)):this._childLayer=this.extentProcessor=null;return s},_unsetMap:function(b,c){this._childLayer&&this._childLayer._unsetMap(b,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);
this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new y(null,{extentProcessor:this._createExtentProcessor(1)});this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=e.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(b){return e.hitch(this,this._extentProcessor,b)},_extentProcessor:function(b,c){var d=c.extent,s=c.width,f=0;if(d){var G=d.getWidth()/s,z=d.bisect(),d=z.extents,w=d[b];w&&(s=z.marginLeft/G,f=0===
b?s:s+d[0].getWidth()/G,s=Math.ceil(w.getWidth()/G),f=Math.ceil(f));d=w}return{extent:d,width:s,marginLeft:f}},_getImageParams:function(b,c,d){var s=b.spatialReference.wkid;-1===k.indexOf(this.spatialReferences,s)&&b.spatialReference.latestWkid&&(s=b.spatialReference.latestWkid);if(k.some(this._WEB_MERCATOR,function(a){return a==s})){var f=k.filter(this.spatialReferences,function(a){return k.some(this._WEB_MERCATOR,function(m){return m==a})},this);0===f.length&&(f=k.filter(this.spatialReferences,
function(a){return k.some(this._WORLD_MERCATOR,function(m){return m==a})},this));s=0<f.length?f[0]:this._WEB_MERCATOR[0]}this.spatialReferences=k.filter(this.spatialReferences,function(a){return a!==s});this.spatialReferences.unshift(s);var f=b.xmin,G=b.xmax,z=b.ymin;b=b.ymax;var w={SERVICE:"WMS",REQUEST:"GetMap"};w.FORMAT=this.imageFormat;w.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";w.STYLES="";w.VERSION=this.version;w.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;w.WIDTH=c;
w.HEIGHT=d;this.maxWidth<c&&(w.WIDTH=this.maxWidth);this.maxHeight<d&&(w.HEIGHT=this.maxHeight);c=s?s:NaN;isNaN(c)||("1.3.0"==this.version?w.CRS="EPSG:"+c:w.SRS="EPSG:"+c);"1.3.0"==this.version&&this._useLatLong(c)?w.BBOX=z+","+f+","+b+","+G:w.BBOX=f+","+z+","+G+","+b;return w},_initLayer:function(b,c){this.spatialReference=new E(this.extent.spatialReference);this.initialExtent=new F(this.extent);this.fullExtent=new F(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);
var t=e.hitch(this,function(){this.loaded=!0;this.onLoad(this);var f=this._loadCallback;f&&(delete this._loadCallback,f(this))});if(u("chrome")){var s=d.defaults.io,f="with-credentials"===s.useCors?x.canUseXhr(this.getMapURL,!0):-1;(s=-1<f?s.corsEnabledServers[f]:null)&&s.withCredentials?g({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){t()}):t()}else t()},_readResourceInfo:function(b){b.extent?b.layerInfos?(this.extent=b.extent,this.allExtents[0]=
b.extent,this.layerInfos=b.layerInfos,this.description=b.description?b.description:"",this.copyright=b.copyright?b.copyright:"",this.title=b.title?b.title:"",this.getMapURL=b.getMapURL?b.getMapURL:this._getCapabilitiesURL,this.getFeatureInfoURL=b.getFeatureInfoURL,this.featureInfoFormat=b.featureInfoFormat,this.version=b.version?b.version:"1.3.0",this.maxWidth=b.maxWidth?b.maxWidth:5E3,this.maxHeight=b.maxHeight?b.maxHeight:5E3,this.spatialReferences=b.spatialReferences?b.spatialReferences:[],this.imageFormat=
this._getImageFormat(b.format),this.setScaleRange(b.minScale,b.maxScale),this._initLayer()):this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},_getCapabilities:function(){var b=this._url.query?this._url.query:{};b.SERVICE="WMS";b.REQUEST="GetCapabilities";this.version&&(b.VERSION=this.version);var c=this._url.path+"?",d;for(d in b)b.hasOwnProperty(d)&&
(c+="?"==c.substring(c.length-1,c.length)?"":"\x26",c+=d+"\x3d"+b[d]);g({url:c,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(b){if(b){var c=this;this.version=this._getAttributeValue("WMS_Capabilities","version",b,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",b,"1.3.0"));var d=this._getTag("Service",b);this.title=this._getTagValue("Title",d,"");this.title||
(this.title=this._getTagValue("Name",d,""));this.copyright=this._getTagValue("AccessConstraints",d,"");this.description=this._getTagValue("Abstract",d,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",d,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",d,5E3),10);if(d=this._getTag("Layer",b)){var s=this._getLayerInfo(d),f=0,G=null,d=this._getTag("Capability",b);k.forEach(d.childNodes,function(a){"Layer"==a.nodeName&&(0===f?G=a:(1===f&&s.name&&(s.name="",s.subLayers=[],s.subLayers.push(this._getLayerInfo(G))),
s.subLayers.push(this._getLayerInfo(a))),f++)},this);if(s){this.layerInfos=s.subLayers;if(!this.layerInfos||0===this.layerInfos.length)this.layerInfos=[s];this.extent=s.extent;this.extent||(s.extent=new F(this.layerInfos[0].extent.toJson()),this.extent=s.extent);this.allExtents=s.allExtents;if(!this.allExtents||!this.allExtents.length)s.allExtents=[],k.forEach(this.layerInfos[0].allExtents,function(a,p){a&&(s.allExtents[p]=new F(a.toJson()))}),this.allExtents=s.allExtents;this.spatialReferences=s.spatialReferences;
if(!this.spatialReferences.length&&0<this.layerInfos.length)for(var z=function(a){var p;for(p=0;p<a.subLayers.length;p++){var h=a.subLayers[p],r=h.spatialReferences;!r.length&&(h.subLayers&&0<h.subLayers.length)&&(r=z(h));if(r.length)return r}return[]},d=0;d<this.layerInfos.length;d++){var w=this.layerInfos[d];this.spatialReferences=this.layerInfos[0].spatialReferences;!this.spatialReferences.length&&(w.subLayers&&0<w.subLayers.length)&&(this.spatialReferences=z(w));if(this.spatialReferences.length)break}}d=
function(a){if((a=l.query("DCPType",c._getTag(a,b)))&&0<a.length)if((a=l.query("HTTP",a[0]))&&0<a.length)if((a=l.query("Get",a[0]))&&0<a.length)if(a=c._getAttributeValue("OnlineResource","xlink:href",a[0],null))return a.indexOf("\x26")===a.length-1&&(a=a.substring(0,a.length-1)),c._stripParameters(a,["service","request"]);return null};w=function(a){var p=[];0===l.query("Operation",b).length?k.forEach(l.query("Format",c._getTag(a,b)),function(a){p.push(a.text?a.text:a.textContent)}):k.forEach(l.query("Operation",
b),function(h){h.getAttribute("name")===a&&k.forEach(l.query("Format",h),function(a){p.push(a.text?a.text:a.textContent)})});return p};this.getMapURL=d("GetMap")||this._getCapabilitiesURL;this.getMapFormats=w("GetMap");k.some(this.getMapFormats,function(a){return-1<a.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=d("GetFeatureInfo"))this.getFeatureInfoFormats=w("GetFeatureInfo"),-1<k.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat=
"text/html":-1<k.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var a=function(m){if(m&&(m.queryable=!1,m.subLayers))for(var p=0;p<m.subLayers.length;p++)a(m.subLayers[p])};a(s)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(b){b&&
b.message&&(b.message="GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+b.message+")");this._errorHandler(b)},_getLayerInfo:function(b){if(!b)return null;var c=new C;c.name="";c.title="";c.description="";c.allExtents=[];c.spatialReferences=[];c.queryable="1"===b.getAttribute("queryable");c.subLayers=[];var d=this._getTag("LatLonBoundingBox",b);d&&(c.allExtents[0]=this._getExtent(d,4326));var s=this._getTag("EX_GeographicBoundingBox",b),f;s&&(f=new F(0,0,0,0,new E({wkid:4326})),
f.xmin=parseFloat(this._getTagValue("westBoundLongitude",s,0)),f.ymin=parseFloat(this._getTagValue("southBoundLatitude",s,0)),f.xmax=parseFloat(this._getTagValue("eastBoundLongitude",s,0)),f.ymax=parseFloat(this._getTagValue("northBoundLatitude",s,0)),c.allExtents[0]=f);!d&&!s&&(f=new F(-180,-90,180,90,new E({wkid:4326})),c.allExtents[0]=f);c.extent=c.allExtents[0];var G=-1<k.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";k.forEach(b.childNodes,function(f){if("Name"==f.nodeName)c.name=
(f.text?f.text:f.textContent)||"";else if("Title"==f.nodeName)c.title=(f.text?f.text:f.textContent)||"";else if("Abstract"==f.nodeName)c.description=(f.text?f.text:f.textContent)||"";else if("BoundingBox"==f.nodeName){var b=f.getAttribute(G);b&&0===b.indexOf("EPSG:")?(b=parseInt(b.substring(5),10),0!==b&&!isNaN(b)&&(f="1.3.0"==this.version?this._getExtent(f,b,this._useLatLong(b)):this._getExtent(f,b),c.allExtents[b]=f,c.extent||(c.extent=f))):b&&0===b.indexOf("CRS:")?(b=parseInt(b.substring(4),10),
0!==b&&!isNaN(b)&&(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),c.allExtents[b]=this._getExtent(f,b))):(b=parseInt(b,10),0!==b&&!isNaN(b)&&(c.allExtents[b]=this._getExtent(f,b)))}else if(f.nodeName==G)f=(f.text?f.text:f.textContent).split(" "),k.forEach(f,function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,10);0!==a&&!isNaN(a)&&(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==k.indexOf(c.spatialReferences,a)&&c.spatialReferences.push(a))},this);else if("Style"==f.nodeName&&
!c.legendURL){if(f=this._getTag("LegendURL",f))if(f=this._getTag("OnlineResource",f))c.legendURL=f.getAttribute("xlink:href")}else"Layer"===f.nodeName&&c.subLayers.push(this._getLayerInfo(f))},this);c.title=c.title||c.name;return c},_getImageFormat:function(b){switch(b?b.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():
""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(b,c,d){var s;if(b){s=new F;var f=parseFloat(b.getAttribute("minx")),G=parseFloat(b.getAttribute("miny")),z=parseFloat(b.getAttribute("maxx"));b=parseFloat(b.getAttribute("maxy"));d?(s.xmin=isNaN(G)?-1*Number.MAX_VALUE:G,s.ymin=isNaN(f)?-1*Number.MAX_VALUE:f,s.xmax=isNaN(b)?Number.MAX_VALUE:b,s.ymax=isNaN(z)?Number.MAX_VALUE:z):(s.xmin=
isNaN(f)?-1*Number.MAX_VALUE:f,s.ymin=isNaN(G)?-1*Number.MAX_VALUE:G,s.xmax=isNaN(z)?Number.MAX_VALUE:z,s.ymax=isNaN(b)?Number.MAX_VALUE:b);s.spatialReference=new E({wkid:c})}return s},_useLatLong:function(b){var c,d;for(d=0;d<this._REVERSED_LAT_LONG_RANGES.length;d++){var s=this._REVERSED_LAT_LONG_RANGES[d];if(b>=s[0]&&b<=s[1]){c=!0;break}}return c},_getTag:function(b,c){var d=l.query(b,c);return d&&0<d.length?d[0]:null},_getTagValue:function(b,c,d){return(b=l.query(b,c))&&0<b.length?b[0].text?b[0].text:
b[0].textContent:d},_getAttributeValue:function(b,c,d,s){return(b=l.query(b,d))&&0<b.length?b[0].getAttribute(c):s},_checkVisibleLayersList:function(b){if(b&&(0<b.length&&this.layerInfos&&0<this.layerInfos.length)&&"number"==typeof b[0]){var c=[];k.forEach(b,function(b){b<this.layerInfos.length&&c.push(this.layerInfos[b].name)},this);b=c}return b},_stripParameters:function(b,c){var d=x.urlToObject(b),s,f=[];for(s in d.query)d.query.hasOwnProperty(s)&&-1===k.indexOf(c,s.toLowerCase())&&f.push(s+"\x3d"+
d.query[s]);return d.path+(f.length?"?"+f.join("\x26"):"")},_getPopupGraphic:function(b,c){var d=this.visibleLayers;if(!d||0===d.length)return null;var s=this._popupGraphic;s||(s=new A({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+
q.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),s=this._popupGraphic=new t(null,null,{},s),s._layer=this);var f=function(a){var p=[];if(a&&(a.queryable&&(a.showPopup&&a.name)&&p.push(a.name),a.subLayers))for(var h=0;h<a.subLayers.length;h++){var r=f(a.subLayers[h]);r.length&&(p=p.concat(r))}return p},G=f({subLayers:this.layerInfos}),G=k.filter(G,function(a){return-1<
k.indexOf(d,a)});if(G.length){var z=this.getFeatureInfoURL,g=this._getImageParams(b.extent,b.width,b.height);g.REQUEST="GetFeatureInfo";g.INFO_FORMAT=this.featureInfoFormat;g.QUERY_LAYERS=G.join();g.FEATURE_COUNT=25;"1.3.0"===this.version?(g.I=c.x,g.J=c.y):(g.X=c.x,g.Y=c.y);var z=z+(-1===z.indexOf("?")?"?":""),a;for(a in g)g.hasOwnProperty(a)&&(z+="?"===z.substring(z.length-1,z.length)?"":"\x26",z+=a+"\x3d"+g[a]);s.attributes.QUERY_URL=z;return s}return null}})})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(q,l,n,e,k){return q(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(e){e&&(this.name=e.name,this.title=e.title,this.description=e.description,this.extent=e.extent,this.legendURL=e.legendURL,this.subLayers=e.subLayers?e.subLayers:[],this.allExtents=e.allExtents?e.allExtents:
[],this.spatialReferences=e.spatialReferences?e.spatialReferences:[],this.queryable=!!e.queryable,this.showPopup=!!e.showPopup)},clone:function(){var e={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},d;this.extent&&(e.extent=this.extent.getExtent());e.subLayers=[];n.forEach(this.subLayers,function(d){e.subLayers.push(d.clone())});e.allExtents=[];for(d in this.allExtents)d=parseInt(d,10),isNaN(d)||(e.allExtents[d]=this.allExtents[d].getExtent());e.spatialReferences=
[];n.forEach(this.spatialReferences,function(d){e.spatialReferences.push(d)});e.queryable=this.queryable;e.showPopup=this.showPopup;return e}})})},"esri/layers/CSVLayer":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../arcgis/csv ./FeatureLayer ../geometry/Extent ../tasks/FeatureSet".split(" "),function(q,l,n,e,k,u,d,t,c){return l(d,{declaredClass:"esri.layers.CSVLayer",_preventInit:!0,_fieldTypeMap:{Date:"esriFieldTypeDate",Number:"esriFieldTypeDouble",
String:"esriFieldTypeString"},constructor:function(c,d){this.url=c;d=n.mixin({},d);this.columnDelimiter=d.columnDelimiter;this.latitudeFieldName=d.latitudeFieldName;this.longitudeFieldName=d.longitudeFieldName;var e=d.layerDefinition;e||(e={fields:d.fields||[],geometryType:"esriGeometryPoint",copyrightText:d.copyright},d.fields&&q.forEach(d.fields,function(c){c.type=this._fieldTypeMap[c.type||"String"];c.alias||(c.alias=c.name)},this));this._buildCsvFcParam={url:this.url,columnDelimiter:this.columnDelimiter,
layerDefinition:e,outFields:d.outFields};this.latitudeFieldName&&this.longitudeFieldName&&(this._buildCsvFcParam.locationInfo={locationType:"coordinates",latitudeFieldName:this.latitudeFieldName,longitudeFieldName:this.longitudeFieldName});this._projectFeatures=n.hitch(this,this._projectFeatures);this._addFeatures=n.hitch(this,this._addFeatures);this._initCSVLayer(d)},refresh:function(){this._fireUpdateStart();this.applyEdits(null,null,this.graphics);this._loadFeatures()},_setMap:function(c){var d=
this.inherited(arguments);this._fireUpdateStart();this._projectFeatures(this._csvFC).then(this._addFeatures).otherwise(this._errorHandler);this._csvFC=null;return d},_initCSVLayer:function(c){var d=this;u.buildCSVFeatureCollection(this._buildCsvFcParam).then(function(e){d._csvFC=e;var t=e.layerDefinition;t.extent=d._getFCExtent(e);c.outFields||(c.outFields=["*"]);d._initFeatureLayer({layerDefinition:t},c)}).otherwise(this._errorHandler)},_loadFeatures:function(){u.buildCSVFeatureCollection(this._buildCsvFcParam).then(this._projectFeatures).then(this._addFeatures).otherwise(this._errorHandler)},
_projectFeatures:function(c){return u.projectFeatureCollection(c,this._map.spatialReference)},_addFeatures:function(d){d=new c(d.featureSet);this.applyEdits(d.features,null,null);this._fireUpdateEnd()},_getFCExtent:function(c){var d;if(c&&c.featureSet&&c.featureSet.features){c=c.featureSet.features;var e=c.length;if(1<e){var k=c[0].geometry;d=new t(k.x,k.y,k.x,k.y);for(e-=1;0<e;e--)k=c[e].geometry,d.xmin=Math.min(d.xmin,k.x),d.ymin=Math.min(d.ymin,k.y),d.xmax=Math.max(d.xmax,k.x),d.ymax=Math.max(d.ymax,
k.y);0>=d.getWidth()&&0>=d.getHeight()&&(d=null)}}return d}})})},"esri/arcgis/csv":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/number dojox/data/CsvStore ../kernel ../config ../request ../SpatialReference ../geometry/jsonUtils ../geometry/webMercatorUtils".split(" "),function(q,l,n,e,k,u,d,t,c,g,x,A){function E(b){var f=0,c="";l.forEach([","," ",";","|","\t"],function(d){var e=b.split(d).length;e>f&&(f=e,c=d)});return c}function F(b,f){if(!b||"[object Date]"!==
Object.prototype.toString.call(b)||isNaN(b.getTime()))return!1;var c=!0;if(e("chrome")&&/\d+\W*$/.test(f)){var d=f.match(/[a-zA-Z]{2,}/);if(d){for(var c=!1,g=0,a=d.length,m=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;!c&&g<=a&&!(c=!m.test(d[g]));)g++;c=!c}}return c}function B(b,f,c){var d=b.indexOf("\n"),d=q.trim(b.substr(0,d)),e=f.columnDelimiter;e||(e=E(d));var a=new u({data:b,
separator:e});a.fetch({onComplete:function(m,p){var h=0,r={layerDefinition:f.layerDefinition,featureSet:{features:[],geometryType:"esriGeometryPoint"}},b=r.layerDefinition.objectIdField,d=r.layerDefinition.fields;!b&&!l.some(d,function(a){return"esriFieldTypeOID"===a.type?(b=a.name,!0):!1})&&(d.push({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1}),b="__OBJECTID");var s,z,e=a._attributes,g=[],t=[];l.forEach(d,function(a){"esriFieldTypeDate"===a.type?g.push(a.name):("esriFieldTypeDouble"===
a.type||"esriFieldTypeInteger"===a.type)&&t.push(a.name)});f.locationInfo&&"coordinates"===f.locationInfo.locationType?(s=f.locationInfo.latitudeFieldName,z=f.locationInfo.longitudeFieldName):l.forEach(e,function(a){var h;h=l.indexOf(v,a.toLowerCase());-1!==h&&(s=a);h=l.indexOf(H,a.toLowerCase());-1!==h&&(z=a)});if(!s||!z)setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.")},1),c&&c(null,Error("File does not seem to contain fields with point coordinates."));
else{-1===l.indexOf(t,s)&&t.push(s);-1===l.indexOf(t,z)&&t.push(z);var w;q.isArray(f.outFields)&&-1===l.indexOf(f.outFields,"*")&&(w=f.outFields);l.forEach(e,function(a){l.some(d,function(h){return a===h.name})||d.push({name:a,alias:a,type:a===s||a===z?"esriFieldTypeDouble":"esriFieldTypeString"})});var e=0,n=m.length;for(e;e<n;e++){var y=m[e],A=a.getAttributes(y),x={};l.forEach(A,function(h){if(h&&(h===s||h===z||!w||-1<l.indexOf(w,h))){var m=h;0===h.length&&l.forEach(d,function(a,m){a.name==="attribute_"+
(m-1)&&(h="attribute_"+(m-1))});if(-1<l.indexOf(g,h)){var m=a.getValue(y,m),f=new Date(m);x[h]=F(f,m)?f.getTime():null}else if(-1<l.indexOf(t,h)){f=k.parse(a.getValue(y,m));if((h===s||h===z)&&(isNaN(f)||181<Math.abs(f)))f=parseFloat(a.getValue(y,m));isNaN(f)?x[h]=null:x[h]=f}else x[h]=a.getValue(y,m)}});x[b]=h;h++;var A=x[s],E=x[z];null==E||(null==A||isNaN(A)||isNaN(E))||(w&&-1===l.indexOf(w,s)&&delete x[s],w&&-1===l.indexOf(w,z)&&delete x[z],r.featureSet.features.push({geometry:{x:E,y:A,spatialReference:{wkid:4326}},
attributes:x}))}r.layerDefinition.name="csv";c&&c(r)}},onError:function(a){console.error("Error fetching items from CSV store: ",a);c&&c(null,a)}});return!0}function y(b,f,c,d,e,a){0===b.length&&e(null);var m=x.getGeometryType(f),p=[];l.forEach(b,function(a){a=new m(a);a.spatialReference=c;p.push(a)},this);f=[102113,102100,3857];c.wkid&&4326===c.wkid&&d.wkid&&-1<l.indexOf(f,d.wkid)?(l.forEach(p,function(a){a.xmin?(a.xmin=Math.max(a.xmin,-180),a.xmax=Math.min(a.xmax,180),a.ymin=Math.max(a.ymin,-89.99),
a.ymax=Math.min(a.ymax,89.99)):a.rings?l.forEach(a.rings,function(a){l.forEach(a,function(a){a[0]=Math.min(Math.max(a[0],-180),180);a[1]=Math.min(Math.max(a[1],-89.99),89.99)},this)},this):a.paths?l.forEach(a.paths,function(a){l.forEach(a,function(a){a[0]=Math.min(Math.max(a[0],-180),180);a[1]=Math.min(Math.max(a[1],-89.99),89.99)},this)},this):a.x&&(a.x=Math.min(Math.max(a.x,-180),180),a.y=Math.min(Math.max(a.y,-89.99),89.99))},this),b=[],l.forEach(p,function(a){a=A.geographicToWebMercator(a);102100!==
d.wkid&&(a.spatialReference=d);b.push(a.toJson())},this),e(b)):null!==c.wkid&&-1<l.indexOf(f,c.wkid)&&null!==d.wkid&&4326===d.wkid?(b=[],l.forEach(p,function(a){b.push(A.webMercatorToGeographic(a).toJson())},this),e(b)):(f=function(h,m){h&&h.length===b.length?(b=[],l.forEach(h,function(a){a&&(a.rings&&0<a.rings.length&&0<a.rings[0].length&&0<a.rings[0][0].length&&!isNaN(a.rings[0][0][0])&&!isNaN(a.rings[0][0][1])||a.paths&&0<a.paths.length&&0<a.paths[0].length&&0<a.paths[0][0].length&&!isNaN(a.paths[0][0][0])&&
!isNaN(a.paths[0][0][1])||a.xmin&&!isNaN(a.xmin)&&a.ymin&&!isNaN(a.ymin)||a.x&&!isNaN(a.x)&&a.y&&!isNaN(a.y))?b.push(a.toJson()):b.push(null)},this),e(b)):a(h,m)},t.defaults.geometryService?t.defaults.geometryService.project(p,d,q.hitch(this,f),a):e(null))}function C(b,f){var c=[102113,102100,3857];return b&&f&&b.wkid===f.wkid&&b.wkt===f.wkt||b&&f&&b.wkid&&f.wkid&&-1<l.indexOf(c,b.wkid)&&-1<l.indexOf(c,f.wkid)?!0:!1}function b(b,f,c,d){if(b.featureSet&&0!==b.featureSet.features.length)if(C(c,f))d(b);
else{var e,a=function(a){var m=[];l.forEach(b.featureSet.features,function(f,b){a[b]&&(f.geometry=a[b],m.push(f))},this);d(b)},m=function(a,m){console.error("error projecting featureSet ("+b.layerDefinition.name+"). Final try.");d(b)},p=function(h,r){console.error("error projecting featureSet ("+b.layerDefinition.name+"). Try one more time.");y(e,b.featureSet.geometryType,f,c,q.hitch(this,a),q.hitch(this,m))};b.featureSet.features&&0<b.featureSet.features.length?(e=[],l.forEach(b.featureSet.features,
function(a){if(a.geometry.toJson)e.push(a.geometry);else{var m=x.getGeometryType(b.featureSet.geometryType);e.push(new m(a.geometry))}}),f.toJson||(f=new g(f)),c.toJson||(c=new g(c)),y(e,b.featureSet.geometryType,f,c,q.hitch(this,a),q.hitch(this,p))):d(b)}}var v="lat latitude y ycenter latitude83 latdecdeg point-y lat_dd".split(" "),H="lon lng long longitude x xcenter longitude83 longdecdeg point-x long_dd".split(" ");return{latFieldStrings:v,longFieldStrings:H,buildCSVFeatureCollection:function(b){var f=
new n,d=function(b,a){a?f.errback(a):f.callback(b)},e={url:b.url,handleAs:"text",load:function(f){B(f,b,q.hitch(this,d))},error:function(b){f.errback(b);console.error("error: "+b)}};-1<b.url.indexOf("arcgis.com")&&(-1<b.url.indexOf("/content/items")&&-1<b.url.indexOf("/data"))&&(e.headers={"Content-Type":""});c(e,{usePost:!1});return f},projectFeatureCollection:function(c,f,d){var e=new n;d||(d=new g({wkid:4326}));b(c,d,f,q.hitch(this,function(f){e.callback(f)}));return e},generateDefaultPopupInfo:function(b){var f=
{esriFieldTypeDouble:1,esriFieldTypeSingle:1},c={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},d={esriFieldTypeDate:1},e=null;b=l.map(b.layerDefinition.fields,q.hitch(this,function(a){"NAME"===a.name.toUpperCase()&&(e=a.name);var m="esriFieldTypeOID"!==a.type&&"esriFieldTypeGlobalID"!==a.type&&"esriFieldTypeGeometry"!==a.type,b=null;if(m){var h=a.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+h+",")||-1<h.indexOf("area")||
-1<h.indexOf("length")||-1<h.indexOf("shape")||-1<h.indexOf("perimeter")||-1<h.indexOf("objectid")||h.indexOf("_")===h.length-1||h.indexOf("_i")===h.length-2&&1<h.length)m=!1;a.type in c?b={places:0,digitSeparator:!0}:a.type in f?b={places:2,digitSeparator:!0}:a.type in d&&(b={dateFormat:"shortDateShortTime"})}return q.mixin({},{fieldName:a.name,label:a.alias,isEditable:!0,tooltip:"",visible:m,format:b,stringFieldOption:"textbox"})}));return{title:e?"{"+e+"}":"",fieldInfos:b,description:null,showAttachments:!1,
mediaInfos:[]}},_getSeparator:E,_isValidDate:F,_processCsvData:B,_projectGeometries:y,_sameSpatialReference:C,_projectFeatureSet:b}})},"dojox/data/CsvStore":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/xhr dojo/_base/kernel dojo/data/util/filter dojo/data/util/simpleFetch".split(" "),function(q,l,n,e,k,u){l=l("dojox.data.CsvStore",null,{constructor:function(d){this._attributes=[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=!1;d.url&&
(this.url=d.url);this._csvData=d.data;d.label?this.label=d.label:""===this.label&&(this.label=void 0);this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._loadInProgress=!1;this._queuedFetches=[];this.identifier=d.identifier;""===this.identifier?delete this.identifier:this._idMap={};"separator"in d&&(this.separator=d.separator);"urlPreventCache"in d&&(this.urlPreventCache=d.urlPreventCache?!0:!1)},url:"",label:"",identifier:"",
separator:",",urlPreventCache:!1,_assertIsItem:function(d){if(!this.isItem(d))throw Error(this.declaredClass+": a function was passed an item argument that was not an item");},_getIndex:function(d){d=this.getIdentity(d);this.identifier&&(d=this._idMap[d]);return d},getValue:function(d,e,c){this._assertIsItem(d);var g=c;if("string"===typeof e)e=this._attributeIndexes[e],null!=e&&(g=this._dataArray[this._getIndex(d)][e]||c);else throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");
return g},getValues:function(d,e){var c=this.getValue(d,e);return c?[c]:[]},getAttributes:function(d){this._assertIsItem(d);var e=[];d=this._dataArray[this._getIndex(d)];for(var c=0;c<d.length;c++)""!==d[c]&&e.push(this._attributes[c]);return e},hasAttribute:function(d,e){this._assertIsItem(d);if("string"===typeof e){var c=this._attributeIndexes[e],g=this._dataArray[this._getIndex(d)];return"undefined"!==typeof c&&c<g.length&&""!==g[c]}throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");
},containsValue:function(d,e,c){var g=void 0;"string"===typeof c&&(g=k.patternToRegExp(c,!1));return this._containsValue(d,e,c,g)},_containsValue:function(d,e,c,g){d=this.getValues(d,e);for(e=0;e<d.length;++e){var k=d[e];if("string"===typeof k&&g)return null!==k.match(g);if(c===k)return!0}return!1},isItem:function(d){if(d&&d[this._storeProp]===this)if(d=d[this._idProp],this.identifier){if(this._dataArray[this._idMap[d]])return!0}else if(0<=d&&d<this._dataArray.length)return!0;return!1},isItemLoaded:function(d){return this.isItem(d)},
loadItem:function(d){},getFeatures:function(){return this._features},getLabel:function(d){if(this.label&&this.isItem(d))return this.getValue(d,this.label)},getLabelAttributes:function(d){return this.label?[this.label]:null},_fetchItems:function(d,e,c){var g=this,l=function(c,d){var b=null;if(c.query){var v,l,b=[],s=c.queryOptions?c.queryOptions.ignoreCase:!1,f={};for(v in c.query)l=c.query[v],"string"===typeof l&&(f[v]=k.patternToRegExp(l,s));for(s=0;s<d.length;++s){var G=!0,z=d[s];for(v in c.query)l=
c.query[v],g._containsValue(z,v,l,f[v])||(G=!1);G&&b.push(z)}}else b=d.slice(0,d.length);e(b,c)};if(this._loadFinished)l(d,this._arrayOfAllItems);else if(""!==this.url)if(this._loadInProgress)this._queuedFetches.push({args:d,filter:l});else{this._loadInProgress=!0;var A=n.get({url:g.url,handleAs:"text",preventCache:g.urlPreventCache});A.addCallback(function(e){try{g._processData(e),l(d,g._arrayOfAllItems),g._handleQueuedFetches()}catch(k){c(k,d)}});A.addErrback(function(e){g._loadInProgress=!1;if(c)c(e,
d);else throw e;});var q=null;d.abort&&(q=d.abort);d.abort=function(){A&&-1===A.fired&&A.cancel();q&&q.call(d)}}else if(this._csvData)try{this._processData(this._csvData),this._csvData=null,l(d,this._arrayOfAllItems)}catch(u){c(u,d)}else{var B=Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(c)c(B,d);else throw B;}},close:function(d){},_getArrayOfArraysFromCsvFileContents:function(d){if(q.isString(d)){var e=RegExp("^\\s+","g"),c=RegExp("\\s+$","g"),
g=RegExp('""',"g"),k=[],l=this._splitLines(d);for(d=0;d<l.length;++d){var n=l[d];if(0<n.length){for(var n=n.split(this.separator),u=0;u<n.length;){var B=n[u].replace(e,""),y=B.replace(c,""),C=y.charAt(0),b=y.charAt(y.length-1),v=y.charAt(y.length-2),H=y.charAt(y.length-3);if(2===y.length&&'""'==y)n[u]="";else if('"'==C&&('"'!=b||'"'==b&&'"'==v&&'"'!=H)){if(u+1===n.length)return;n[u]=B+this.separator+n[u+1];n.splice(u+1,1)}else'"'==C&&'"'==b&&(y=y.slice(1,y.length-1),y=y.replace(g,'"')),n[u]=y,u+=
1}k.push(n)}}this._attributes=k.shift();for(d=0;d<this._attributes.length;d++)this._attributeIndexes[this._attributes[d]]=d;this._dataArray=k}},_splitLines:function(d){var e=[],c,g="",k=!1;for(c=0;c<d.length;c++){var l=d.charAt(c);switch(l){case '"':k=!k;g+=l;break;case "\r":k?g+=l:(e.push(g),g="",c<d.length-1&&"\n"==d.charAt(c+1)&&c++);break;case "\n":k?g+=l:(e.push(g),g="");break;default:g+=l}}""!==g&&e.push(g);return e},_processData:function(d){this._getArrayOfArraysFromCsvFileContents(d);this._arrayOfAllItems=
[];if(this.identifier&&void 0===this._attributeIndexes[this.identifier])throw Error(this.declaredClass+": Identity specified is not a column header in the data set.");for(d=0;d<this._dataArray.length;d++){var e=d;this.identifier&&(e=this._dataArray[d][this._attributeIndexes[this.identifier]],this._idMap[e]=d);this._arrayOfAllItems.push(this._createItemFromIdentity(e))}this._loadFinished=!0;this._loadInProgress=!1},_createItemFromIdentity:function(d){var e={};e[this._storeProp]=this;e[this._idProp]=
d;return e},getIdentity:function(d){return this.isItem(d)?d[this._idProp]:null},fetchItemByIdentity:function(d){var k,c=d.scope?d.scope:e.global;if(this._loadFinished)k=this._createItemFromIdentity(d.identity),this.isItem(k)||(k=null),d.onItem&&d.onItem.call(c,k);else{var g=this;if(""!==this.url)this._loadInProgress?this._queuedFetches.push({args:d}):(this._loadInProgress=!0,k=n.get({url:g.url,handleAs:"text"}),k.addCallback(function(e){try{g._processData(e);var k=g._createItemFromIdentity(d.identity);
g.isItem(k)||(k=null);d.onItem&&d.onItem.call(c,k);g._handleQueuedFetches()}catch(l){d.onError&&d.onError.call(c,l)}}),k.addErrback(function(e){this._loadInProgress=!1;d.onError&&d.onError.call(c,e)}));else if(this._csvData)try{g._processData(g._csvData),g._csvData=null,k=g._createItemFromIdentity(d.identity),g.isItem(k)||(k=null),d.onItem&&d.onItem.call(c,k)}catch(l){d.onError&&d.onError.call(c,l)}}},getIdentityAttributes:function(d){return this.identifier?[this.identifier]:null},_handleQueuedFetches:function(){if(0<
this._queuedFetches.length){for(var d=0;d<this._queuedFetches.length;d++){var e=this._queuedFetches[d],c=e.filter,g=e.args;c?c(g,this._arrayOfAllItems):this.fetchItemByIdentity(e.args)}this._queuedFetches=[]}}});q.extend(l,u);return l})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ./ServiceGeneratedFeatureCollection".split(" "),function(q,l,n,e,k,u,d,t){return q([t],{declaredClass:"esri.layers.GeoRSSLayer",
serviceUrl:location.protocol+"//utility.arcgis.com/sharing/rss",constructor:function(c,d){u.defaults.geoRSSService&&(this.serviceUrl=u.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=d({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?n.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},_initLayer:function(c){this.inherited(arguments);this.loaded||(this.loaded=!0,this.onLoad(this))}})})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B){return q([E],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",constructor:function(d,e){this.pointSymbol=e&&e.pointSymbol;this.polylineSymbol=e&&e.polylineSymbol;this.polygonSymbol=e&&e.polygonSymbol;this._outSR=e&&(e.outSpatialReference||e.outSR)||new c({wkid:4326});this._options=n.mixin({},e)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var c=[];this._fLayers&&(c=c.concat(this._fLayers));
return c},onRefresh:function(){},onOpacityChange:function(){},refresh:function(){this.loaded&&(this._map&&!this._io&&this.visible)&&this._createLayer()},_createLayer:function(c){var d=this;this._fireUpdateStart();c=this.parse(c);c.addCallback(function(b){d._io=null;d._initLayer(b)});c.addErrback(function(b){d._io=null;b=n.mixin(Error(),b);b.message="Unable to load resource: "+d.url+" "+(b.message||"");d._fireUpdateEnd(b);d.onError(b)})},_initLayer:function(c){this.loaded&&this._removeInternalLayers();
this.name=c.name;this.description=c.description;this.snippet=c.snippet;this.defaultVisibility=void 0!==c.visibility?this.visible=!!c.visibility:this.visible=!0;this.featureInfos=c.featureInfos;this.fullExtent=this.initialExtent=new g(c.lookAtExtent);this.copyright=c.author||c.copyright;var d;if((c=n.getObject("featureCollection.layers",!1,c))&&0<c.length)this._fLayers=[],e.forEach(c,function(b,c){var e=n.getObject("featureSet.features",!1,b);e&&0<e.length&&(d=n.mixin({outFields:["*"],infoTemplate:b.popupInfo?
new B(b.popupInfo):null,editable:!1},this._options),d.id&&(d.id=d.id+"_"+c),b.layerDefinition.capabilities="Query,Data",e=new F(b,d),e.geometryType&&(this["_"+e.geometryType]=e),this._fLayers.push(e))},this),0===this._fLayers.length&&delete this._fLayers;this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(c=new A(this.pointSymbol),this._esriGeometryPoint.setRenderer(c)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),
this.polylineSymbol&&(c=new A(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(c)));this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol&&(c=new A(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(c)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var c=this._map;this._fireUpdateStart();var d=c.spatialReference,b=this._outSR,g;if(d.wkid)g=d._isWebMercator()&&
b._isWebMercator()||d.wkid===b.wkid;else if(d.wkt)g=d.wkt===b.wkt;else{console.log("_setMap - map has invalid spatial reference");return}if(!g)if(d._isWebMercator()&&4326===b.wkid)this._converter=x.geographicToWebMercator;else if(b._isWebMercator()&&4326===d.wkid)this._converter=x.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(d=this._fLayers)&&0<d.length&&e.forEach(d,
function(b){if(this._converter){var d=b.graphics,f,e,g=d?d.length:0;for(f=0;f<g;f++)(e=d[f].geometry)&&d[f].setGeometry(this._converter(e))}c.addLayer(b)},this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var c=this._map;c&&e.forEach(this.getFeatureLayers(),c.removeLayer,c)},setScaleRange:function(c,d){this.inherited(arguments);e.forEach(this.getFeatureLayers(),function(b){b.setScaleRange(c,d)});this._options.minScale=this.minScale;this._options.maxScale=
this.maxScale},setOpacity:function(c){this.opacity!=c&&(e.forEach(this.getFeatureLayers(),function(d){d.setOpacity(c)}),this.opacity=this._options.opacity=c,this.onOpacityChange(c))},onVisibilityChange:function(c){this._fireUpdateStart();e.forEach(this.getFeatureLayers(),function(d){d.setVisibility(c)});this._fireUpdateEnd()},_setMap:function(c,d){this.inherited(arguments);this._map=c;var b=this._div=k.create("div",null,d);u.set(b,"position","absolute");this._addInternalLayers();this.evaluateSuspension();
return b},_unsetMap:function(c,d){this._io&&this._io.cancel();l.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var b=this._div;b&&(d.removeChild(b),k.destroy(b));this._div=null;this.inherited(arguments)}})})},"esri/layers/StreamLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/array dojo/_base/Color dojo/_base/lang dojo/has dojo/io-query dojo/on dojo/aspect ../kernel ../request ../graphic ./FeatureLayer ./StreamMode ./StreamTrackManager ../geometry/jsonUtils ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleMarkerSymbol ../renderers/SimpleRenderer ./PurgeOptions".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C,b,v,H,s){return q([E],{declaredClass:"esri.layers.StreamLayer",_preventInit:!0,constructor:function(b,c){c=c||{};if(!c.mode||c.mode===E.MODE_STREAM)this._isStream=!0,this.currentMode=this.mode=E.MODE_STREAM,this._mode=new F(this);this.purgeOptions=new s(this,c.purgeOptions||{});this.purgeInterval=c.purgeInterval||0;this._reconnectAttempts=0;this.maxReconnectAttempts=10;this.socket=this._reconnectTimeoutId=null;this._keepLatestQueried=!1;this._keepLatestUrl=
null;this._relatedQueried=!1;this._joinField=this._relatedUrl=null;this._refreshing=!1;this._attemptReconnect=k.hitch(this,this._attemptReconnect);this._purge=k.hitch(this,this._purge);this._processServiceJson=k.hitch(this,this._processServiceJson);if(k.isObject(b)&&b.layerDefinition)this._initFeatureLayer(b,c);else{var d=this;x({url:b,content:k.mixin({f:"json"}),callbackParamName:"callback"}).then(function(b){d._processServiceJson(b,c)},function(b){d._errorHandler(b)})}},_processServiceJson:function(b,
c){var d=this;b.relatedFeatures&&b.relatedFeatures.featuresUrl&&b.relatedFeatures.joinField?(this._relatedUrl=b.relatedFeatures.featuresUrl,this.objectIdField=this._joinField=b.relatedFeatures.joinField,x({url:this._relatedUrl,content:{f:"json"},callbackParamName:"callback"}).then(function(e){e=e.fields||[];var a=n.map(b.fields,function(a){return a.name});n.forEach(e,function(m){-1===n.indexOf(a,m.name)&&b.fields.push(m)});c.resourceInfo=b;d._initFeatureLayer(d._url,c)},function(b){d.onError({error:b})})):
(c.resourceInfo=b,this._initFeatureLayer(this._url,c))},_initLayer:function(b,c){this.inherited(arguments);if(b){var d;if(b.layerDefinition)this.purgeOptions=new s(this,this._params.purgeOptions||{}),this.socketUrl=this._params.socketUrl||b.layerDefinition.socketUrl||void 0;else{if(this._params.socketUrl)this.socketUrl=this._params.socketUrl;else{var e=this._getWebsocketConnectionInfo(b),a=e.urls;a&&a.length?(this._socketUrls=a,this.socketUrl=a[0],this.socketDirection="broadcast"===this._params.socketDirection?
"broadcast":"subscribe",this.socketUrl+="/"+this.socketDirection,this._websocketToken=e.token,a.length>this.maxReconnectAttempts&&(this.maxReconnectAttempts=a.length)):(this.socketUrl=void 0,e="No web socket urls were retrieved from the Stream Service. Layer will not attempt to connect.","https:"===location.protocol&&(e+=" An insecure web socket connection cannot be made from a secure web page."),this.onError(Error(e)))}if(this._params.filter)try{this._filter=d=this._makeFilter(this._params.filter)}catch(m){this.onError(Error("Error trying to create filter object: "+
m+". Layer will not have filter applied")),this._filter=null}if(this._params.geometryDefinition||this._outFields||this._defnExpr){d=d||{};d.geometry=this._params.geometryDefinition;d.outFields=this._outFields;d.where=this._defnExpr;try{this._filter=d=this._makeFilter(d)}catch(p){this.onError(Error("Error trying to create filter object: "+p+". Layer will not have filter applied")),this._filter=null}}}this.maximumTrackPoints=this._params.maximumTrackPoints||0===this._params.maximumTrackPoints?this._params.maximumTrackPoints:
1;(this._params.refreshRate||0===this._params.refreshRate)&&this._mode&&this._mode._setRefreshRate&&this._mode._setRefreshRate(this._params.refreshRate);this._keepLatestUrl=b.keepLatestArchive?b.keepLatestArchive.featuresUrl:null;b.relatedFeatures&&(b.relatedFeatures.featuresUrl&&b.relatedFeatures.joinField)&&(this._relatedUrl=b.relatedFeatures.featuresUrl,this.objectIdField=this._joinField=b.relatedFeatures.joinField);this.objectIdField||this._makeObjectIdField();this._map&&(this.socketUrl&&!this._connected)&&
this.connect()}},_setMap:function(b){var c=this.inherited(arguments),d=this._getRenderer();if(this.timeInfo&&(this._trackIdField||d&&(d.latestObservationRenderer||d.trackRenderer)))this._trackManager=new B(this),this._trackManager.initialize(b);this.socketUrl&&(!this._connected&&this._map)&&this.connect();return c},_unsetMap:function(b,c){n.forEach(this._connects,l.disconnect);(this._connected||this._reconnecting||this.socket)&&this.disconnect();this._togglePurgeT();this.inherited(arguments);this._map=
null},_suspend:function(){this._togglePurgeT();this.inherited(arguments)},_resume:function(){this.inherited(arguments);this._togglePurgeT(!0)},clear:function(){try{this._mode&&this._mode._clearDrawBuffer&&this._mode._clearDrawBuffer(),this._mode&&this._mode._clearTimeBin&&this._mode._clearTimeBin(),this._mode&&this._mode._clearFeatureMap&&this._mode._clearFeatureMap(),this._trackManager&&this._trackManager.clearTracks()}catch(b){}this.inherited(arguments)},redraw:function(){this._mode&&this._mode._flushDrawBuffer&&
this._mode._flushDrawBuffer();this.inherited(arguments)},setDefinitionExpression:function(b){this.setFilter({where:b})},getDefinitionExpression:function(){var b;this._filter&&(b=this._filter.where);return b},destroy:function(){this.disconnect();this.inherited(arguments)},onResume:function(b){this.inherited(arguments)},setGeometryDefinition:function(b){this.setFilter({geometry:b})},getGeometryDefinition:function(){var b;this._filter&&(b=this._filter.geometry);return b},connect:function(b){var c=this,
e={},g=this._filter,a,m,p=this.socketUrl,h;try{if(!this._connected){if(this._map){var r;if(this._relatedUrl&&!this._relatedQueried&&this._mode._fetchArchive)return r=this.on("update-end",function(a){c._relatedQueried=!0;r.remove();r=null;a&&a.error?console.log("Not connecting. Error fetching related features"):c.connect()}),this._mode._fetchArchive(this._relatedUrl),!1;if(this._keepLatestUrl&&!this._keepLatestQueried&&this._mode._fetchArchive)return r=this.on("update-end",function(a){c._keepLatestQueried=
!0;r.remove();r=null;a&&a.error?console.log("Not connecting. Error fetching archived features"):c.connect()}),this._mode._fetchArchive(this._keepLatestUrl),!1}this._websocketToken&&(e.token=this._websocketToken);this._map&&(this._map.spatialReference&&this.spatialReference)&&this._map.spatialReference.wkid!==this.spatialReference.wkid&&(e.outSR=this._map.spatialReference.wkid);if(g)for(m in g)null!==g[m]&&(a="geometry"===m?JSON.stringify(g[m]):g[m],e[m]=a);p+="?"+d.objectToQuery(e);return h=this._createConnection(p,
b)}}catch(D){console.log("Error connecting to data stream: ",D),b&&b(D,!1),this.onConnectionError({error:D})}},disconnect:function(b){var c=this._refreshing?"Disconnecting as part of layer refresh cycle":"Connection closed from client",d=this._refreshing?!0:!1;this._reconnectTimeoutId&&clearTimeout(this._reconnectTimeoutId);this._refreshing=this._reconnecting=this._connected=!1;this.socket&&this.socket.close();this.onDisconnect({willReconnect:d,message:c});b&&b(null,!0)},setFilter:function(b){var c,
d;if(this._collection)return this.onError("Filter can only be set when the source of the layer is a Stream Service"),!1;try{if(void 0!==b.outFields)return d=Error("Outfields property cannot be changed after layer is created"),this.onFilterChange({filter:this.getFilter(),error:d}),!1;c=this._makeFilter(b)}catch(e){return d=Error(e),this.onFilterChange({filter:this.getFilter(),error:d}),!1}if(this.socket)b={filter:c},this.socket.send(JSON.stringify(b));else t.once(this,"connect",function(a){this.setFilter(c)});
return!0},getFilter:function(){var b=this._filter,c={},d=["geometry","outFields","where"];b&&n.forEach(d,function(d){var a=b[d];a&&("geometry"===d?a=y.fromJson(a):"outFields"===d&&(a=a.split(",")),c[d]=a)});return c},setMaximumTrackPoints:function(b){if(!b&&0!==b)return!1;this.maximumTrackPoints=b;this._mode.propertyChangeHandler(3)},getUniqueValues:function(b){var c,d={},e=[];c=this._getField(b,!0);if(!c)return e;b=c.name;n.forEach(this.graphics||[],function(a){a=(a.attributes||{})[b];void 0!==a&&
!d[a]&&(d[a]=1,e.push(a))});e.sort(function(a,b){return a<b?-1:a>b?1:0});return e},getLatestObservations:function(){var b=[];return b=this._trackManager?this._trackManager.getLatestObservations():this.graphics},setPurgeInterval:function(b){var c=this.purgeInterval;this.purgeInterval=b;this._togglePurgeT();b&&this._togglePurgeT(!0);if(c!==b)this.onPurgeIntervalChange();return this},_togglePurgeT:function(b){if(b&&this.purgeInterval){var c=this;clearTimeout(this._purgeT);this._mode&&this._mode._flushDrawBuffer&&
(this._purgeT=setTimeout(function(){!c.updating&&!c.suspended&&(c._mode._flushDrawBuffer(),c._togglePurgeT(!0))},6E4*this.purgeInterval))}else this._purgeT&&(clearTimeout(this._purgeT),this._refreshT=null)},onMessage:function(){},onConnect:function(){},onDisconnect:function(){},onFilterChange:function(){},onAttemptReconnect:function(){},onConnectionError:function(){},onPurgeIntervalChange:function(){},_createConnection:function(b,c){var d=this,e=new WebSocket(b);e.onopen=function(){d.socket=e;d._connected=
!0;d._reconnecting=!1;d._reconnectAttempts=0;d._bind();d.onConnect();c&&c(null,!0)};e.onclose=function(a){var b,p=!0,h=d._connected,r=null;if(d._connected||d._reconnecting){if(a.code)if(b="Connection failed: ",1001===a.code)b+=a.reason||"Service is going away.",p=!1;else if(4400===a.code)b+=a.reason||"Invalid url parameters. Check filter properties.",p=!1;else if(4404===a.code)b+="Service not found",p=!1;else if(4401===a.code||4403===a.code)b+="Not authorized",p=!1;p&&(d._reconnectAttempts+=1,d._reconnectAttempts>
d.maxReconnectAttempts&&(b="Maximum reconnect attempts exceeded",p=!1,h=!0));d._connected=!1;h&&(b&&(r=Error(b)),d.onDisconnect({error:r,willReconnect:p}));p?d._attemptReconnect():d.socket=null}else d.socket||(r=Error("Could not make connection to service"),d.onConnectionError({error:r})),d.socket=null,d._connected=!1};e.onerror=function(a){console.log("Socket error")};return e},_purge:function(){var b,c=[],d;if(this.purgeOptions.displayCount&&this.graphics.length>this.purgeOptions.displayCount)for(b=
0;b<this.graphics.length-this.purgeOptions.displayCount;b++)d=this.graphics[b],c.push(d);0<c.length&&(this._mode._removeFeatures(c),this._trackManager&&this._trackManager.removeFeatures(c))},_bind:function(){var b=this;this.socket.onmessage=function(c){b._onMessage(JSON.parse(c.data))}},_onMessage:function(b){var c=this;this.onMessage(b);var d={create:function(b){c._create(b)},update:function(b){c._update(b)},"delete":function(b){c._delete(b)}};if(b.type)d[b.type](b.feature);else b.hasOwnProperty("filter")?
c._handleFilterMessage(b):this._create(b)},_create:function(b){function c(a){if(!d._featureHasOID(a,e)){if(!a.geometry)return!1;a.attributes=a.attributes||{};a.attributes[e]=d._nextId++}a=a.declaredClass?a:new A(a);d._mode.drawFeature(a)}var d=this,e=d.objectIdField;b.length?b.forEach(function(a){a&&c(a)}):b&&c(b)},_delete:function(b){var c=this,d=b[c.objectIdField]||b.attributes[c.objectIdField],e=!1;this.graphics.forEach(function(a){a.attributes[c.objectIdField]==d&&(e=a)});e&&this.remove(e)},_update:function(b){var c=
this,d=!1;this.graphics.forEach(function(e){e.attributes[c.objectIdField]==b.attributes[c.objectIdField]&&(d=e)});d&&(b.attributes&&d.setAttributes(b.attributes),b.geometry&&d.setGeometry(y.fromJson(b.geometry)))},_makeFilter:function(b){var c,d=null;b=b||{};if(void 0!==b.geometry)if(d=d||{},null===b.geometry)d.geometry=null;else{c="string"===typeof b.geometry?y.fromJson(JSON.parse(b.geometry)):b.geometry.declaredClass?b.geometry:y.fromJson(b.geometry);if(!c||"point"===c.type)throw"Query object contains invalid geometry";
"extent"!==c.type&&(c=c.getExtent());if(!c||0===c.getHeight()&&0===c.getWidth())throw"Invalid filter geometry: Extent cannot have a height and width of 0";d.spatialRel="esriSpatialRelIntersects";d.geometryType="esriGeometryEnvelope";d.geometry=c.toJson()}void 0!==b.where&&(d=d||{},d.where=b.where);if(void 0!==b.outFields&&(d=d||{},b="string"===typeof b.outFields?"*"===b.outFields?null:b.outFields.replace(/,\s+/g,",").split(","):null===b.outFields?null:b.outFields,b=this._makeOutFields(b))){if(b.errors&&
0<b.errors.length)throw"Invalid filter outFields. "+b.errors.join(",");d.outFields=b.fields?b.fields.join(","):null}return d},_makeOutFields:function(b){var c=this,d=[],e=[],a={fields:null};if(!b||0===b.length)return a;n.forEach(b,function(b){if("*"===b)return a;var p=c._getField(b,!0);p?d.push(p.name):e.push("Field named "+b+" not found in schema.")});b=c._getOutFields();n.forEach(b,function(a){c._getField(a)&&-1===n.indexOf(d,a)&&d.push(a)});a.fields=d;a.errors=e;return a},_handleFilterMessage:function(b){b.error?
(b=Error(b.error.join(",")),this.onFilterChange({filter:this.getFilter(),error:b})):(b=b.filter,b.geometry&&"string"===typeof b.geometry&&(b.geometry=JSON.parse(b.geometry)),this._filter=b,this.onFilterChange({filter:this.getFilter()}))},_getWebsocketConnectionInfo:function(b){var c={urls:[]},d,e=[],a=[],m,p,h;b.streamUrls&&n.forEach(b.streamUrls,function(a){"ws"===a.transport&&(d=a.urls,c.token=a.token)});if(!d)return c;n.forEach(d,function(b){0===b.lastIndexOf("wss",0)?a.push(b):e.push(b)});b="https:"===
location.protocol||0===this.url.lastIndexOf("https:",0)?a:0===e.length?a:e;if(1<b.length)for(m=0;m<b.length-1;m++)p=m+Math.floor(Math.random()*(b.length-m)),h=b[p],b[p]=b[m],b[m]=h;c.urls=b;return c},_attemptReconnect:function(){var b=this,c;this._reconnectTimeoutId=null;b._connected=!1;if(!b._socketUrls)return!1;if(!b._collection&&!b._reconnecting&&b.socket&&b.credential)return b._reconnecting=!0,b._getServiceConnectionMetadata(b._attemptReconnect),!1;b._reconnecting=!0;b.socket=null;if(b._reconnectAttempts>
b.maxReconnectAttempts)return b._reconnecting=!1;b.socketUrl=b._socketUrls[b._reconnectAttempts>b._socketUrls.length-1?b._reconnectAttempts%b._socketUrls.length:b._reconnectAttempts];b.socketUrl+="/"+b.socketDirection;c=b._randomIntFromInterval(0,1E3);this._reconnectTimeoutId=setTimeout(function(){b.onAttemptReconnect({count:b._reconnectAttempts,url:b.socketUrl});b.connect()},1E3*b._reconnectAttempts+c)},_getServiceConnectionMetadata:function(b){var c=this,d=c._url.path;b="function"===typeof b?b:
null;x({url:d,content:k.mixin({f:"json"},this._url.query),callbackParamName:"callback"}).then(function(d){d=c._getWebsocketConnectionInfo(d);c._websocketToken=d.token;b&&b()},function(b){c.onError(Error(b))})},_setDefaultRenderer:function(){var c=this.geometryType,d=new e([5,112,176,0.8]),g=new e([255,255,255]),g=new b(b.STYLE_SOLID,g,1),k;if("esriGeometryPoint"===c||"esriGeometryMultipoint"===c)k=new v(v.STYLE_CIRCLE,10,g,d);else if("esriGeometryPolyline"===c)k=new b(b.STYLE_SOLID,d,2);else if("esriGeometryPolygon"===
c||"esriGeometryEnvelope"===c)d=new e([5,112,176,0.2]),g=new e([5,112,176,0.8]),g=new b(b.STYLE_SOLID,g,1),k=new C(C.STYLE_SOLID,g,d);k&&this.setRenderer(new H(k))},_makeObjectIdField:function(){var b=1,c,d,e=[];if(!this.objectIdField){c=this.fields.length;for(d=0;d<c;d++)e.push(this.fields[d].name.toLowerCase());for(;-1!==n.indexOf(e,"objectid_"+b);)b+=1;this.objectIdField="objectid_"+b;this.fields.push({name:"objectid_"+b,type:"esriFieldTypeOID",alias:"objectid_"+b,nullable:!1})}},_featureHasOID:function(b,
c){return b.attributes&&(b.attributes[c]||0===b.attributes[c])},_randomIntFromInterval:function(b,c){return Math.floor(Math.random()*(c-b+1)+b)}})})},"esri/layers/StreamTrackManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../geometry/Polyline ./TrackManager".split(" "),function(q,l,n,e,k,u,d,t){return q([t],{declaredClass:"esri.layers._StreamTrackManager",constructor:function(c){this.inherited(arguments)},initialize:function(c){this.inherited(arguments)},
addFeatures:function(c,d){function e(b,c){var d,f,g,l;k[b]||(k[b]=[]);d=k[b];0<q&&(c.length>q&&c.splice(0,c.length-q),g=c.length+d.length,g>q&&(f=d.splice(0,g-q)));g=c.length;for(l=0;l<g;l+=1)d.push(c[l]);return{deletes:f,adds:c}}var k,l,t,q,u={},C={},b;if(d)return this.inherited(arguments),u;k=this.trackMap;l=this.layer;t=l._trackIdField;q=l.maximumTrackPoints||0;n.forEach(c,function(b){var c=b.attributes[t];b.visible&&(C[c]||(C[c]=[]),C[c].push(b))});for(b in C)C.hasOwnProperty(b)&&(l=e(b,C[b]),
u[b]=l);return u},removeFeatures:function(c){var d=[],e=this.layer.objectIdField,k=this.layer._trackIdField;c&&(n.forEach(c,function(c){var l,t,q,u;t=c.attributes[k];l=c.attributes[e];if(q=this.trackMap[t])for(c=0;c<q.length;c+=1)if(u=q[c],u.attributes[e]===l){this.trackMap[t].splice(c,1);-1===n.indexOf(t)&&d.push(t);break}},this),0<c.length&&this.refreshTracks(d))},drawTracks:function(c){function e(c){var b=t[c],g=b&&1<b.length,n,s,f;if((f=k.trackLineMap[c])&&!g)l.remove(f),delete k.trackLineMap[c],
f=null;if(!g)return!1;g=[];for(n=b.length-1;0<=n;n-=1)(s=b[n].geometry)&&g.push([s.x,s.y]);b={};b[B]=c;1<g.length&&(f?(c=f.geometry,c.removePath(0),c.addPath(g),f.setGeometry(c)):(f=new u(new d({paths:[g],spatialReference:q}),null,b),l.add(f),k.trackLineMap[c]=f))}var k=this,l=this.container,t,q,B,y;if(l)if(t=this.trackMap,q=this.map.spatialReference,B=this.layer._trackIdField,c)n.forEach(c,function(c){e(c)});else for(y in t)t.hasOwnProperty(y)&&e(y)},refreshTracks:function(c){function d(c){var g,
l;c=e[c]||[];g=c.length;for(l=0;l<g;l++)k._repaint(c[l],null,!0)}var e=this.trackMap,k=this.layer;k._getRenderer();var l;this.drawTracks(c);if(c)n.forEach(c,function(c){d(c)});else for(l in e)e.hasOwnProperty(l)&&d(l)},getLatestObservations:function(){var c,d,e=this.trackMap,k=[];for(c in e)e.hasOwnProperty(c)&&(d=e[c],k.push(d[d.length-1]));return k},destroy:function(){this.inherited(arguments);this.trackLineMap=null}})})},"esri/layers/PurgeOptions":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/Stateful","dojo/has","../kernel"],function(q,l,n,e,k){return q([n],{declaredClass:"esri.layers.PurgeOptions",constructor:function(e,d){this.parent=e;for(var k in d)this[k]=d[k]},_displayCountSetter:function(e){this.displayCount=e;this.parent.refresh()}})})},"esri/layers/WFSLayer":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/on ../request ../kernel ../graphic ../renderers/jsonUtils ../symbols/jsonUtils ../Color ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent ../geometry/Point ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ./LabelClass ./GraphicsLayer".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C,b,v,H,s,f,G,z,w){return q([w],{declaredClass:"esri.layers.WFSLayer",constructor:function(a){this.geometryType=this.getFeatureUrl=this.layerNamespace="";this.fields=[];this.spatialReferences=[];this.fullExtent=null;this.visible=!0;this.renderer=null;this.id="WFSLayer";this._url="";this._version="1.1.0";this._layerName="";this._nsLayerNames={};this._layerDefinedGeometryType="esriGeometryComplex";this._wkid=3857;this._mode="snapshot";this._maxFeatures=100;this._inverseResponse=
this._inverseFilter=!1;this._nsGeometryFieldName=this._getFeatureRequest=this._nsFields="";this._graphicArray=[];this._gmlNS="http://www.opengis.net/gml";this._layerEventHandlers=[];this._describeFeatureTypeCallback=this._getCapabilitiesCallback=null;this.showLabels=!0;this.labelingInfo=null;a&&(a.id&&(this.id=a.id),this.showLabels=null!==a.showLabels?a.showLabels:!0);this.onError=n.hitch(this,this.onError);this._errorSupport=n.hitch(this,this._errorSupport);this._parseGml=n.hitch(this,this._parseGml);
this._getCapabilities=n.hitch(this,this._getCapabilities);this._getCapabilitiesResponse=n.hitch(this,this._getCapabilitiesResponse);this._describeFeatureTypeResponse=n.hitch(this,this._describeFeatureTypeResponse);this._pointSymbol=new F(F.STYLE_CIRCLE,6,new B(B.STYLE_SOLID,new E([0,255,0]),1),new E([255,0,0]));this._lineSymbol=new B(B.STYLE_SOLID,new E([0,255,0]),3);this._polygonSymbol=new y(y.STYLE_SOLID,new B(B.STYLE_SOLID,new E([255,0,0]),2),new E([255,255,0,0.25]));this.loaded=!1;this._isProjectedOk=
!0},initialize:function(a,b){a.id&&(this.id=a.id);a.url&&(this._url=a.url);a.version&&(this._version=a.version);this._getCapabilities(b)},selectLayer:function(a,b){this._layerName=a.layerName;this._wkid=a.wkid;this._mode=a.mode;this._maxFeatures=a.maxFeatures;this._inverseResponse=a.swapXY;this._inverseFilter=a.swapXYFilter;this.geometryType=a.geometryType;this._describeFeatureType(b);this.loaded=!0},toJson:function(){var a={};a.id=this.id;a.url=this._url;a.version=this._version;a.mode="snapshot"===
this._mode?0:1;a.name=this._layerName;a.geometryType=this.geometryType;a.wkid=this._wkid;a.maxFeatures=this._maxFeatures;a.swapXY=this._inverseResponse;a.swapXYFilter=this._inverseFilter;a.pointSymbol=this._pointSymbol.toJson();a.lineSymbol=this._lineSymbol.toJson();a.polygonSymbol=this._polygonSymbol.toJson();a.showLabels=this.showLabels;this.labelingInfo&&(a.labelingInfo=e.map(this.labelingInfo,function(a){return a.toJson()}));return a},fromJson:function(a,b){a.id&&(this.id=a.id);a.url&&(this._url=
a.url);a.version&&(this._version=a.version);a.mode&&(this._mode=0===a.mode?"snapshot":"onDemand");a.name&&(this._layerName=a.name);a.geometryType&&(this.geometryType=a.geometryType);a.wkid&&(this._wkid=a.wkid);a.maxFeatures&&(this._maxFeatures=a.maxFeatures);a.swapXY&&(this._inverseResponse=a.swapXY);a.swapXYFilter&&(this._inverseFilter=a.swapXYFilter);a.pointSymbol&&(this._pointSymbol=A.fromJson(a.pointSymbol));a.lineSymbol&&(this._lineSymbol=A.fromJson(a.lineSymbol));a.polygonSymbol&&(this._polygonSymbol=
A.fromJson(a.polygonSymbol));this.showLabels=null!=a.showLabels?a.showLabels:!0;a.labelingInfo&&(this.labelingInfo=e.map(a.labelingInfo,function(a){return new z(a)}));this._getCapabilities(b);this.loaded=!0},setPointSymbol:function(a){this._pointSymbol=a},setLineSymbol:function(a){this._lineSymbol=a},setPolygonSymbol:function(a){this._polygonSymbol=a},_setMap:function(a){this._map=a;var b=this.inherited(arguments);this._map&&(this._layerEventHandlers.push(this._map.on("extent-change",n.hitch(this,
"refresh"))),this._layerEventHandlers.push(this.on("visibility-change",n.hitch(this,"_visibilityChange"))));this._getFeature();this.refresh();return b},_unsetMap:function(){for(var a=0;a<this._layerEventHandlers.length;a++)k.disconnect(this._layerEventHandlers[a]);this.refresh();this.inherited(arguments)},refresh:function(a){this.clear();this.redraw();"ondemand"===this._mode.toLowerCase()&&this._fireUpdateStart()},redraw:function(){if(this.visible)for(var a=0;a<this._graphicArray.length;a++){var b=
this._graphicArray[a],c=b.geometry,h=null;"point"===c.type?h=this.renderer?this.renderer.getSymbol(b):this._pointSymbol:"multipoint"===c.type?h=this.renderer?this.renderer.getSymbol(b):this._pointSymbol:"polyline"===c.type?h=this.renderer?this.renderer.getSymbol(b):this._lineSymbol:"polygon"===c.type&&(h=this.renderer?this.renderer.getSymbol(b):this._polygonSymbol);b.setSymbol(h);this.add(b)}},_visibilityChange:function(a){this.visible=a.visible;this.redraw()},onUpdateStart:function(){this._getFeature()},
onUpdateEnd:function(){this.clear();this.redraw()},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this.onLabelingInfoChange()},onLabelingInfoChange:function(){},_fixLabelExpr:function(){var a=/\[([^\[\]]+)\]/ig,b,c=this,h=function(a,b){var h=c._getField(b,!0);return"["+(h&&h.name||b)+"]"};e.forEach(this.labelingInfo,function(c){if(b=c.labelExpression)c.labelExpression=b.replace(a,h)})},_getField:function(a,b){var c=this.fields;if(!c||0===c.length)return null;
var h;b&&(a=a.toLowerCase());e.some(c,function(c){var d=!1;(d=b?c&&c.name.toLowerCase()===a?!0:!1:c&&c.name===a?!0:!1)&&(h=c);return d});return h},_getCapabilities:function(a){this._getCapabilitiesCallback=a;a=n.trim(this._url);if(""===a)this.onError("WFSLayer: url is invalid");else if("1.0.0"!==this._version&&"1.1.0"!==this._version&&"2.0.0"!==this._version)this.onError("WFSLayer: version is invalid");else if(""!==a){var b=-1===a.indexOf("?")?"?":"\x26";t({url:a+b+"service\x3dWFS\x26request\x3dGetCapabilities\x26version\x3d"+
this._version,handleAs:"text",headers:{"Content-Type":null},timeout:1E4},{usePost:!1}).then(this._getCapabilitiesResponse,this._errorSupport)}},_errorSupport:function(a){this.onError(a)},_getCapabilitiesResponse:function(a){var b,c,h,d;h=(new DOMParser).parseFromString(a,"text/xml");if(a=this._readExceptionReport(h,a))this.onError("WFSLayer: getCapabilities - returns exception: "+a);else{this._version=h.documentElement.attributes.getNamedItem("version").value;a="2.0.0"===this._version?"http://www.opengis.net/wfs/2.0":
"http://www.opengis.net/wfs";if("2.0.0"===this._version){b=h.getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Operation");for(c=0;c<b.length;c++)if((d=b[c].attributes.getNamedItem("name"))&&"GetFeature"===d.value)d=b[c].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Post"),this.getFeatureUrl=d[0].attributes.getNamedItem("xlink:href").value}else if("1.1.0"===this._version){b=h.getElementsByTagNameNS("http://www.opengis.net/ows","Operation");for(c=0;c<b.length;c++)if((d=b[c].attributes.getNamedItem("name"))&&
"GetFeature"===d.value)d=b[c].getElementsByTagNameNS("http://www.opengis.net/ows","Post"),this.getFeatureUrl=d[0].attributes.getNamedItem("xlink:href").value}else if("1.0.0"===this._version){c=h.getElementsByTagNameNS(a,"GetFeature");if(!c||!c.length){this.onError("WFSLayer: getCapabilities - no GetFeature info");return}d=c[0].getElementsByTagNameNS(a,"Post");this.getFeatureUrl=d[0].attributes.getNamedItem("onlineResource").value}this._nsLayerNames={};b=[];d=h.getElementsByTagNameNS(a,"FeatureTypeList");
for(c=0;c<d.length;c++){var e=d[c].getElementsByTagNameNS(a,"FeatureType");for(h=0;h<e.length;h++){var f=e[h],k=f.getElementsByTagNameNS(a,"Name")[0],g=k.textContent,l=g.indexOf(":"),s=g.substring(0,l),g=g.substring(l+1),l=k.lookupNamespaceURI(s);null===l&&(l=k.lookupNamespaceURI(null));this._nsLayerNames[g]={prefix:s,namespace:l};k=f.getElementsByTagNameNS(a,"Title");k=0<k.length?k[0].textContent:"";""===k&&(k=g);this.spatialReferences=this._readFactoryCodes(this._version,f);f=this._readDefaultBBOX(this._version,
f);b.push({name:g,title:k,spatialReferences:this.spatialReferences,extent:f})}}this._describeFeatureType();(a=this._getCapabilitiesCallback)&&a(b)}},_readFactoryCodes:function(a,b){var c,h,d=[];if("2.0.0"===a||"1.1.0"===a){c=b.getElementsByTagNameNS("*","DefaultSRS");this._addCodeList(d,c[0]);c=b.getElementsByTagNameNS("*","DefaultCRS");this._addCodeList(d,c[0]);c=b.getElementsByTagNameNS("*","OtherSRS");for(h=0;h<c.length;h++)this._addCodeList(d,c[h]);c=b.getElementsByTagNameNS("*","OtherCRS");for(h=
0;h<c.length;h++)this._addCodeList(d,c[h])}else"1.0.0"===a&&(c=b.getElementsByTagNameNS("*","SRS"),this._addCodeList(d,c[0]));for(c=!1;0<d.length;){4326===d[0]&&(c=!0);break}c||d.push(4326);return d},_addCodeList:function(a,b){if(b){var c=b.textContent.match(/\d+/g);0<c.length&&(c=parseInt(c[c.length-1],10),84===c&&(c=4326),a.push(c))}},_readDefaultBBOX:function(a,b){var c,h,d,e;if("2.0.0"===a||"1.1.0"===a){c=b.getElementsByTagNameNS("*","WGS84BoundingBox");h=c[0].getElementsByTagNameNS("*","LowerCorner");
e=c[0].getElementsByTagNameNS("*","UpperCorner");if(0>=h.length||0>=e.length)return[];d=h[0].textContent;c=d.indexOf(" ");h=d.substring(0,c);d=d.substring(c+1);c=e[0].textContent;var f=c.indexOf(" ");e=c.substring(0,f);c=c.substring(f+1)}else if("1.0.0"===a){c=b.getElementsByTagNameNS("*","LatLongBoundingBox");if(!c[0]||!c[0].attributes)return[];h=c[0].attributes.getNamedItem("minx").value;d=c[0].attributes.getNamedItem("miny").value;e=c[0].attributes.getNamedItem("maxx").value;c=c[0].attributes.getNamedItem("maxy").value}h=
parseFloat(h,10);d=parseFloat(d,10);e=parseFloat(e,10);c=parseFloat(c,10);return[h,d,e,c]},_describeFeatureType:function(a){if(""!==this._layerName)if(""===this._wkid)this.onError("WFSLayer: invalid wkid");else if("snapshot"!==this._mode&&"onDemand"!==this._mode)this.onError("WFSLayer: invalid mode");else if(""===this._maxFeatures||0>this._maxFeatures||1E6<this._maxFeatures)this.onError("WFSLayer: invalid maxFeatures");else if(this._describeFeatureTypeCallback=a,a=n.trim(this._url),""!==a){var b=
-1===a.indexOf("?")?"?":"\x26",c=this._nsLayerNames[this._layerName];if(void 0===c)this.onError("WFSLayer: invalid layerName");else{var h=c.prefix;t({url:a+b+"service\x3dWFS\x26request\x3dDescribeFeatureType\x26version\x3d"+this._version+"\x26typeName\x3d"+h+":"+this._layerName+"\x26namespace\x3dxmlns("+h+"\x3d"+c.namespace+")",handleAs:"text",headers:{"Content-Type":null},timeout:1E4},{usePost:!1}).then(this._describeFeatureTypeResponse,this._errorSupport)}}},_describeFeatureTypeResponse:function(a){var b;
b=(new DOMParser).parseFromString(a,"text/xml");if(a=this._readExceptionReport(b,a))this.onError("WFSLayer: DescribeFeatureType - returns exception: "+a);else{this.fields=[];a=b.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","schema");for(b=0;b<a.length;b++){var c=a[b],h=this._getComplexTypeByName(c);if(null!==h){var d=h[0];this._nsFields=h[1];c=this._readFields(c,d);this._layerDefinedGeometryType=c[0];if(!this.geometryType||""===this.geometryType)this.geometryType=this._layerDefinedGeometryType;
this.fields=c[1]}}for(b=0;b<this.fields.length;b++)a=this.fields[b],"esriFieldTypeGeometry"===a.type&&(this._nsGeometryFieldName=a.name);this.layerNamespace=this._nsLayerNames[this._layerName].namespace;if(0===this.fields.length)this.onError("WFSLayer: DescribeFeatureType - can't get fields");else this._getFeature(),(b=this._describeFeatureTypeCallback)&&b(this.fields)}},_readFields:function(a,b){var c,h,d=[],e="esriGeometryComplex",f=a.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","complexType");
for(c=0;c<f.length;c++){h=f[c];var k="",g=h.attributes.getNamedItem("name");g&&(k=g.value);if(k===b){k=h.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","element");for(h=0;h<k.length;h++){var l=k[h],g="",s=l.attributes.getNamedItem("name");s&&(g=s.value);if(""!==g){var v="",s="",n=l.attributes.getNamedItem("type"),v="unknown";null!==n?(s=n.value,l=s.indexOf(":"),v=s.substring(0,l),s=s.substring(l+1),v=n.lookupNamespaceURI(v),null===v&&(v=n.lookupNamespaceURI(null))):(n=this._readSchemaSimpleType(l),
null!==n&&(v=n.namespace,s=n.type));n="Unknown";switch(s){case "integer":case "nonPositiveInteger":case "negativeInteger":case "long":case "int":case "short":case "byte":case "nonNegativeInteger":case "unsignedLong":case "unsignedInt":case "unsignedShort":case "unsignedByte":case "positiveInteger":n="esriFieldTypeInteger";d.push({name:g,alias:g,type:n,wfsNamespace:v});break;case "float":case "double":case "decimal":n="esriFieldTypeDouble";d.push({name:g,alias:g,type:n,wfsNamespace:v});break;case "boolean":case "string":case "gYearMonth":case "gYear":case "gMonthDay":case "gDay":case "gMonth":case "anyURI":case "QName":case "NOTATION":case "normalizedString":case "token":case "language":case "IDREFS":case "ENTITIES":case "NMTOKEN":case "NMTOKENS":case "Name":case "NCName":case "ID":case "IDREF":case "ENTITY":n=
"esriFieldTypeString";d.push({name:g,alias:g,type:n,wfsNamespace:v});break;case "duration":case "dateTime":case "time":case "date":n="esriFieldTypeDate";d.push({name:g,alias:g,type:n,wfsNamespace:v});break;case "PointPropertyType":case "MultiPointPropertyType":n="esriFieldTypeGeometry";e="esriGeometryPoint";d.push({name:g,alias:g,type:n,wfsNamespace:v});break;case "MultiCurvePropertyType":case "MultiLineStringPropertyType":n="esriFieldTypeGeometry";e="esriGeometryPolyline";d.push({name:g,alias:g,
type:n,wfsNamespace:v});break;case "MultiSurfacePropertyType":case "MultiPolygonPropertyType":n="esriFieldTypeGeometry";e="esriGeometryPolygon";d.push({name:g,alias:g,type:n,wfsNamespace:v});break;case "GeometryPropertyType":case "MultiGeometryPropertyType":n="esriFieldTypeGeometry",e="esriGeometryComplex",d.push({name:g,alias:g,type:n,wfsNamespace:v})}}}}}return[e,d]},_readSchemaSimpleType:function(a){a=a.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","restriction");if(0<a.length&&(a=
a[0].attributes.getNamedItem("base"))){var b=a.value,c=b.indexOf(":");if(-1!=c){var h=b.substring(0,c),b=b.substring(c+1),h=a.lookupNamespaceURI(h);null===h&&(h=a.lookupNamespaceURI(null));return{namespace:h,type:b}}}return null},_getComplexTypeByName:function(a){for(var b=a.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","element"),c=0;c<b.length;c++){var h=b[c];if(h.attributes.getNamedItem("name").value===this._layerName)return c=h.attributes.getNamedItem("type").value,h=c.indexOf(":"),
b=c.substring(0,h),c=c.substring(h+1),a=a.attributes.getNamedItem("xmlns:"+b).value,[c,a]}return null},_getFeature:function(){var a;a="\x3c?xml version\x3d'1.0' encoding\x3d'utf-8'?\x3e\n\x3cGetFeature \n";a+=" xmlns:xsi\x3d'http://www.w3.org/2001/XMLSchema-instance'\n";a+=" xmlns:gml\x3d'http://www.opengis.net/gml'\n";a+=" xmlns:ogc\x3d'http://www.opengis.net/ogc'\n";a+=" xmlns:wfs\x3d'http://www.opengis.net/wfs'\n";a="2.0.0"===this._version?a+" xmlns\x3d'http://www.opengis.net/wfs/2.0'\n":a+" xmlns\x3d'http://www.opengis.net/wfs'\n";
var b=this._nsLayerNames[this._layerName];if(void 0===b)this.onError("WFSLayer: invalid layerName");else{var c=b.prefix,b=b.namespace;if("ondemand"===this._mode.toLowerCase()&&""===this._nsGeometryFieldName)this.onError("WFSLayer: GetFeature - can't use 'onDemand' mode as geometryFieldName is unknown.");else if(a+=" xmlns:"+c+"\x3d'"+b+"'\n",a="2.0.0"===this._version?a+(" version\x3d'"+this._version+"' service\x3d'WFS' count\x3d'"+this._maxFeatures+"'\x3e\n"):a+(" version\x3d'"+this._version+"' service\x3d'WFS' maxFeatures\x3d'"+
this._maxFeatures+"'\x3e\n"),a="2.0.0"===this._version?a+(" \x3cQuery typeNames\x3d'"+c+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"):a+(" \x3cwfs:Query typeName\x3d'"+c+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"),"ondemand"===this._mode.toLowerCase()&&(a+="  \x3cogc:Filter xmlns:ogc\x3d'http://www.opengis.net/ogc'\x3e\n",a+="   \x3cogc:BBOX\x3e\n",a+="    \x3cogc:PropertyName\x3e"+c+":"+this._nsGeometryFieldName+"\x3c/ogc:PropertyName\x3e\n",a+="    \x3cgml:Box srsName\x3d'EPSG:"+
this._wkid+"'\x3e\n",a=this._inverseFilter?a+"      \x3cgml:coordinates\x3e{ymin},{xmin} {ymax},{xmax}\x3c/gml:coordinates\x3e\n":a+"      \x3cgml:coordinates\x3e{xmin},{ymin} {xmax},{ymax}\x3c/gml:coordinates\x3e\n",a+="    \x3c/gml:Box\x3e\n",a+="   \x3c/ogc:BBOX\x3e\n",a+="  \x3c/ogc:Filter\x3e\n"),a="2.0.0"===this._version?a+" \x3c/Query\x3e\n":a+" \x3c/wfs:Query\x3e\n",this._getFeatureRequest=a+="\x3c/GetFeature\x3e\n",""!==this.getFeatureUrl&&""!==this._getFeatureRequest&&this._map&&null!==
this._map.spatialReference.wkid){a=this._getFeatureRequest;if("ondemand"===this._mode.toLowerCase()){a=this._map.extent.xmin;var c=this._map.extent.ymin,b=this._map.extent.xmax,h=this._map.extent.ymax,d={},e=this._map.spatialReference,f=new C(this._wkid);this._projectFromSRToSR(e,f,a,c,d)&&(a=d.x,c=d.y);this._projectFromSRToSR(e,f,b,h,d)&&(b=d.x,h=d.y);a=this._getFeatureRequest.replace(/{xmin}/,a).replace(/{ymin}/,c).replace(/{xmax}/,b).replace(/{ymax}/,h)}t({url:this.getFeatureUrl,handleAs:"text",
headers:{"Content-Type":null},postData:a,timeout:1E4},{usePost:!0}).then(this._parseGml,this._errorSupport)}}},_parseGml:function(a){if(this._map&&this._map.spatialReference&&this._map.spatialReference.wkid){var b=(new DOMParser).parseFromString(a,"text/xml");if(a=this._readExceptionReport(b,a))this.onError("WFSLayer: GetFeature - returns exception: "+a);else this._gmlNS="2.0.0"===this._version?"http://www.opengis.net/gml/3.2":"http://www.opengis.net/gml",""===this._wkid&&(this._wkid=this._map.spatialReference.wkid),
this._graphicArray=this._readFeatureMembers(b,this._wkid,2,this._nsLayerNames[this._layerName].namespace,this._layerName),this.fullExtent=this._createFullExtent(this._graphicArray),this.onLabelingInfoChange(),"ondemand"===this._mode.toLowerCase()?this._fireUpdateEnd():this.refresh()}},_limit4326:function(a){for(var b=0;b<a.length;b++){var c=a[b].geometry;4326===c.spatialReference.wkid&&(c.x=this._limit4326X(c.x),c.y=this._limit4326Y(c.y))}},_limit4326X:function(a){180<=a&&(a=179.99);-180>=a&&(a=-179.99);
return a},_limit4326Y:function(a){90<=a&&(a=89.99);-90>=a&&(a=-89.99);return a},_createFullExtent:function(a){for(var b=null,c=0;c<a.length;c++){var h=a[c].geometry,d=null;(d="point"===h.geometryType?new v(h.x,h.y,h.x,h.y,h.spatialReference):h.getExtent())&&(b=null===b?d:b.union(d))}return b},_readExceptionReport:function(a,b){return 0<a.getElementsByTagNameNS("*","ExceptionReport").length||0<a.getElementsByTagNameNS("*","ServiceExceptionReport").length?b:""},_readFeatureMembers:function(a,b,c,h,
d){var e,f,g,k;f=this._readWkidFromNode(a);-1!=f&&(b=f);f=this._readSrsDimension(a);0!==f&&(c=f);var l=[];g=a.getElementsByTagNameNS("*","featureMembers");for(f=0;f<g.length;f++){e=g[f];k=e.getElementsByTagNameNS(h,d);0===k.length&&(k=e.getElementsByTagNameNS(null,d));0===k.length&&(k=e.getElementsByTagNameNS("*",d));for(e=0;e<k.length;e++)this._readLayer(l,k[e],b,c)}g=a.getElementsByTagNameNS("*","featureMember");for(f=0;f<g.length;f++){e=g[f];k=e.getElementsByTagNameNS(h,d);0===k.length&&(k=e.getElementsByTagNameNS(null,
d));0===k.length&&(k=e.getElementsByTagNameNS("*",d));for(e=0;e<k.length;e++)this._readLayer(l,k[e],b,c)}g=a.getElementsByTagNameNS("*","member");for(f=0;f<g.length;f++){e=g[f];k=e.getElementsByTagNameNS(h,d);0===k.length&&(k=e.getElementsByTagNameNS(null,d));0===k.length&&(k=e.getElementsByTagNameNS("*",d));for(e=0;e<k.length;e++)this._readLayer(l,k[e],b,c)}return l},_readLayer:function(a,b,c,h){var d,e;e=this._readSrsDimension(b);0!==e&&(h=e);var f=b.childNodes,k="",g=null;for(b=0;b<f.length;b++)if(d=
f[b],1==d.nodeType&&(e=d.localName,"boundedBy"!==e)){d=this._readGeometry(d,c,h);if(!this._isProjectedOk){this._isProjectedOk=!0;console.error("WFSLayer: could not project geometry.");break}if(null!==d){g=d;k=e;break}}if(g){c={};for(b=0;b<f.length;b++)if(d=f[b],e=d.localName,h=d.textContent,e!==k)for(d=0;d<this.fields.length;d++){var l=this.fields[d];l.name==e&&(c[e]="esriFieldTypeDouble"===l.type?parseFloat(h,10):"esriFieldTypeInteger"===l.type?parseInt(h,10):h.trim())}this._convertWFSGeometryToGraphicObjects(a,
g,c)}},_convertWFSGeometryToGraphicObjects:function(a,b,c){var h;if("point"===b.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))h=new g,b=new H(b),h.setGeometry(b),h.setAttributes(c),a.push(h);else if("multipoint"===b.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))h=new g,b=new s(b),h.setGeometry(b),h.setAttributes(c),a.push(h);else if("polyline"===b.geometryType&&("esriGeometryPolyline"===this.geometryType||
"esriGeometryComplex"===this.geometryType))h=new g,b=new f(b),h.setGeometry(b),h.setAttributes(c),a.push(h);else if("polygon"===b.geometryType&&("esriGeometryPolygon"===this.geometryType||"esriGeometryComplex"===this.geometryType))h=new g,b=new G(b),h.setGeometry(b),h.setAttributes(c),a.push(h);else if("multigeometry"===b.geometryType)for(h=0;h<b.length;h++)this._convertWFSGeometryToGraphicObjects(a,b[h],c)},_readGeometry:function(a,b,c){var h,d;h=this._readWkidFromNode(a);-1!=h&&(b=h);h=this._readSrsDimension(a);
0!==h&&(c=h);d=a.getElementsByTagNameNS(this._gmlNS,"MultiSurface");if(1<=d.length)for(h=0;h<d.length;)return this._readMultiSurface(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"MultiCurve");if(1<=d.length){var e=[];for(h=0;h<d.length;h++){var f=this._readMultiCurve(d[h],b,c);for(a=0;a<f.length;a++)e.push(f[a])}return{geometryType:"polyline",paths:e,spatialReference:{wkid:this._map.spatialReference.wkid}}}d=a.getElementsByTagNameNS(this._gmlNS,"MultiGeometry");for(h=0;h<d.length;)return this._readMultiGeometry(d[h],
b,c);d=a.getElementsByTagNameNS(this._gmlNS,"Geometry");for(h=0;h<d.length;)return this._readGeometry(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"GeometryCollection");for(h=0;h<d.length;)return this._readGeometryCollection(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"Surface");for(h=0;h<d.length;)return this._readSurface(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"Curve");for(h=0;h<d.length;)return this._readCurve(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"MultiPolygon");for(h=
0;h<d.length;)return this._readMultiPolygon(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(h=0;h<d.length;)return this._readPolygon(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"MultiLineString");for(h=0;h<d.length;)return this._readMultiLineString(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(h=0;h<d.length;){b=this._readLineString(d[h],b,c);c={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};h=[];for(a=0;a<b.length;a++)h.push(b[a]);
c.paths.push(h);return c}d=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");for(h=0;h<d.length;)return this._readLinearRing(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"Box");if(1<=d.length)for(h=0;h<d.length;)return this._readBox(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"Envelope");for(h=0;h<d.length;)return this._readEnvelope(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,"MultiPoint");if(1<=d.length)for(h=0;h<d.length;)return this._readMultiPoint(d[h],b,c);d=a.getElementsByTagNameNS(this._gmlNS,
"Point");for(h=0;h<d.length;)return this._readPoint(d[h],b,c);return null},_readGeometryCollection:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=a.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(a=0;a<d.length;a++){var f=this._readGeometryMember(d[a],b,c);e.push(f)}return e},_readMultiGeometry:function(a,b,c){var d,e=this._readWkidFromNode(a);
-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=a.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(a=0;a<d.length;a++){var f=this._readGeometryMember(d[a],b,c);e.push(f)}return e},_readSurface:function(a,b,c){var d,e;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);var f=[];f.geometryType="multigeometry";f.spatialReference={wkid:this._map.spatialReference.wkid};
e=a.getElementsByTagNameNS(this._gmlNS,"Point");for(d=0;d<e.length;d++)f.push(this._readPoint(e[d],b,c));e=a.getElementsByTagNameNS(this._gmlNS,"patches");for(d=0;d<e.length;d++){a=this._readPatches(e[d],b,c);for(var g=0;g<a.length;g++)f.push(a[g])}return f},_readMultiSurface:function(a,b,c){var d,e,f;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);var g=[];g.geometryType="multigeometry";g.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,
"surfaceMember");for(d=0;d<f.length;d++){var k=this._readSurfaceMember(f[d],b,c);for(e=0;e<k.length;e++)g.push(k[e])}f=a.getElementsByTagNameNS(this._gmlNS,"surfaceMembers");for(d=0;d<f.length;d++){a=this._readSurfaceMembers(f[d],b,c);for(e=0;e<a.length;e++)g.push(a[e])}return g},_readCurve:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=a.getElementsByTagNameNS(this._gmlNS,
"segments");for(a=0;a<d.length;a++)for(var f=this._readSegments(d[a],b,c),g=0;g<f.length;g++)e.paths.push(f[g]);return e},_readSegments:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=a.getElementsByTagNameNS(this._gmlNS,"LineStringSegment");for(a=0;a<d.length;a++){var f=this._readLineStringSegment(d[a],b,c);e.push(f)}return e},_readLineStringSegment:function(a,
b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"posList");0<a.length;)return this._readPosList(a[0],b,c)},_readMultiCurve:function(a,b,c){var d,e,f,g;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);var k=[];k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"curveMember");for(d=0;d<f.length;d++){g=this._readCurveMember(f[d],b,c);for(e=
0;e<g.length;e++)k.push(g[e])}f=a.getElementsByTagNameNS(this._gmlNS,"curveMembers");for(d=0;d<f.length;d++){g=this._readCurveMembers(f[d],b,c);for(e=0;e<g.length;e++)k.push(g[e])}return k},_readGeometryMember:function(a,b,c){var d,e;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);e=a.getElementsByTagNameNS(this._gmlNS,"Point");for(d=0;d<e.length;)return this._readPoint(e[d],b,c);e=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(d=0;d<e.length;){b=this._readLineString(e[d],
b,c);c={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=[];for(a=0;a<b.length;a++)d.push(b[a]);c.paths.push(d);return c}e=a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(d=0;d<e.length;)return this._readPolygon(e[d],b,c);return null},_readSurfaceMember:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=
a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(a=0;a<d.length;a++){var f=this._readPolygon(d[a],b,c);e.push(f)}return e},_readSurfaceMembers:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(a=0;a<d.length;a++){var f=this._readPolygon(d[a],b,c);e.push(f)}return e},_readCurveMember:function(a,b,
c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(a=0;a<d.length;a++){var f=this._readLineString(d[a],b,c);e.push(f)}return e},_readCurveMembers:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};
d=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(a=0;a<d.length;a++){var f=this._readLineString(d[a],b,c);e.push(f)}return e},_readBox:function(a,b,c){var d,e,f,g,k,l,s,n=this._readWkidFromNode(a);-1!=n&&(b=n);n=this._readSrsDimension(a);0!==n&&(c=n);n={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};e=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(d=0;d<e.length;d++)if(f=this._readCoordinates(e[d],b,c))return 1<=f.length&&(g=l=f[0][0],k=s=
f[0][1]),1<=f.length&&(l=f[1][0],s=f[1][1]),n.rings.push([[g,k],[g,s],[l,s],[l,k],[g,k]]),n;e=a.getElementsByTagNameNS(this._gmlNS,"coord");if(2<=e.length){if((a=this._readCoord(e[0],b,c))&&1<=a.length)g=l=a[0][0],k=s=a[0][1];if((b=this._readCoord(e[1],b,c))&&1<=b.length)l=b[0][0],s=b[0][1];n.rings.push([[g,k],[g,s],[l,s],[l,k],[g,k]]);return n}return null},_readEnvelope:function(a,b,c){var d,e,f,g;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);e=a.getElementsByTagNameNS(this._gmlNS,
"lowerCorner");for(d=0;d<e.length;d++){var k=this._readCoordinates(e[d],b,c);k&&(f=k[0])}e=a.getElementsByTagNameNS(this._gmlNS,"upperCorner");for(d=0;d<e.length;d++)(a=this._readCoordinates(e[d],b,c))&&(g=a[0]);return f&&g?{geometryType:"polygon",rings:[[[f[0],f[1]],[f[0],g[1]],[g[0],g[1]],[g[0],f[1]],[f[0],f[1]]]],spatialReference:{wkid:this._map.spatialReference.wkid}}:null},_readPolygon:function(a,b,c){var d,e,f;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);
var g={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};e=a.getElementsByTagNameNS(this._gmlNS,"outerBoundaryIs");for(d=0;d<e.length;d++)f=this._readOuterBoundaryIs(e[d],b,c),g.rings.push(f);e=a.getElementsByTagNameNS(this._gmlNS,"innerBoundaryIs");for(d=0;d<e.length;d++)f=this._readInnerBoundaryIs(e[d],b,c),g.rings.push(f);e=a.getElementsByTagNameNS(this._gmlNS,"exterior");for(d=0;d<e.length;d++)f=this._readExterior(e[d],b,c),g.rings.push(f);e=a.getElementsByTagNameNS(this._gmlNS,
"interior");for(d=0;d<e.length;d++)f=this._readInterior(e[d],b,c),g.rings.push(f);return g},_readPolygonMember:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"Polygon");0<a.length;)return this._readPolygon(a[0],b,c);return null},_readMultiPolygon:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference=
{wkid:this._map.spatialReference.wkid};d=a.getElementsByTagNameNS(this._gmlNS,"polygonMember");for(a=0;a<d.length;a++){var f=this._readPolygonMember(d[a],b,c);e.push(f)}return e},_readOuterBoundaryIs:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],b,c);return null},_readInnerBoundaryIs:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=
d);d=this._readSrsDimension(a);0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],b,c);return null},_readExterior:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],b,c);return null},_readInterior:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);
0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],b,c);return null},_readPatches:function(a,b,d){var c,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(d=e);e=[];e.spatialReference={wkid:this._map.spatialReference.wkid};c=a.getElementsByTagNameNS(this._gmlNS,"PolygonPatch");for(a=0;a<c.length;a++)e.push(this._readPolygon(c[a],b,d));return e},_readLineString:function(a,b,d){var c,e,f,g,k;c=this._readWkidFromNode(a);
-1!=c&&(b=c);c=this._readSrsDimension(a);0!==c&&(d=c);var l=[];l.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(c=0;c<f.length;c++)if(g=this._readCoordinates(f[c],b,d))for(e=0;e<g.length;e++)k=g[e],l.push(k);f=a.getElementsByTagNameNS(this._gmlNS,"coord");for(c=0;c<f.length;c++)if(g=this._readCoord(f[c],b,d))for(e=0;e<g.length;e++)k=g[e],l.push(k);f=a.getElementsByTagNameNS(this._gmlNS,"posList");for(c=0;c<f.length;c++)if(g=this._readPosList(f[c],
b,d))for(e=0;e<g.length;e++)k=g[e],l.push(k);return l},_readLineStringMember:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);for(a=a.getElementsByTagNameNS(this._gmlNS,"LineString");0<a.length;)return this._readLineString(a[0],b,c);return null},_readMultiLineString:function(a,b,c){var d,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(c=e);e={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};
d=a.getElementsByTagNameNS(this._gmlNS,"lineStringMember");for(a=0;a<d.length;a++){var f=this._readLineStringMember(d[a],b,c);f&&e.paths.push(f)}return 1<=e.paths.length?e:null},_readPoint:function(a,b,c){var d,e,f;d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);e=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(d=0;d<e.length;d++)if(f=this._readCoordinates(e[d],b,c))return{geometryType:"point",x:f[0][0],y:f[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};
e=a.getElementsByTagNameNS(this._gmlNS,"pos");for(d=0;d<e.length;d++)if((f=this._readPos(e[d],b,c))&&0<f.length)return{geometryType:"point",x:f[0][0],y:f[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};e=a.getElementsByTagNameNS(this._gmlNS,"coord");for(d=0;d<e.length;d++)if(a=this._readCoord(e[d],b,c))return{geometryType:"point",x:a[0][0],y:a[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};return null},_readPointMember:function(a,b,d){var c=this._readWkidFromNode(a);
-1!=c&&(b=c);c=this._readSrsDimension(a);0!==c&&(d=c);for(a=a.getElementsByTagNameNS(this._gmlNS,"Point");0<a.length;)return this._readPoint(a[0],b,d);return null},_readMultiPoint:function(a,b,d){var c,e=this._readWkidFromNode(a);-1!=e&&(b=e);e=this._readSrsDimension(a);0!==e&&(d=e);e={geometryType:"multipoint",points:[],spatialReference:{wkid:this._map.spatialReference.wkid}};c=a.getElementsByTagNameNS(this._gmlNS,"pointMember");for(a=0;a<c.length;a++){var f=this._readPointMember(c[a],b,d);f&&e.points.push([f.x,
f.y])}return 1<=e.points.length?e:null},_readLinearRing:function(a,b,d){var c,e;c=this._readWkidFromNode(a);-1!=c&&(b=c);c=this._readSrsDimension(a);0!==c&&(d=c);e=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(c=0;c<e.length;)return this._readCoordinates(e[c],b,d);e=a.getElementsByTagNameNS(this._gmlNS,"posList");for(c=0;c<e.length;)return this._readCoordinates(e[c],b,d);e=a.getElementsByTagNameNS(this._gmlNS,"pos");for(c=0;c<e.length;)return this._readPos(e[c],b,d)},_readCoordinatesBody:function(a,
b,c){var d,e=new C(a);b=b.trim();var f,g,k=[];k.spatialReference={wkid:this._map.spatialReference.wkid};a=this._isReverse(a,this.version);if(b)if(2===c){if((b=b.match(/[0123456789.\-\+eE]+/g))&&2<=b.length)for(c=0;c<b.length;c+=2)f=parseFloat(b[c]),g=parseFloat(b[c+1]),a&&(d=g,g=f,f=d),d={},this._projectFromSRToSR(e,this._map.spatialReference,f,g,d)&&(f=d.x,g=d.y),k.push([f,g])}else if(3===c&&(b=b.match(/[0123456789.\-\+eE]+/g))&&3<=b.length)for(c=0;c<b.length;c+=3)f=parseFloat(b[c]),g=parseFloat(b[c+
1]),a&&(d=g,g=f,f=d),d={},this._projectFromSRToSR(e,this._map.spatialReference,f,g,d)&&(f=d.x,g=d.y),k.push([f,g]);return k},_readCoord:function(a,b,c){var d,e,f,g,k=this._readWkidFromNode(a);-1!=k&&(b=k);k=new C(b);f=this._readSrsDimension(a);0!==f&&(c=f);var l=this._isReverse(b,this.version),s=[];s.spatialReference={wkid:this._map.spatialReference.wkid};f=0;e=a.getElementsByTagNameNS(this._gmlNS,"X");for(d=0;d<e.length;){f=this._readFloat(e[d],b,c);break}g=0;e=a.getElementsByTagNameNS(this._gmlNS,
"Y");for(d=0;d<e.length;){g=this._readFloat(e[d],b,c);break}l&&(a=g,g=f,f=a);a={};this._projectFromSRToSR(k,this._map.spatialReference,f,g,a)&&(f=a.x,g=a.y);s.push(l?[g,f]:[f,g]);return s},_readCoordinates:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);return this._readCoordinatesBody(b,a.textContent,c)},_readPos:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);return this._readCoordinatesBody(b,
a.textContent,c)},_readPosList:function(a,b,c){var d=this._readWkidFromNode(a);-1!=d&&(b=d);d=this._readSrsDimension(a);0!==d&&(c=d);return this._readCoordinatesBody(b,a.textContent,c)},_projectFromSRToSR:function(a,c,d,e,f){if(b.canProject(a,c))return a=new H(d,e,a),c=b.project(a,c),f.x=c.x,f.y=c.y,!0;f.x=d;f.y=e;return this._isProjectedOk=!1},_readFloat:function(a){return(a=a.textContent)?parseFloat(a):0},_readSrsDimension:function(a){return a.attributes&&(a=a.attributes.getNamedItem("srsDimension"))?
parseInt(a.value,10):0},_readWkidFromNode:function(a){if(a.attributes&&(a=a.attributes.getNamedItem("srsName")))if((a=a.value.match(/\d+/g))&&0<a.length)return a=parseInt(a[a.length-1],10),84===a&&(a=4326),parseInt(a,10);return-1},_isReverse:function(a,b){return this._inverseResponse}})})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x,A,E,F,B,y,C){return l([B],{declaredClass:"esri.layers.WMTSLayer",copyright:null,extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(b,c){this.version="1.0.0";this.tileUr=this._url=b;this.serviceMode="RESTful";this._parseCapabilities=n.hitch(this,this._parseCapabilities);this._getCapabilitiesError=n.hitch(this,this._getCapabilitiesError);c||(c={});if(c.serviceMode)if("KVP"===c.serviceMode||"RESTful"===c.serviceMode)this.serviceMode=c.serviceMode;
else{console.error("WMTS mode could only be 'KVP' or 'RESTful'");return}this.layerInfo=new C;c.layerInfo&&(this.layerInfo=c.layerInfo,this._identifier=c.layerInfo.identifier,this._tileMatrixSetId=c.layerInfo.tileMatrixSet,c.layerInfo.format&&(this.format="image/"+c.layerInfo.format),this._style=c.layerInfo.style,this.title=c.layerInfo.title,this._dimension=c.layerInfo.dimension);c.resourceInfo?(this.version=c.resourceInfo.version,c.resourceInfo.getTileUrl&&(this._url=this.tileUrl=c.resourceInfo.getTileUrl),
this.copyright=c.resourceInfo.copyright,this.layerInfos=c.resourceInfo.layerInfos,this._parseResourceInfo(),this.loaded=!0,this.onLoad(this)):this._getCapabilities();this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png","image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""}},setActiveLayer:function(b){this.setVisibleLayer(b)},setVisibleLayer:function(b){this._setActiveLayer(b);
this.refresh(!0)},getTileUrl:function(b,c,d){b=this._levelToLevelValue[b];b=this.resourceUrls&&0<this.resourceUrls.length?this.resourceUrls[c%this.resourceUrls.length].template.replace(/\{Style\}/gi,this._style).replace(/\{TileMatrixSet\}/gi,this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,b).replace(/\{TileRow\}/gi,c).replace(/\{TileCol\}/gi,d).replace(/\{dimensionValue\}/gi,this._dimension):this.UrlTemplate.replace(/\{level\}/gi,b).replace(/\{row\}/gi,c).replace(/\{col\}/gi,d);return b=this.addTimestampToURL(b)},
getTileUrlTemplate:function(b){var c=b.identifier,d=b.tileMatrixSet,g=b.format,f=b.style,k=b.dimension;c?b=e.filter(this.layers,function(b){return b.identifier===c})[0]:(b=this.layers[0],c=this.layers[0].identifier);if(b){if(g){if(-1===g.indexOf("image/")&&(g="image/"+g),-1===e.indexOf(b.formats,g)){console.error("The layer doesn't support the format of "+g);this.onError(Error("The layer doesn't support the format of "+g));return}}else g=b.formats[0],-1===g.indexOf("image/")&&(g="image/"+g);if(f){if(-1===
e.indexOf(b.styles,f)){console.error("The layer doesn't support the style of "+f);this.onError(Error("The layer doesn't support the style of "+f));return}}else f=b.styles[0];if(!k&&b.dimensions)k=b.dimensions[0];else if(-1===e.indexOf(b.dimensions,k)){console.error("The layer doesn't support the dimension of "+k);this.onError(Error("The layer doesn't support the dimension of "+k));return}var l;if(d){if(l=e.filter(b.tileMatrixSetInfos,function(b){return b.tileMatrixSet===d})[0],!l){console.error("The tileMatrixSetId "+
d+" is not supported by the layer of "+c);this.onError(Error("The tileMatrixSetId "+d+" is not supported by the layer of "+c));return}}else(l=e.filter(b.tileMatrixSetInfos,function(b){return"GoogleMapsCompatible"===b.tileMatrixSet})[0])||(l=b.tileMatrixSetInfos[0]),d=l.tileMatrixSet;return this._getTileUrlTemplate(c,d,g,f,k)}console.error("couldn't find the layer "+c);this.onError(Error("couldn't find the layer "+c))},_getTileUrlTemplate:function(b,c,d,e,f){var g;b||(b=this._identifier);c||(c=this._tileMatrixSetId);
d||(d=this.format);!e&&""!==e&&(e=this._style);if(this.resourceUrls&&0<this.resourceUrls.length)return g=this.resourceUrls[0].template,g.indexOf(".xxx")===g.length-4&&(g=g.slice(0,g.length-4)),g=g.replace(/\{Style\}/gi,e),g=g.replace(/\{TileMatrixSet\}/gi,c),g=g.replace(/\{TileMatrix\}/gi,"{level}"),g=g.replace(/\{TileRow\}/gi,"{row}"),g=g.replace(/\{TileCol\}/gi,"{col}"),g=g.replace(/\{dimensionValue\}/gi,f);"KVP"===this.serviceMode?g=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+
b+"\x26STYLE\x3d"+e+"\x26FORMAT\x3d"+d+"\x26TILEMATRIXSET\x3d"+c+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":"RESTful"===this.serviceMode&&(f="",this._formatDictionary[d.toLowerCase()]&&(f=this._formatDictionary[d.toLowerCase()]),g=this._url+b+"/"+e+"/"+c+"/{level}/{row}/{col}"+f);return g},_parseResourceInfo:function(){var b=this.layerInfos,c;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(c=0;c<b.length;c++)if((!this._identifier||b[c].identifier===
this._identifier)&&(!this.title||b[c].title===this.title)&&(!this._tileMatrixSetId||b[c].tileMatrixSet===this._tileMatrixSetId)&&(!this.format||"image/"+b[c].format===this.format)&&(!this._style||b[c].style===this._style)){n.mixin(this,{description:b[c].description,tileInfo:b[c].tileInfo,spatialReference:b[c].tileInfo.spatialReference,fullExtent:b[c].fullExtent,initialExtent:b[c].initialExtent,_identifier:b[c].identifier,_tileMatrixSetId:b[c].tileMatrixSet,format:"image/"+b[c].format,_style:b[c].style});
break}this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();this._levelToLevelValue=[];e.forEach(this.tileInfo.lods,function(b){this._levelToLevelValue[b.level]=b.levelValue?b.levelValue:b.level},this)},_getCapabilities:function(){var b;"KVP"===this.serviceMode?b=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:"RESTful"===this.serviceMode&&
(b=this._url+"/"+this.version+"/WMTSCapabilities.xml");c({url:b,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(b){b=b.replace(/ows:/gi,"");b=u.parse(b);var c=q.query("Contents",b)[0];if(c){var d=q.query("OperationsMetadata",b)[0],g=q.query("[name\x3d'GetTile']",d)[0],d=this._url,g=q.query("Get",g),f,k=!1,l,n;for(f=0;f<g.length;f++){var a=q.query("Constraint",g[f])[0];if(!a||this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,
a)){d=g[f].attributes[0].nodeValue;k=!0;break}else if(!a||this._getTagWithChildTagValue("AllowedValues","Value","RESTful",a))l=g[f].attributes[0].nodeValue;else if(!a||this._getTagWithChildTagValue("AllowedValues","Value","KVP",a))n=g[f].attributes[0].nodeValue}k||("KVP"===this.serviceMode&&l?(d=l,this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&n&&(d=n,this.serviceMode="KVP"));-1===d.indexOf("/1.0.0/")&&"RESTful"===this.serviceMode&&(d+="/");"KVP"===this.serviceMode&&(d+=-1<d.indexOf("?")?
"":"?");this._url=d;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",b)[0];l=q.query("Layer",c);var m,p=[];this.layers=[];e.forEach(l,function(a){m=this._getTagValues("Identifier",a)[0];p.push(m);this.layers.push(this._getWMTSLayerInfo(m,a,c))},this);this._setActiveLayer();this.loaded=!0;this.onLoad(this)}else console.error("The WMTS capabilities XML is not valid"),this.onError(Error("The WMTS capabilities XML is not valid"))},_setActiveLayer:function(b){b||
(b={});b.identifier&&(this._identifier=b.identifier);b.tileMatrixSet&&(this._tileMatrixSetId=b.tileMatrixSet);b.format&&(this.format=b.format);b.style&&(this._style=b.style);b.dimension&&(this._dimension=b.dimension);if(this.layers)if(this._identifier?b=e.filter(this.layers,function(b){return b.identifier===this._identifier},this)[0]:(b=this.layers[0],this._identifier=this.layers[0].identifier),b){if(this.format){if(-1===this.format.indexOf("image/")&&(this.format="image/"+this.format),-1===e.indexOf(b.formats,
this.format)){console.error("The layer doesn't support the format of "+this.format);this.onError(Error("The layer doesn't support the format of "+this.format));return}}else this.format=b.formats[0],-1===this.format.indexOf("image/")&&(this.format="image/"+this.format);if(this._style){if(-1===e.indexOf(b.styles,this._style)){console.error("The layer doesn't support the style of "+this._style);this.onError(Error("The layer doesn't support the style of "+this._style));return}}else this._style=b.styles[0];
if(!this._dimension&&b.dimensions)this._dimension=b.dimensions[0];else if(-1===e.indexOf(b.dimensions,this._dimension)){console.error("The layer doesn't support the dimension of "+this._dimension);this.onError(Error("The layer doesn't support the dimension of "+this._dimension));return}var c;if(this._tileMatrixSetId){if(c=e.filter(b.tileMatrixSetInfos,function(b){return b.tileMatrixSet===this._tileMatrixSetId},this)[0],!c){console.error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+
this._identifier);this.onError(Error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier));return}}else(c=e.filter(b.tileMatrixSetInfos,function(b){return"GoogleMapsCompatible"===b.tileMatrixSet})[0])||(c=b.tileMatrixSetInfos[0]),this._tileMatrixSetId=c.tileMatrixSet;this.description=b.description;this.title=b.title;this.spatialReference=c.tileInfo.spatialReference;this.tileInfo=c.tileInfo;this._levelToLevelValue=[];e.forEach(this.tileInfo.lods,function(b){this._levelToLevelValue[b.level]=
b.levelValue?b.levelValue:b.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=F.geographicToWebMercator(b.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=this.initialExtent=b.gcsExtent:(this.fullExtent=c.fullExtent,this.initialExtent=c.initialExtent);this.resourceUrls=b.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo={identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,
style:this._style,fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}else console.error("couldn't find the layer "+this._identifier),this.onError(Error("couldn't find the layer "+this._identifier))},_getWMTSLayerInfo:function(b,c,d){var g=this._getTagValues("Abstract",c)[0],f=this._getTagValues("Title",c)[0],k=q.query("WGS84BoundingBox",c)[0],l=k?this._getTagValues("LowerCorner",k)[0].split(" "):["-180","-90"],n=k?this._getTagValues("UpperCorner",
k)[0].split(" "):["180","90"],k=parseFloat(l[0]),l=parseFloat(l[1]),a=parseFloat(n[0]),n=parseFloat(n[1]),k=new E(k,l,a,n,new x({wkid:4326})),n=this._getTagValues("Identifier",q.query("Style",c)[0]),m=this._getTagValues("Identifier",q.query("Dimension",c)[0]),p=this._getTagValues("Value",q.query("Dimension",c)[0])||this._getTagValues("Default",q.query("Dimension",c)[0]),l=this._getTagValues("Format",c);d=this._getLayerMatrixInfos(c,d);b={identifier:b,tileMatrixSetInfos:d,formats:l,styles:n,title:f,
description:g,gcsExtent:k,dimensions:p};c=q.query("ResourceURL",c);var h=[],r;e.forEach(c,function(a){r=a.getAttribute("template");m&&p&&(r=r.replace("{"+m+"}","{dimensionValue}"));h.push({template:r,format:a.getAttribute("format"),resourceType:a.getAttribute("resourceType")})});h&&0<h.length&&(b.resourceUrls=h);return b},_getLayerMatrixInfos:function(b,c){var d,g=[];this._allMatrixInfos||(this._allMatrixInfos=[]);var f=this._getTagValues("TileMatrixSet",b);if(f&&0!==f.length)return e.forEach(f,function(e){var f;
if(0<this._allMatrixInfos.length)for(d=0;d<this._allMatrixInfos.length;d++)if(this._allMatrixInfos[d].tileMatrixSet==e){f=this._allMatrixInfos[d];break}f||(f=this._getLayerMatrixInfo(e,b,c),this._allMatrixInfos.push(f));g.push(f)},this),g},_getLayerMatrixInfo:function(b,c,d){var e,f,g,k,l=[];c=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",b,c);var a=this._getTagValues("TileMatrix",c),m=this._getTagWithChildTagValue("TileMatrixSet","Identifier",b,d),p=this._getTagValues("SupportedCRS",
m)[0];e=parseInt(p.split(":").pop(),10);if(900913==e||3857==e)e=102100;if(-1<p.toLowerCase().indexOf("crs84")||-1<p.toLowerCase().indexOf("crs:84"))e=4326,k=!0;else if(-1<p.toLowerCase().indexOf("crs83")||-1<p.toLowerCase().indexOf("crs:83"))e=4269,k=!0;else if(-1<p.toLowerCase().indexOf("crs27")||-1<p.toLowerCase().indexOf("crs:27"))e=4267,k=!0;var h=new x({wkid:e}),n=q.query("TileMatrix",m)[0];d=parseInt(this._getTagValues("TileWidth",n)[0],10);c=parseInt(this._getTagValues("TileHeight",n)[0],10);
f=this._getTagValues("TopLeftCorner",n)[0].split(" ");var t=f[0],u=f[1];1<t.split("E").length&&(f=t.split("E"),t=f[0]*Math.pow(10,f[1]));1<u.split("E").length&&(f=u.split("E"),u=f[0]*Math.pow(10,f[1]));var t=parseFloat(t),u=parseFloat(u),B=k&&4326===e&&90===t&&-180===u;for(f=0;f<this._flippingAxisForWkids.length;f++)if(p.split(":").pop()>=this._flippingAxisForWkids[f][0]&&p.split(":").pop()<=this._flippingAxisForWkids[f][1]||4326===e&&(!k||B)){4326===e&&90<t&&(t="90");g=new A(u,t,h);break}f===this._flippingAxisForWkids.length&&
(g=new A(t,u,h));if(0===a.length){a=q.query("TileMatrix",m);for(f=0;f<a.length;f++)k=this._getLodFromTileMatrix(a[f],e,f,b),l.push(k)}else for(f=0;f<a.length;f++)k=this._getTagWithChildTagValue("TileMatrix","Identifier",a[f],m),k=this._getLodFromTileMatrix(k,e,f,b),l.push(k);e=q.query("BoundingBox",m)[0];var F,C;e&&(F=this._getTagValues("LowerCorner",e)[0].split(" "),C=this._getTagValues("UpperCorner",e)[0].split(" "));F&&1<F.length&&C&&1<C.length?(n=parseFloat(F[0]),e=parseFloat(F[1]),F=parseFloat(C[0]),
C=parseFloat(C[1])):(F=this._getTagValues("MatrixWidth",n)[0],e=this._getTagValues("MatrixHeight",n)[0],n=g.x,C=g.y,F=n+F*c*l[0].resolution,e=C-e*d*l[0].resolution);C=F=new E(n,e,F,C,h);g=new y({dpi:96,spatialReference:h,format:this.format,rows:d,cols:c,origin:g,lods:l});return{tileMatrixSet:b,fullExtent:C,initialExtent:F,tileInfo:g}},_getCapabilitiesError:function(b){console.error("Failed to get capabilities xml");this.onError(b)},_getLodFromTileMatrix:function(b,c,d,e){var f=this._getTagValues("Identifier",
b)[0];b=this._getTagValues("ScaleDenominator",b)[0];1<b.split("E").length?(b=b.split("E"),b=b[0]*Math.pow(10,b[1])):b=parseFloat(b);c=t.isDefined(g[c])?g.values[g[c]]:"default028mm"===e?6370997*Math.PI/180:6378137*Math.PI/180;c=7*b/25E3/c;return{level:d,levelValue:f,scale:1.058267716535433*b,resolution:c}},_getTag:function(b,c){var d=q.query(b,c);return d&&0<d.length?d[0]:null},_getTagValues:function(b,c){var d=[],g=b.split("\x3e"),f,l;f=q.query(g[0],c)[0];if(1<g.length){for(l=1;l<g.length-1;l++)f=
q.query(g[l],f)[0];g=q.query(g[g.length-1],f)}else g=q.query(g[0],c);g&&0<g.length&&e.forEach(g,function(b){9>k("ie")?d.push(b.childNodes.length?b.childNodes[0].nodeValue:""):d.push(b.textContent)});return d},_getAttributeValues:function(b,c,d){b=q.query(b,d);var g=[];b&&0<b.length&&e.forEach(b,function(b){g.push(b.getAttribute(c))});return g},_getTagWithChildTagValue:function(b,c,d,e){e=e.childNodes;var f,g;for(g=0;g<e.length;g++)if(-1<e[g].nodeName.indexOf(b)&&(9>k("ie")?t.isDefined(q.query(c,e[g])[0])&&
(f=q.query(c,e[g])[0].childNodes[0].nodeValue):t.isDefined(q.query(c,e[g])[0])&&(f=q.query(c,e[g])[0].textContent),f===d||d.split(":")&&f===d.split(":")[1]))return e[g]},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],
[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],
[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],
[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]})})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(q){q.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(l,n){var e=q.doc,k;n=n||"text/xml";if(l&&q.trim(l)&&"DOMParser"in q.global){k=(new DOMParser).parseFromString(l,
n);e=k.documentElement;if("parsererror"==e.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==e.namespaceURI){var u=e.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0];u&&(u=u.firstChild.data);throw Error("Error parsing text "+e.firstChild.data+" \n"+u);}return k}if("ActiveXObject"in q.global){e=function(d){return"MSXML"+d+".DOMDocument"};e=["Microsoft.XMLDOM",e(6),e(4),e(3),e(2)];q.some(e,function(d){try{k=new ActiveXObject(d)}catch(c){return!1}return!0});
if(l&&k&&(k.async=!1,k.loadXML(l),e=k.parseError,0!==e.errorCode))throw Error("Line: "+e.line+"\nCol: "+e.linepos+"\nReason: "+e.reason+"\nError Code: "+e.errorCode+"\nSource: "+e.srcText);if(k)return k}else if(e.implementation&&e.implementation.createDocument){if(l&&q.trim(l)&&e.createElement){u=e.createElement("xml");u.innerHTML=l;var d=e.implementation.createDocument("foo","",null);q.forEach(u.childNodes,function(e){d.importNode(e,!0)});return d}return e.implementation.createDocument("","",null)}return null};
dojox.xml.parser.textContent=function(l,n){if(1<arguments.length)return dojox.xml.parser.replaceChildren(l,(l.ownerDocument||q.doc).createTextNode(n)),n;if(void 0!==l.textContent)return l.textContent;var e="";l&&q.forEach(l.childNodes,function(k){switch(k.nodeType){case 1:case 5:e+=dojox.xml.parser.textContent(k);break;case 3:case 2:case 4:e+=k.nodeValue}});return e};dojox.xml.parser.replaceChildren=function(l,n){var e=[];q.isIE&&q.forEach(l.childNodes,function(k){e.push(k)});dojox.xml.parser.removeChildren(l);
q.forEach(e,q.destroy);q.isArray(n)?q.forEach(n,function(e){l.appendChild(e)}):l.appendChild(n)};dojox.xml.parser.removeChildren=function(l){for(var n=l.childNodes.length;l.hasChildNodes();)l.removeChild(l.firstChild);return n};dojox.xml.parser.innerXML=function(l){return l.innerXML?l.innerXML:l.xml?l.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(l):null};return dojox.xml.parser})},"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel"],function(q,l,n,e){return q(null,{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,dimension:null,constructor:function(e){e&&(this.title=e.title,this.tileMatrixSet=e.tileMatrixSet,this.format=e.format,this.style=e.style,this.tileInfo=e.tileInfo,this.fullExtent=e.fullExtent,this.initialExtent=e.initialExtent,this.identifier=e.identifier,this.description=
e.description,this.dimension=e.dimension)}})})},"widgets/AddData/search/SearchBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom-class dojo/keys ./SearchComponent dojo/text!./templates/SearchBox.html dojo/i18n!../nls/strings".split(" "),function(q,l,n,e,k,u,d,t){return q([u],{i18n:t,templateString:d,postCreate:function(){this.inherited(arguments);this._checkClearButton();this.own(n(this.searchTextBox,"keyup",l.hitch(this,function(c){this._checkClearButton();c.keyCode===k.ENTER&&
this.search()})))},_checkClearButton:function(){e.add(this.clearButton,"hidden")},clearButtonClicked:function(){this.searchTextBox.value="";this._checkClearButton();this.search()},searchButtonClicked:function(){this.search()},appendQueryParams:function(c){var d=this.searchTextBox.value;null!==d&&(d=l.trim(d));null!==d&&0<d.length&&(c.canSortByRelevance=!0,d="("+d+")",c.q=null!==c.q&&0<c.q.length?c.q+(" AND "+d):d)}})})},"widgets/AddData/search/SearchComponent":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin"],function(q,l,n,e){return q([l,n,e],{isSearchComponent:!0,searchPane:null,template:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments)},appendQueryParams:function(e,l){},processResults:function(e){},getConfig:function(){return this.searchPane&&this.searchPane.wabWidget&&this.searchPane.wabWidget.config?this.searchPane.wabWidget.config:{}},getMap:function(){return this.searchPane&&this.searchPane.wabWidget?
this.searchPane.wabWidget.map:null},search:function(){this.searchPane&&this.searchPane.search()}})})},"widgets/AddData/search/BBoxOption":function(){define(["dojo/_base/declare","./SearchComponent","dojo/text!./templates/BBoxOption.html","dojo/i18n!../nls/strings","dijit/form/CheckBox"],function(q,l,n,e){return q([l],{i18n:e,templateString:n,postCreate:function(){this.inherited(arguments);this.bboxToggle.set("checked",!0)},bboxClicked:function(){this.search()},_getBBox:function(){var e;if(e=this.getMap())if(e=
e.geographicExtent)return e.xmin+","+e.ymin+","+e.xmax+","+e.ymax;return null},appendQueryParams:function(e){if(this.bboxToggle.get("checked")){var l=this._getBBox();null!==l&&(e.canSortByRelevance=!0,e.bbox=l)}}})})},"widgets/AddData/search/ScopeOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-class ./SearchComponent dojo/text!./templates/ScopeOptions.html dojo/i18n!../nls/strings ./util".split(" "),function(q,l,n,e,k,u,d,t){return q([k],{i18n:d,templateString:u,
postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.initOptions())},hideDropdown:function(){e.remove(this.scopePlaceholder,"opened");e.remove(this.btnGroup,"show")},initOptions:function(){var c=this.searchPane.searchContext,d=c.portal.isPortal,k="string"===typeof c.username&&0<c.username.length,n=k,q=!0,u=c.allowArcGISOnline,B=this.getConfig().scopeOptions,c=function(c,d){var b=B[c];b&&("boolean"===typeof b.allow&&!b.allow&&(d.style.display=
"none","MyContent"===c?n=!1:"MyOrganization"===c?q=!1:"ArcGISOnline"===c&&(u=!1)),"string"===typeof b.label&&(b=l.trim(b.label),0<b.length&&t.setNodeText(d,b)))};c("MyContent",this.MyContentToggle);c("MyOrganization",this.MyOrganizationToggle);c("ArcGISOnline",this.ArcGISOnlineToggle);!k&&!d&&u&&(q=!1);n||(this.MyContentToggle.style.display="none");q||(this.MyOrganizationToggle.style.display="none");u||(this.ArcGISOnlineToggle.style.display="none");d=null;q?d=this.MyOrganizationToggle:u?d=this.ArcGISOnlineToggle:
n&&(d=this.MyContentToggle);d&&(e.add(d,"active"),this.scopePlaceholderText.innerHTML=d.innerHTML)},optionClicked:function(c){this.toggleClassName(c);this.hideDropdown();this.search()},scopePlaceholderClicked:function(c){c.preventDefault();e.contains(this.scopePlaceholder,"opened")?this.hideDropdown():this.showDropdown()},showDropdown:function(){e.add(this.scopePlaceholder,"opened");e.add(this.btnGroup,"show")},toggleClassName:function(c){n.forEach(this.btnGroup.children,function(c){e.remove(c,"active")});
e.add(c.target,"active");this.scopePlaceholderText.innerHTML=c.target.innerHTML},appendQueryParams:function(c,d){var k=null;n.some(this.btnGroup.children,function(c){if(e.contains(c,"active"))return k=c.getAttribute("data-option-name"),!0});"undefined"===typeof k&&(k=null);var l=this.searchPane.searchContext,q=null,u=l.username,B=l.orgId,y=!0;l.portal&&l.portal.isPortal&&(y=!1);"MyContent"===k?"string"===typeof u&&0<u.length&&(q="(owner:"+t.escapeForLucene(u)+")"):"MyOrganization"===k?y&&("string"===
typeof B&&0<B.length)&&(q="(orgid:"+t.escapeForLucene(B)+")"):"ArcGISOnline"===k&&l.allowArcGISOnline&&(d.scopeIsArcGISOnline=!0);null!==q&&0<q.length&&(q="("+q+")",c.q=null!==c.q&&0<c.q.length?c.q+(" AND "+q):q)}})})},"widgets/AddData/search/TypeOptions":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on ./SearchComponent dojo/text!./templates/TypeOptions.html dojo/i18n!../nls/strings dojo/Deferred dijit/TooltipDialog dijit/form/DropDownButton dijit/form/CheckBox".split(" "),
function(q,l,n,e,k,u,d,t){return q([k],{i18n:d,templateString:u,supportsVectorTile:!1,postCreate:function(){this.inherited(arguments);this.own(e(this.tooltipDialog,"open",n.hitch(this,function(){this.tooltipDialog.domNode.className+=" "+this.searchPane.wabWidget.appConfig.theme.name})));this._checkVTSupport().then(n.hitch(this,function(c){this.supportsVectorTile=c;this.supportsVectorTile||(console.warn("AddData: Vector Tile is not supported."),this.vectorTileNode.style.display="none")}))},_checkVTSupport:function(){var c=
new t;require(["esri/layers/vector-tile"],function(d){d=d.supported();c.resolve(d)});return c},getOptionWidgets:function(){return[this.mapServiceToggle,this.featureServiceToggle,this.imageServiceToggle,this.vectorTileServiceToggle,this.kmlToggle,this.wmsToggle]},optionClicked:function(){this.search()},appendQueryParams:function(c){var d=function(c,d){0<c.length&&(c+=" OR ");return c+d},e="",k="",n=!1;l.forEach(this.getOptionWidgets(),function(c){var l=c.focusNode.getAttribute("data-option-q");k=d(k,
l);c.get("checked")&&(e=d(e,l),n=!0)});n||(e=k);null!==e&&0<e.length&&(e="("+e+")",c.q=null!==c.q&&0<c.q.length?c.q+(" AND "+e):e)}})})},"widgets/AddData/search/SortOptions":function(){define("dojo/_base/declare dojo/on dojo/dom-class ./SearchComponent dojo/text!./templates/SortOptions.html dojo/i18n!../nls/strings dijit/form/Select".split(" "),function(q,l,n,e,k,u){return q([e],{i18n:u,templateString:k,sortField:null,sortOrder:null,postCreate:function(){this.inherited(arguments);this.updateSortOrderButton();
var d=this;this.own(this.sortSelect.on("change",function(){var e=d.sortField=d.sortSelect.get("value");if(""===e)d.sortOrder=null;else if("title"===e||"owner"===e)d.sortOrder="asc";else if("avgrating"===e||"numviews"===e||"modified"===e)d.sortOrder="desc";d.updateSortOrderButton();d.search()}));this.own(l(this.sortSelect.dropDown,"open",function(){var d=this.domNode.parentElement;d&&n.add(d,"add-data-widget-popup")}))},sortOrderClicked:function(){"asc"===this.sortOrder?(this.sortOrder="desc",this.updateSortOrderButton(),
this.search()):"desc"===this.sortOrder&&(this.sortOrder="asc",this.updateSortOrderButton(),this.search())},updateSortOrderButton:function(){var d=this.sortOrderBtn;d.style.visibility=null!==this.sortField&&0<this.sortField.length?"visible":"hidden";"desc"===this.sortOrder?n.add(d,"descending"):n.remove(d,"descending")},appendQueryParams:function(d){d.sortField=null;d.sortOrder=null;var e=this.sortField,c=this.sortOrder;null!==e&&0<e.length?(d.sortField=e,null!==c&&0<c.length&&(d.sortOrder=c)):d.canSortByRelevance||
(d.sortField="numviews",d.sortOrder="desc")}})})},"widgets/AddData/search/ResultsPane":function(){define("dojo/_base/declare dojo/_base/array ./SearchComponent dojo/text!./templates/ResultsPane.html dojo/i18n!../nls/strings ./ItemCard ./util".split(" "),function(q,l,n,e,k,u,d){return q([n],{i18n:k,templateString:e,postCreate:function(){this.inherited(arguments)},addItem:function(d){d.placeAt(this.itemsNode)},destroyItems:function(){this.noMatchNode.style.display="none";this.noMatchNode.innerHTML=
"";this.destroyDescendants(!1)},showNoMatch:function(){d.setNodeText(this.noMatchNode,k.search.resultsPane.noMatch);this.noMatchNode.style.display="block"},processResults:function(e){this.destroyItems();var c=e.results;if(c&&0<c.length){var g=d.findLayersAdded(this.getMap(),null).itemIds;l.forEach(e.results,function(c){this.addItem(new u({item:c,canRemove:-1!==g.indexOf(c.id),resultsPane:this}))},this)}else this.showNoMatch()}})})},"widgets/AddData/search/ItemCard":function(){define("dojo/_base/declare dojo/_base/array dojo/date/locale dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemCard.html dojo/i18n!../nls/strings ./util ./LayerLoader".split(" "),
function(q,l,n,e,k,u,d,t,c,g,x){return q([k,u,d],{i18n:c,templateString:t,canRemove:!1,item:null,resultsPane:null,_dfd:null,postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.render())},addClicked:function(){var d=this,k=this.addButton;if(!e.contains(k,"disabled"))if(e.add(k,"disabled"),this.canRemove){var n=this.resultsPane.getMap();g.setNodeText(d.messageNode,c.search.item.messages.removing);var q=g.findLayersAdded(n,this.item.id).layers;
l.forEach(q,function(c){n.removeLayer(c)});this.canRemove=!1;g.setNodeText(d.messageNode,"");g.setNodeText(this.addButton,c.search.item.actions.add);e.remove(k,"disabled")}else g.setNodeText(d.messageNode,c.search.item.messages.adding),(new x).addItem(this.item,this.resultsPane.getMap()).then(function(l){l?(d.canRemove=!0,g.setNodeText(d.messageNode,""),g.setNodeText(d.addButton,c.search.item.actions.remove)):g.setNodeText(d.messageNode,c.search.item.messages.addFailed);e.remove(k,"disabled")}).otherwise(function(l){console.warn("Add layer failed.");
console.warn(l);g.setNodeText(d.messageNode,c.search.item.messages.addFailed);e.remove(k,"disabled");l&&("string"===typeof l.message&&0<l.message.length)&&console.log("")})},detailsClicked:function(){var c=this.item,c=g.checkMixedContent(c.portalUrl)+"/home/item.html?id\x3d"+encodeURIComponent(c.id);window.open(c)},formatDate:function(d){"number"===typeof d&&(d=new Date(d));return n.format(d,{selector:"date",datePattern:c.search.item.dateFormat})},render:function(){g.setNodeText(this.titleNode,this.item.title);
this._renderThumbnail();this._renderTypeOwnerDate();this.canRemove&&g.setNodeText(this.addButton,c.search.item.actions.remove)},_renderThumbnail:function(){var c=this.thumbnailNode,d=this.item.thumbnailUrl;c.innerHTML="";var d=g.checkMixedContent(d),e=document.createElement("IMG");e.src=d||"widgets/AddData/images/placeholder_120x80.png";c.appendChild(e)},_renderTypeOwnerDate:function(){var d,e=this.item;d=c.search.item.types[e.type];if("undefined"===typeof d||null===d)d=e.type;d=c.search.item.typeByOwnerPattern.replace("{type}",
d);d=d.replace("{owner}",e.owner);g.setNodeText(this.typeByOwnerNode,d)}})})},"widgets/AddData/search/Paging":function(){define("dojo/_base/declare dojo/dom-class ./SearchComponent dojo/text!./templates/Paging.html dojo/i18n!../nls/strings ./util".split(" "),function(q,l,n,e,k,u){return q([n],{i18n:k,templateString:e,hasLess:!1,hasMore:!1,nextStart:-1,numPerPage:null,previousStart:-1,start:1,postCreate:function(){this.inherited(arguments);null===this.numPerPage&&(this.numPerPage=30);this.enableOrDisable()},
startup:function(){if(!this._started){this.inherited(arguments);try{var d=this.getConfig().numPerPage,e=Number(d);"number"===typeof e&&!isNaN(e)&&(e=Math.floor(e),1<=e&&100>=e&&(this.numPerPage=e))}catch(c){console.warn("Error setting numPerPage:"),console.warn(c)}null===this.numPerPage&&(this.numPerPage=30)}},enableOrDisable:function(){this.hasLess?(l.remove(this.firstButton.parentNode,"disabled"),l.remove(this.previousButton.parentNode,"disabled")):(l.add(this.firstButton.parentNode,"disabled"),
l.add(this.previousButton.parentNode,"disabled"));this.hasMore?l.remove(this.nextButton.parentNode,"disabled"):l.add(this.nextButton.parentNode,"disabled")},firstButtonClicked:function(){this.hasLess&&(this.start=1,this.search())},previousButtonClicked:function(){this.hasLess&&(this.start=this.previousStart,this.search())},nextButtonClicked:function(){this.hasMore&&(this.start=this.nextStart,this.search())},appendQueryParams:function(d){d.start=this.start;d.num=this.numPerPage},processResults:function(d){this.start=
1;var e=this.numPerPage,c=d.total,g=d.queryParams.start;1>g&&(g=1);this.hasLess=!1;this.previousStart=-1;1<g&&(this.hasLess=!0,this.previousStart=g-d.queryParams.num,1>this.previousStart&&(this.previousStart=1));this.hasMore=!1;this.nextStart=-1;d.nextQueryParams&&1<d.nextQueryParams.start&&(this.hasMore=!0,this.nextStart=d.nextQueryParams.start);d="";c>e?(c=1,1<g&&(c=Math.floor(g/e)+1),d=this.i18n.search.paging.pagePattern,d=d.replace("{page}",""+c)):(d=this.i18n.search.paging.pagePattern,d=d.replace("{page}",
"1"));u.setNodeText(this.pageNode,d);this.enableOrDisable()}})})},"widgets/AddData/search/ResultCount":function(){define("dojo/_base/declare dojo/number ./SearchComponent dojo/text!./templates/ResultCount.html dojo/i18n!../nls/strings ./util".split(" "),function(q,l,n,e,k,u){return q([n],{i18n:k,templateString:e,typePlural:k.search.resultCount.itemPlural,typeSingular:k.search.resultCount.itemSingular,postCreate:function(){this.inherited(arguments)},processResults:function(d){d=d.total;var e=this.typePlural;
1===d&&(e=this.typeSingular);var c=this.i18n.search.resultCount.countPattern,c=c.replace("{count}",l.format(d)),c=c.replace("{type}",e);u.setNodeText(this.messageNode,c)}})})},"widgets/AddData/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/AddData/search/templates/SearchPane.html":'\x3cdiv class\x3d"search-pane-wrapper"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane" data-dojo-attach-point\x3d"onlinePane"\x3e\r\n    \x3cdiv class\x3d"search-pane-header" data-dojo-attach-point\x3d"headerNode"\x3e\r\n      \x3cdiv class\x3d"search-bar main-search-bar"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ScopeOptions"\r\n          data-dojo-attach-point\x3d"scopeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cspan class\x3d"search-box-placeholder" data-dojo-attach-point\x3d"searchBoxPlaceholder"\x3e\x3c/span\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SearchBox"\r\n          data-dojo-attach-point\x3d"searchBox"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"search-bar-separator"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"search-bar search-bar-secondary" data-dojo-attach-point\x3d"optionsNode"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/BBoxOption"\r\n          data-dojo-attach-point\x3d"bboxOption"\x3e\r\n        \x3c/div\x3e\r\n        \x3cspan class\x3d"filter-placeholder" data-dojo-attach-point\x3d"filterPlaceholder"\x3e\x3c/span\x3e\r\n        \x3cdiv class\x3d"filter-wrapper" data-dojo-attach-point\x3d"filterWrapper"\x3e\r\n          \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n            data-dojo-attach-point\x3d"typeOptions"\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n            data-dojo-attach-point\x3d"sortOptions"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"search-pane-content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultsPane"\r\n        data-dojo-attach-point\x3d"resultsPane"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar search-pane-footer" data-dojo-attach-point\x3d"footerNode"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/Paging"\r\n        data-dojo-attach-point\x3d"paging"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultCount"\r\n        data-dojo-attach-point\x3d"resultCount"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!-- \x3cdiv class\x3d"footerOptions"\x3e\r\n        \x3ca href\x3d"#"\r\n          data-dojo-attach-point\x3d"FromUrlNode"\r\n          data-dojo-attach-event\x3d"onClick: addFromUrlClicked"\x3e${i18n.addFromUrl.buttonLabel}\x3c/a\x3e\r\n      \x3c/div\x3e --\x3e\r\n      \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane" data-dojo-attach-point\x3d"urlPane"\x3e\r\n    \x3c!-- \x3cdiv data-dojo-type\x3d"widgets/AddData/search/AddFromUrlPane" data-dojo-attach-point\x3d"addFromUrlPane"\x3e\x3c/div\x3e --\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/AddFromUrlPane.html":'\x3cdiv class\x3d"add-url-pane"\x3e\r\n  \x3cdiv\x3e\r\n    \x3clabel for\x3d"${id}_select"\x3e${i18n.addFromUrl.type}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"small-gap"\x3e\r\n    \x3cselect id\x3d"${id}_select"\r\n      data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"typeSelect"\x3e\r\n      \x3coption value\x3d"ArcGIS" selected\x3d"selected"\x3e${i18n.addFromUrl.types.ArcGIS}\x3c/option\x3e\r\n      \x3coption value\x3d"WMS"\x3e${i18n.addFromUrl.types.WMS}\x3c/option\x3e\r\n      \x3c!--not yet supported \x3coption value\x3d"WMTS"\x3e${i18n.addFromUrl.types.WMTS}\x3c/option\x3e --\x3e\r\n      \x3c!--not yet supported \x3coption value\x3d"WFS"\x3e${i18n.addFromUrl.types.WFS}\x3c/option\x3e --\x3e\r\n      \x3coption value\x3d"KML"\x3e${i18n.addFromUrl.types.KML}\x3c/option\x3e\r\n      \x3coption value\x3d"GeoRSS"\x3e${i18n.addFromUrl.types.GeoRSS}\x3c/option\x3e\r\n      \x3coption value\x3d"CSV"\x3e${i18n.addFromUrl.types.CSV}\x3c/option\x3e\r\n    \x3c/select\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"gap"\x3e\r\n    \x3clabel for\x3d"${id}_url"\x3e${i18n.addFromUrl.url}\x3c/label\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"small-gap"\x3e\r\n    \x3cinput id\x3d"${id}_url" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n      data-dojo-attach-point\x3d"urlTextBox"\x3e\r\n  \x3c/div\x3e\r\n  \x3ca href\x3d"javascript:void(0);\r\n     data-dojo-attach-point\x3d"examplesExpander"\r\n     data-dojo-attach-event\x3d"onClick: examplesExpanderClicked"\r\n  " \x3e${i18n.addFromUrl.samplesHint}\x3c/a\x3e\r\n  \x3cdiv class\x3d"examples" data-dojo-attach-point\x3d"examplesNode"\x3e\r\n    \x3cdiv data-examples-type\x3d"ArcGIS"\x3e\r\n      \x3cdiv\x3ehttp://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Cities/FeatureServer/0\x3c/div\x3e\r\n      \x3cdiv\x3ehttp://services.arcgisonline.com/ArcGIS/rest/services/Demographics/USA_Tapestry/MapServer\x3c/div\x3e\r\n      \x3cdiv\x3ehttp://imagery.arcgisonline.com/ArcGIS/rest/services/LandsatGLS/VegetationAnalysis/ImageServer\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-examples-type\x3d"WMS"\x3e\r\n      \x3cdiv\x3ehttp://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service\x3dWMS\x26amp;request\x3dGetCapabilities\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-examples-type\x3d"KML"\x3e\r\n      \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month_age_animated.kml\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-examples-type\x3d"GeoRSS"\x3e\r\n      \x3cdiv\x3ehttp://www.gdacs.org/xml/rss.xml\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-examples-type\x3d"CSV"\x3e\r\n      \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.csv\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"action-bar"\x3e\r\n    \x3cspan class\x3d"message" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n    \x3ca class\x3d"jimu-btn"\r\n      href\x3d"javascript:void(0)"\r\n      data-dojo-attach-point\x3d"addButton"\r\n      data-dojo-attach-event\x3d"onClick: addClicked"\r\n      \x3e${i18n.search.item.actions.add}\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SearchBox.html":'\x3cdiv class\x3d"search-box"\x3e\r\n\t\x3cdiv class\x3d"input-group"\x3e\r\n\t\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\t\tdata-dojo-attach-point\x3d"searchTextBox"\x3e\r\n    \x3cspan class\x3d"search-btn"\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-clear hidden" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"clearButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: clearButtonClicked"\x3e\r\n\t\t\t\t\x3cspan class\x3d"esri-icon-close"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/BBoxOption.html":'\x3cdiv class\x3d"search-bbox-option"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"bboxSection" class\x3d"switch-toggle-group"\x3e\r\n    \x3clabel class\x3d"checkbox-inline"\x3e\r\n      \x3cinput id\x3d"${id}_bboxId" \r\n\t      data-dojo-type\x3d"dijit/form/CheckBox"\r\n\t      data-dojo-attach-point\x3d"bboxToggle"\r\n\t      data-dojo-attach-event\x3d"onClick: bboxClicked"\r\n\t      data-dojo-props\x3d"class: \'switch-toggle\'"/\x3e\r\n      ${i18n.search.bboxOption.bbox}\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ScopeOptions.html":'\x3cdiv class\x3d"search-scope-options"\x3e\r\n  \x3ca href\x3d"#" class\x3d"scope-placeholder"\r\n    data-dojo-attach-point\x3d"scopePlaceholder"\r\n    data-dojo-attach-event\x3d"onClick: scopePlaceholderClicked"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"scopePlaceholderText"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"dropdown-arrow"\x3e\x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"btn-group" data-dojo-attach-point\x3d"btnGroup"\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyContentToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyContent"\x3e\r\n      ${i18n.search.scopeOptions.myContent}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyOrganizationToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyOrganization"\x3e\r\n      ${i18n.search.scopeOptions.myOrganization}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"ArcGISOnlineToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"ArcGISOnline"\x3e\r\n      ${i18n.search.scopeOptions.ArcGISOnline}\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/TypeOptions.html":'\x3cdiv class\x3d"search-data-type-options"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n    \x3cspan\x3e${i18n.search.typeOptions.prompt}\x3c/span\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\r\n         data-dojo-attach-point\x3d"tooltipDialog"\r\n         data-dojo-props\x3d"class:\'add-data-widget-popup\'"\x3e\r\n      \x3clabel for\x3d"${id}_mapServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_mapServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"mapServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Map Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.mapService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_featureServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_featureServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"featureServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Feature Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.featureService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_imageServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_imageServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"imageServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Image Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.imageService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_vectorTileServiceId" class\x3d"search-type-option"\r\n        data-dojo-attach-point\x3d"vectorTileNode"\x3e\r\n        \x3cinput id\x3d"${id}_vectorTileServiceId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"vectorTileServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Vector Tile Service\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.vectorTileService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_kmlId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_kmlId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"kmlToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;KML\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.kml}\r\n      \x3c/label\x3e\r\n       \x3clabel for\x3d"${id}_wmsId" class\x3d"search-type-option"\x3e\r\n        \x3cinput id\x3d"${id}_wmsId"\r\n          data-dojo-type\x3d"dijit/form/CheckBox"\r\n          data-dojo-attach-point\x3d"wmsToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;WMS\x26quot;\'/\x3e\r\n        ${i18n.search.typeOptions.wms}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SortOptions.html":'\x3cdiv class\x3d"search-sort-options"\x3e\r\n  \x3clabel for\x3d"${id}_select" \x3e${i18n.search.sortOptions.prompt}\x3c/label\x3e \r\n  \x3cselect id\x3d"${id}_select" \r\n    data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"sortSelect"\x3e\r\n    \x3coption value\x3d"" selected\x3d"selected"\x3e${i18n.search.sortOptions.relevance}\x3c/option\x3e\r\n    \x3coption value\x3d"title"\x3e${i18n.search.sortOptions.title}\x3c/option\x3e\r\n    \x3coption value\x3d"owner"\x3e${i18n.search.sortOptions.owner}\x3c/option\x3e\r\n    \x3coption value\x3d"avgrating"\x3e${i18n.search.sortOptions.rating}\x3c/option\x3e\r\n    \x3coption value\x3d"numviews"\x3e${i18n.search.sortOptions.views}\x3c/option\x3e\r\n    \x3coption value\x3d"modified"\x3e${i18n.search.sortOptions.date}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3ca href\x3d"#" class\x3d"sort-order-icon"\r\n    title\x3d"${i18n.search.sortOptions.switchOrder}"\r\n    data-dojo-attach-point\x3d"sortOrderBtn"\r\n    data-dojo-attach-event\x3d"onclick: sortOrderClicked"\x3e\r\n  \x3c/a\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ResultsPane.html":'\x3cdiv class\x3d"search-results-pane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"search-results-pane-no-match empty-data-label" data-dojo-attach-point\x3d"noMatchNode" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"itemsNode" class\x3d"search-results"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/ItemCard.html":'\x3cdiv class\x3d"item-card"\x3e\r\n  \x3cdiv class\x3d"item-card-inner"\x3e\r\n    \x3cdiv class\x3d"thumbnail" data-dojo-attach-point\x3d"thumbnailNode"\x3e\x3c/div\x3e\r\n    \x3ch3 class\x3d"title" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/h3\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"typeByOwnerNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"dateNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-bar"\x3e\r\n      \x3cspan class\x3d"message" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"addButton"\r\n        data-dojo-attach-event\x3d"onClick: addClicked"\r\n        \x3e${i18n.search.item.actions.add}\r\n      \x3c/a\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"detailsButton"\r\n        data-dojo-attach-event\x3d"onClick: detailsClicked"\r\n        \x3e${i18n.search.item.actions.details}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/Paging.html":'\x3cdiv class\x3d"search-paging"\x3e\r\n\t\x3cul class\x3d"pagination pagination-sm"\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"First"\r\n\t\t\t\tdata-dojo-attach-point\x3d"firstButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: firstButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.firstTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-expand"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Previous"\r\n\t\t\t\tdata-dojo-attach-point\x3d"previousButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: previousButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.previousTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-left"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli class\x3d"current-page"\x3e\r\n\t\t  \x3cspan data-dojo-attach-point\x3d"pageNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Next"\r\n\t\t\t\tdata-dojo-attach-point\x3d"nextButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: nextButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.nextTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-right"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\x3c/ul\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ResultCount.html":'\x3cdiv class\x3d"search-result-count"\x3e\r\n  \x3cspan class\x3d"search-count" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-type\x3d"widgets/AddData/search/SearchPane" data-dojo-attach-point\x3d"searchPane" data-dojo-props\x3d"nls:this.nls"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/css/style.css":'.jimu-widget-add-data .search-pane-wrapper, .jimu-widget-add-data .jimu-tab3 {height: 100%;}.jimu-widget-add-data .search-pane {height: 100%; width: 100%; background-color: #f8f8f8;}.jimu-widget-add-data .search-pane-content {position: absolute; top: 140px; bottom: 40px; overflow: auto; background-color: #efefef;}.jimu-widget-add-data .search-pane-footer {position: absolute; bottom: 0;}.jimu-widget-add-data .search-pane \x3e * {width: 100%;}.jimu-widget-add-data .search-pane .search-pane-footer {background-color: #ffffff;}.jimu-widget-add-data .search-pane .search-bar {padding: 10px 15px;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn {min-width: 40px; padding-top: 10px; padding-bottom: 13px; background-color: transparent; border: 0; border-bottom: 2px solid transparent; margin-left: 5px; margin-right: 5px; font-size: 12px; font-weight: bold; font-family: inherit;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active, .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active, .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {background-color: transparent !important; color: #196fa6 !important; border-bottom-color: #196fa6; -webkit-box-shadow: none; box-shadow: none;}.jimu-widget-add-data .search-pane .search-bar.main-search-bar {background-color: #fff; padding-bottom: 0; position: relative;}.jimu-widget-add-data .search-pane .search-bar.search-scope-bar .search-sort-options {margin-top: 5px;}.jimu-widget-add-data .search-pane .search-bar.search-pane-footer {padding-top: 10px; padding-bottom: 10px;}.jimu-widget-add-data .search-pane .search-bar-secondary {background-color: #f8f8f8; padding-top: 5px; padding-bottom: 5px; font-size: 11px;}.jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .search-pane .search-pane-header:before, .jimu-widget-add-data .search-pane .search-pane-header:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-pane-header:after {clear: both;}.jimu-widget-add-data .search-pane .search-bar:before, .jimu-widget-add-data .search-pane .search-bar:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-bar:after {clear: both;}.jimu-widget-add-data .search-pane .search-data-type-options {margin-right: 15px;}.jimu-widget-add-data .search-pane .search-curated-option {display: inline-block; margin-left: 30px;}.jimu-widget-add-data .search-pane .search-bar-separator {border-bottom: 1px solid #e7e7e7;}.jimu-widget-add-data .search-pane .search-pane-default .search-bar {text-align: right; margin-bottom: 24px;}.jimu-widget-add-data .search-pane .search-results-pane {padding: 10px 5px;}.jimu-widget-add-data .search-pane .search-results-pane:after {content: ""; display: table; clear: both;}.jimu-widget-add-data .search-pane .item-card {float: left; width: 100%; padding-left: 5px; padding-right: 5px; -webkit-transition: width 0.1s ease; -o-transition: width 0.1s ease; transition: width 0.1s ease;}.jimu-widget-add-data .search-pane .item-card .item-card-inner {height: 70px; background: #ffffff; border: 1px solid #e0e0e0; border-bottom-color: #cccccc; padding: 5px; margin-bottom: 10px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;}.jimu-widget-add-data .search-pane .item-card .thumbnail {float: left; margin-right: 10px;}.jimu-widget-add-data .search-pane .item-card .thumbnail img {height: 60px; width: 90px;}.jimu-widget-add-data .search-pane .item-card h3.title {margin: 0 5px; padding: 0; font-size: 12px; font-weight: bold; color: #4c4c4c; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .search-pane .item-card div.info {font-size: 10px; overflow: hidden; white-space: nowrap; padding-top: 3px;}.jimu-widget-add-data .search-pane .item-card .action-bar, .jimu-widget-add-data .add-url-pane .action-bar {text-align: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .action-bar, .jimu-rtl .jimu-widget-add-data .add-url-pane .action-bar {text-align: left;}.jimu-widget-add-data .search-pane .item-card .action-bar a, .jimu-widget-add-data .add-url-pane .action-bar a {display: inline-block; font-size: 11px; text-transform: uppercase; padding: 5px; margin-right: 5px;}.jimu-widget-add-data .search-pane .item-card .action-bar a.disabled, .jimu-widget-add-data .add-url-pane .action-bar a.disabled {opacity: 0.3;}.jimu-widget-add-data .search-pane .item-card .action-bar .message, .jimu-widget-add-data .add-url-pane .action-bar .message {font-size: 10px; font-style: italic;}.jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: 38px; margin-right: 25px;}.jimu-widget-add-data .search-pane .search-box .input-group {position: relative; display: table; border-collapse: separate;}.jimu-widget-add-data .search-pane .search-box .input-group \x3e * {display: table-cell; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-box .search-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-pane .search-box .btn {display: inline-block; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data .search-pane .search-box .btn-clear {border-color: transparent; background: transparent; position: absolute; left: -32px;}.jimu-widget-add-data .search-pane .search-box-placeholder, .jimu-widget-add-data .search-pane .filter-placeholder, .jimu-widget-add-data .search-pane .scope-placeholder {display: none;}.jimu-widget-add-data .search-pane .search-sort-options \x3e * {vertical-align: middle;}.jimu-widget-add-data .search-pane .search-sort-options label {font-weight: normal; font-size: 11px; color: #cccccc;}.jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: right; width: 24px; height: 24px; margin: 3px 0;}.jimu-widget-add-data .search-pane .search-sort-options .dropdown-toggle .sort-order-icon {float: none; padding: 0 5px;}.jimu-widget-add-data .search-pane .sort-order-icon {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px; background-image: url("images/sort-down-arrow.png");}.jimu-widget-add-data .search-pane .sort-order-icon.descending {background-image: url("images/sort-up-arrow.png");}.jimu-widget-add-data .search-pane .scope-options \x3e * {display: inline-block;}.jimu-widget-add-data .search-pane .checkbox-inline, .jimu-widget-add-data .search-pane .radio-inline {position: relative; padding-left: 21px; margin-right: 10px;}.jimu-widget-add-data .search-pane .checkbox-inline .dijitCheckBox, .jimu-widget-add-data .search-pane .radio-inline .dijitCheckBox {}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views {display: block; padding: 5px;}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views [class*\x3d"gd-icon-"] {margin-right: 10px; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-paging .pagination {margin: 0;}.jimu-widget-add-data .search-pane .search-paging, .jimu-widget-add-data .search-pane .search-result-count {display: inline-block; vertical-align: middle; line-height: 1;}.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span, .jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:focus, .jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:hover {color: inherit; border-color: transparent; background-color: transparent;}.jimu-widget-add-data .search-pane .pagination \x3e li.current-page \x3e span {padding-left: 15px; padding-right: 15px;}.jimu-widget-add-data .search-pane .pagination [class*\x3d" esri-icon-"], .jimu-widget-add-data .search-pane .pagination [class^\x3d"esri-icon-"] {position: relative; top: 1px;}.jimu-widget-add-data .search-pane .search-result-count {margin: 0 10px;}.jimu-widget-add-data.width-768 .item-card {width: 50%;}.jimu-widget-add-data.width-1200 .item-card {width: 33.3333333333%;}.jimu-widget-add-data.width-medium .search-pane .search-bar, .jimu-widget-add-data.width-small .search-pane .search-bar {padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn, .jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: 0;}.jimu-rtl .jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn, .jimu-rtl .jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: auto; margin-right: 0;}.jimu-widget-add-data.width-medium .search-box-placeholder, .jimu-widget-add-data.width-medium .filter-placeholder, .jimu-widget-add-data.width-small .search-box-placeholder, .jimu-widget-add-data.width-small .filter-placeholder {display: block; height: 30px; width: 30px; background-image: url("images/search.png"); background-position: center center; background-repeat: no-repeat; background-size: 12px;}.jimu-widget-add-data.width-medium .search-box, .jimu-widget-add-data.width-small .search-box {display: none; padding: 10px; position: absolute; top: 0; left: 0; right: 40px; background: #ffffff;}.jimu-widget-add-data.width-small .search-box {padding-top: 8px; padding-bottom: 8px;}.jimu-widget-add-data.width-medium .search-box .input-group, .jimu-widget-add-data.width-small .search-box .input-group {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-textbox, .jimu-widget-add-data.width-small .search-box .search-textbox {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-btn, .jimu-widget-add-data.width-small .search-box .search-btn {width: 1%; position: relative;}.jimu-widget-add-data.width-medium .search-box.show, .jimu-widget-add-data.width-small .search-box.show {display: block;}.jimu-widget-add-data.width-medium .search-box-placeholder, .jimu-widget-add-data.width-small .search-box-placeholder {margin: 0 0 8px;}.jimu-widget-add-data.width-medium .search-box-placeholder.opened, .jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close.png");}.jimu-widget-add-data.width-medium .filter-placeholder, .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu.png");}.jimu-widget-add-data.width-medium .scope-placeholder, .jimu-widget-add-data.width-small .scope-placeholder {display: block; padding: 10px 10px 15px; color: #196fa6; font-weight: bold;}.jimu-widget-add-data.width-medium .scope-placeholder:focus, .jimu-widget-add-data.width-small .scope-placeholder:focus {text-decoration: none;}.jimu-widget-add-data.width-medium .scope-placeholder \x3e *, .jimu-widget-add-data.width-small .scope-placeholder \x3e * {vertical-align: middle;}.jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow, .jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow {display: inline-block; background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data.width-medium .filter-wrapper, .jimu-widget-add-data.width-medium .btn-group, .jimu-widget-add-data.width-small .filter-wrapper, .jimu-widget-add-data.width-small .btn-group {display: none;}.jimu-widget-add-data.width-medium .filter-wrapper.show, .jimu-widget-add-data.width-medium .btn-group.show, .jimu-widget-add-data.width-small .filter-wrapper.show, .jimu-widget-add-data.width-small .btn-group.show {display: block; position: absolute; right: 0; top: 91px; z-index: 10; padding: 5px 10px; background: #ffffff; border: 1px solid #cccccc; -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2);}.jimu-rtl .jimu-widget-add-data.width-medium .filter-wrapper.show, .jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show, .jimu-rtl .jimu-widget-add-data.width-small .filter-wrapper.show, .jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: 0; right: auto;}.jimu-widget-add-data.width-medium .btn-group.show, .jimu-widget-add-data.width-small .btn-group.show {top: 48px; left: 0; padding: 0; right: auto; min-width: 50%;}.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show, .jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: auto; right: 0;}.jimu-widget-add-data.width-medium .btn-group.show .btn, .jimu-widget-add-data.width-small .btn-group.show .btn {display: block; width: 100%; padding: 10px 15px; border: 0; font-weight: normal;}.jimu-widget-add-data.width-medium .btn-group.show .btn:hover, .jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #f4f4f4;}.jimu-widget-add-data.width-medium .btn-group.show .btn.active, .jimu-widget-add-data.width-medium .btn-group.show .btn.active:hover, .jimu-widget-add-data.width-small .btn-group.show .btn.active, .jimu-widget-add-data.width-small .btn-group.show .btn.active:hover {background-color: #196fa6 !important; color: #fff !important;}.jimu-widget-add-data.width-small .jimu-tab3 .tab-item-td {padding-left: 20px; padding-right: 20px;}.jimu-widget-add-data.width-small .search-pane .search-bar {padding-top: 5px; padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin: 0; padding-left: 5px; padding-right: 5px; font-size: 11px;}.jimu-widget-add-data.width-small .search-pane .search-results-pane {padding: 0; overflow: hidden;}.jimu-widget-add-data.width-small .search-pane .item-card {padding-left: 0; padding-right: 0;}.jimu-widget-add-data.width-small .search-pane .item-card .item-card-inner {margin-bottom: 0; border-top: 0; border-left: 0; border-right: 0; border-bottom-color: #e0e0e0;}.jimu-widget-add-data .search-pane .search-pane-footer .footerOptions {display: inline-block; float: right; margin-right: 30px; display: none;}.search-type-option {display: block; margin-bottom: 10px;}.jimu-widget-add-data {position: absolute; top: 0; bottom: 0; left: 0; right: 0; padding-top: 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.search-bbox-option, .search-box {display: inline-block;}.search-box, .search-box-placeholder {float: right;}.search-scope-options, .search-sort-options {display: inline-block;}.search-data-type-options {float: left;}.filter-wrapper, .filter-placeholder {float: right;}.search-scope-options button.active {background-color: #cce6ff;}.search-results-pane {overflow-y: auto;}.search-paging, .search-result-count {display: inline-block;}.search-paging ul {margin: 0; padding: 0;}.search-paging li {display: inline-block;}.search-item-card .action-bar {margin-left: 20px;}.search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .dijitDropDownButton {margin: 0;}.jimu-widget-add-data .dijitSelect, .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {background: transparent; border: 0; padding: 7px 5px; color: #196fa6; font-weight: bold; -webkit-box-shadow: none; box-shadow: none; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;}.jimu-widget-add-data .dijitSelect .dijitButtonContents, .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitButtonContents {border-color: transparent;}.jimu-widget-add-data .dijitSelect .dijitInputField, .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitInputField {padding: 0 5px;}.jimu-widget-add-data .dijitSelect .dijitArrowButton, .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitArrowButton {background: transparent; border: 0;}.jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton, .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 0;}.jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner, .jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner, .jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data-dialog {background-color: #FFFFFF !important; border-color: #555555 !important; border-radius: 5px; box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important;}.jimu-widget-add-data-dialog .dijitDialogPaneContent {border-top: 1px solid #cccccc;}.jimu-widget-add-data-dialog .dijitDialogTitleBar {background: none repeat scroll 0 0 rgba(0, 0, 0, 0); background-color: #FFFFFF; border-radius: 3px 3px 0 0;}.jimu-widget-add-data-dialog .dijitDialogTitle {background-color: #FFFFFF; color: #000000; font-size: 16px; font-weight: bold;}.jimu-widget-add-data-dialog div.gap {margin-top: 20px;}.jimu-widget-add-data-dialog div.small-gap {margin-top: 4px;}.jimu-widget-add-data-dialog div.action-bar {margin-top: 10px;}.jimu-widget-add-data-dialog .url-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data-dialog .url-textbox-wide {width: 500px;}.jimu-widget-add-data-dialog .examples {font-size: 9px; font-style: italic; margin-top: 4px; margin-left: 4px; opacity: 0.5;}.jimu-widget-add-data .btn-link {color: #196fa6 !important;}.jimu-widget-add-data .switch-toggle-group {padding: 5px;}.jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #e04f1d; position: relative; display: inline-block; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox:before {content: ""; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; right: 2px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-add-data .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 14px;}.jimu-widget-add-data .panel-default \x3e .panel-heading {background-color: transparent; border-color: #e0e0e0;}.jimu-widget-add-data .panel-title {font-size: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .panel-footer .btn + .btn {margin-left: 10px;}.jimu-widget-add-data .gp-panel {width: 300px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading {background-color: transparent; border-left: 1px solid rgba(0, 0, 0, 0.35); color: #efefef; height: 40px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .panel-title {font-weight: normal; line-height: 1.5;}.jimu-widget-add-data .gp-panel \x3e .panel-heading [class^\x3d"esri-icon-"], .jimu-widget-add-data .gp-panel \x3e .panel-heading [class*\x3d" esri-icon-"] {display: inline-block; margin-right: 10px; position: relative; top: 1px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {width: 20px; padding: 0; color: #efefef; float: right; margin-right: 0; font-size: 16px; line-height: 1.25; line-height: 20px; text-align: center;}.jimu-widget-add-data .gp-panel \x3e .panel-body {background-color: #f8f8f8; border-left: 1px solid #cccccc; position: absolute; top: 40px; bottom: 0; width: 100%; overflow: auto; padding: 0;}.jimu-widget-add-data .gp-panel .panel-section {background-color: #ffffff;}.jimu-widget-add-data .panel-section {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .panel-section .section-header {display: block; font-size: 16px; line-height: 1.25; line-height: 20px; padding: 10px 15px;}.jimu-widget-add-data .panel-section .section-header:after {content: ""; display: block; clear: both;}.jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"], .jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"], .jimu-widget-add-data .panel-section .section-header .btn {margin: 0 5px; float: right;}.jimu-widget-add-data .panel-section .section-header .btn {margin: 0; min-width: 80px;}.jimu-widget-add-data .panel-section .btn.section-header {border: 0; text-align: left; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-transition: all 0.25s ease; -o-transition: all 0.25s ease; transition: all 0.25s ease;}.jimu-widget-add-data .panel-section .btn.section-header:hover {background-color: #e2f1fb; text-decoration: none;}.jimu-widget-add-data .panel-section .btn.section-header:active, .jimu-widget-add-data .panel-section .btn.section-header:focus {background-color: #aadbfa; text-decoration: none;}.jimu-widget-add-data .panel-section .section-body {padding: 10px 15px;}.jimu-widget-add-data a, .add-url-pane a {display: block; color: #196fa6; text-decoration: none; padding: 10px 0;}.jimu-widget-add-data .search-pane-wrapper, .jimu-widget-add-data .jimu-widget-add-data .jimu-tab3 {height: 100%;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option, .search-box {display: inline-block;}.jimu-widget-add-data .search-box, .jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options, .jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper, .jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging, .jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-rtl .jimu-widget-add-data .search-paging li {-moz-transform: rotate(180deg); -webkit-transform: rotate(180deg); -o-transform: rotate(180deg); -ms-transform: rotate(180deg); transform: rotate(180deg);}.jimu-rtl .jimu-widget-add-data .search-paging li.current-page {-moz-transform: rotate(0); -webkit-transform: rotate(0); -o-transform: rotate(0); -ms-transform: rotate(0); transform: rotate(0);}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .add-url-pane {background-color: #fff; border-bottom: 1px solid #ccc; padding: 20px 15px;}.jimu-widget-add-data .add-url-pane label {color: #596679;}.jimu-widget-add-data .add-url-pane div.gap {margin-top: 20px;}.jimu-widget-add-data .add-url-pane div.small-gap {margin-top: 10px;}.jimu-widget-add-data .add-url-pane div.action-bar {margin-top: 20px;}.jimu-widget-add-data .add-url-pane .url-textbox {width: 100%; max-width: 500px; font-size: 14px;}.jimu-widget-add-data .add-url-pane .url-textbox-wide {}.jimu-widget-add-data .add-url-pane .examples {display: none; font-size: 12px; color: #596679; word-wrap: break-word; margin-top: 10px; margin-left: 4px; opacity: 0.5;}.jimu-widget-add-data .add-url-pane .examples \x3e div \x3e div {margin-bottom: 15px;}.jimu-widget-add-data .add-url-pane .examples.show {display: block;}.jimu-widget-add-data .add-url-pane .jimu-btn {color: #fff; line-height: 20px; text-decoration: none;}.jimu-widget-add-data .add-url-pane .jimu-btn:active {}.jimu-widget-add-data .jimu-tab3 \x3e .jimu-viewstack {position: absolute; top: 39px; left: 0px; right: 0; bottom: 0;}.add-data-widget-popup {padding: 0;}.add-data-widget-popup .dijitTooltipConnector {display: none;}.add-data-widget-popup .dijitTooltipContainer {padding: 10px; border-color: #ccc; -moz-border-radius: 0; border-radius: 0; -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup.dijitMenuPopup {-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup .dijitMenu {border-color: #ccc;}.add-data-widget-popup .dijitMenu .dijitMenuItem td {padding: 10px 15px; border: 0;}.add-data-widget-popup .dijitMenu .dijitMenuItemHover td, .add-data-widget-popup .dijitMenu .dijitMenuItemActive td, .add-data-widget-popup .dijitMenu .dijitMenuItemSelected td {background-color: #f4f4f4; background-image: none;}.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemSelected td {background-color: #196fa6; background-image: none; color: #fff; font-weight: normal;}.LaunchpadTheme .jimu-widget-add-data.jimu-widget {position: absolute;}.LaunchpadTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.LaunchpadTheme .jimu-widget-add-data .switch-toggle-group {padding-top: 10px; padding-bottom: 10px;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton, .LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 5px;}.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {color: #196fa6; font-size: inherit; letter-spacing: 0;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect,.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {background-color: transparent; border: 0;}.LaunchpadTheme .jimu-widget-add-data .add-url-pane .jimu-btn {background-color: #3b8fc4; border: 0;}.LaunchpadTheme .jimu-widget-add-data .add-url-pane .jimu-btn:hover {background-color: #2c6b93;}.DartTheme .jimu-widget-add-data .search-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-secondary {background: #3a3a3a;}.DartTheme .jimu-widget-add-data .add-url-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane-content {background-color: #222;}.DartTheme .jimu-tab3 .tab-item-td.jimu-state-active {background: #4C4C4C;}.DartTheme .dart-panel .jimu-widget-add-data {padding-top: 10px;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-separator,.DartTheme .jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #262626;}.DartTheme .jimu-widget-add-data .search-pane .search-bar.search-pane-footer {padding-top: 0; padding-bottom: 0;}.DartTheme .jimu-widget-add-data .switch-toggle-group {padding-top: 10px; padding-bottom: 10px;}.DartTheme .jimu-widget-add-data .search-pane .search-box .search-textbox {background: #393939; background: rgba(0, 0, 0, 0.25); border: 1px solid #a6a6a6; border: 1px solid rgba(255, 255, 255, 0.5); color: #ffffff; border-radius: 2px;}.DartTheme .jimu-widget-add-data.width-medium .search-box,.DartTheme .jimu-widget-add-data.width-small .search-box {background: #4c4c4c;}.DartTheme .jimu-widget-add-data .search-pane .search-box .btn {background: #4c4c4c; border: 1px solid #9B9B9B; border-left: 1px solid #7f8183;}.DartTheme .jimu-widget-add-data .search-pane .item-card .item-card-inner {background: #4c4c4c; border: 1px solid #787878;}.DartTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.DartTheme .jimu-widget-add-data.width-medium .filter-wrapper.show, .DartTheme .jimu-widget-add-data.width-medium .btn-group.show, .DartTheme .jimu-widget-add-data.width-small .filter-wrapper.show, .DartTheme .jimu-widget-add-data.width-small .btn-group.show {background: #393939; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .jimu-widget-add-data.width-medium .btn-group.show .btn:hover, .DartTheme .jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #222;}.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active, .DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active, .DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {color: #f8f8f8 !important; border-bottom-color: #15a4fa;}.DartTheme .jimu-widget-add-data .search-pane .search-sort-options label {color: #a7a7a7 !important;}.DartTheme .jimu-widget-add-data .add-url-pane {border-bottom: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card div.info {color: #ddd !important;}.DartTheme .jimu-widget-add-data .search-pane .item-card .action-bar a, .DartTheme .jimu-widget-add-data .add-url-pane .action-bar a {color: #15a4fa !important;}.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {padding: 7px;}.DartTheme .jimu-widget-add-data .dijitSelect {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/search_white.png");}.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder.opened,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close_white.png");}.DartTheme.add-data-widget-popup .dijitTooltipContainer {color: #f8f8f8; background: #4c4c4c; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.jimu-rtl .jimu-widget-add-data .search-pane .item-card {float: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .thumbnail {float: right;}.jimu-rtl .jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: auto; padding-right: 38px; margin-right: auto; margin-left: 25px;}.jimu-rtl .jimu-widget-add-data.width-medium .search-box, .jimu-rtl .jimu-widget-add-data.width-small .search-box {left: 40px; right: 0;}.jimu-rtl .jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: left;}.jimu-rtl .jimu-widget-add-data .search-pane .search-pane-footer .footerOptions {float: left;}.jimu-rtl .search-box, .search-box-placeholder {float: left;}.jimu-rtl .search-data-type-options {float: right;}.jimu-rtl .filter-wrapper, .filter-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: auto; padding-right: 36px;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: auto; margin-right: -36px;}.jimu-rtl .jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {float: left;}.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"], .jimu-rtl .jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"], .jimu-rtl .jimu-widget-add-data .panel-section .section-header .btn {float: left;}.jimu-rtl .jimu-widget-add-data .search-box, .jimu-rtl .jimu-widget-add-data .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper, .jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}',
"*now":function(q){q(['dojo/i18n!*preload*widgets/AddData/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","hr","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/Deferred dojo/dom-class jimu/portalUtils jimu/BaseWidget dijit/_WidgetsInTemplateMixin ./search/SearchContext ./search/util ./search/SearchPane".split(" "),function(q,l,n,e,k,u,d,t){return q([k,u],{name:"AddData",baseClass:"jimu-widget-add-data",_isOpen:!1,_searchOnOpen:!1,postCreate:function(){this.inherited(arguments);this.searchPane.wabWidget=this},startup:function(){if(!this._started){var c=this,d=arguments;this._initContext().then(function(){c.inherited(d);c._initListeners();
c.resize()}).otherwise(function(e){console.warn("AddData.startup error:",e);c.inherited(d);c.resize()})}},_checkConfig:function(){var c=this.config;c.scopeOptions||(c.scopeOptions={});var d=c.scopeOptions,c=function(c){var e=d[c];e||(e=d[c]={allow:!0,label:null});"boolean"!==typeof e.allow&&(e.allow=!0)};c("MyContent");c("MyOrganization");c("ArcGISOnline");c("FromUrl")},_initContext:function(){this._checkConfig();var c=new l,g=!0,k=t.checkMixedContent("http://www.arcgis.com"),n=new d,q=e.getPortal(this.appConfig.portalUrl);
n.portal=q;q.user&&("string"===typeof q.user.orgId&&0<q.user.orgId.length&&(n.orgId=q.user.orgId),"string"===typeof q.user.username&&0<q.user.username.length&&(n.username=q.user.username));this.searchPane.searchContext=n;this.searchPane.portal=q;var u=this.nls.loadError+k,B=this.config.scopeOptions.ArcGISOnline;n.allowArcGISOnline=B.allow;if(q.isPortal&&n.allowArcGISOnline){var y=e.getPortal(k);y?y.helperServices||(g=!1,y.loadSelfInfo().then(function(){y.helperServices?n.arcgisOnlinePortal=y:(console.warn(u),
n.allowArcGISOnline=!1,B.allow=!1);c.resolve()}).otherwise(function(d){n.allowArcGISOnline=!1;B.allow=!1;console.warn(u);console.warn(d);c.resolve()})):(console.warn(u),n.allowArcGISOnline=!1,B.allow=!1)}g&&c.resolve();return c},_initListeners:function(){var c=this;this.map&&this.own(this.map.on("extent-change",function(){try{c.searchPane.bboxOption.bboxToggle.get("checked")&&(c._isOpen?c.searchPane.search():c._searchOnOpen=!0)}catch(d){console.warn(d)}}))},onClose:function(){this._isOpen=!1},onOpen:function(){var c=
this._searchOnOpen;this._isOpen=!0;this._searchOnOpen=!1;this.resize();c&&this.searchPane.search()},resize:function(){var c=this.domNode.clientWidth;1E3<c?(n.remove(this.domNode,"width-768"),n.add(this.domNode,"width-1200")):768<c?(n.remove(this.domNode,"width-1200"),n.add(this.domNode,"width-768")):n.remove(this.domNode,["width-768","width-1200"]);320>c?(n.remove(this.domNode,"width-medium"),n.add(this.domNode,"width-small")):750>c?(n.remove(this.domNode,"width-small"),n.add(this.domNode,"width-medium")):
n.remove(this.domNode,["width-small","width-medium"]);this.searchPane&&this.searchPane.resize()}})});