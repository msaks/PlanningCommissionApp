// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/FilterParameters":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter".split(" "),function(l,q,r,s,p,d,b,h,a,m,g,c,n,f){return r([s,p,d,q],{baseClass:"jimu-filter-parameters",templateString:'\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e',
nls:null,partsObj:null,layerInfo:null,OPERATORS:null,url:null,_filterUtils:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this._filterUtils=new c;this.OPERATORS=b.clone(this._filterUtils.OPERATORS)},destroy:function(){this.clear();this._filterUtils=null;this.inherited(arguments)},getFilterExpr:function(c){void 0===c&&(c=!0);for(var a=this.partsObj,e=this._getAllInteractiveSinglePartArray(a),f=0;f<e.length;f++){var v=e[f],b=v.spId;if(b&&(b=m("#"+b,this.tbody)[0])){b=g.byNode(b).getValueObj(c);
if(!b)return null;v.valueObj=b}}this._filterUtils.isHosted=n.isHostedService(this.url);return this._filterUtils.getExprByFilterObj(a)},clear:function(){this.url=null;var c=m(".jimu-widget-query-single-parameter",this.tbody);a.forEach(c,b.hitch(this,function(c){g.byNode(c).destroy()}));h.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(c,n,e){this.clear();this.url=c;this.layerInfo=n;this.partsObj=b.clone(e);c=this._getAllInteractiveSinglePartArray(this.partsObj);a.forEach(c,b.hitch(this,
function(c){var e=h.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),e=m("td",e)[0],a=this._getFieldInfo(c.fieldObj.name,this.layerInfo),a=new f({nls:this.nls,part:c,fieldInfo:a,OPERATORS:this.OPERATORS,url:this.url});this.own(l(a,"change",b.hitch(this,this._onSingleFilterParameterChanged)));a.placeAt(e);a.startup();c.spId=a.id}))},_getFieldInfo:function(c,a){for(var e=a.fields,n=0;n<e.length;n++){var v=e[n];if(c===v.name)return v}return null},_getAllInteractiveSinglePartArray:function(c){for(var a=
[],e=0;e<c.parts.length;e++){var n=c.parts[e];if(n.parts)for(var v=0;v<n.parts.length;v++){var b=n.parts[v];b.interactiveObj&&a.push(b)}else n.interactiveObj&&a.push(n)}return a},_onSingleFilterParameterChanged:function(){this.emit("change",this.getFilterExpr(!1))}})})},"jimu/dijit/_SingleFilterParameter":function(){define("dojo/on dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/store/Memory jimu/utils dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(l,q,r,s,p,d,b,h,a,m,g){return q([r,s,p],{baseClass:"jimu-single-filter-parameter",templateString:d,fieldInfo:null,part:null,nls:null,OPERATORS:null,url:null,_type:-1,postCreate:function(){this.inherited(arguments);var c=new m({idProperty:"id",data:[]});this.stringUniqueValuesSelect.set("store",c);c=new m({idProperty:"id",data:[]});this.numberUniqueValuesSelect.set("store",c);this.fieldInfo&&this.part&&this.build(this.fieldInfo,this.part);var n=["dijit.form.FilteringSelect","dijit.form.ValidationTextBox",
"dijit.form.DateTextBox","dijit.form.NumberTextBox"];this._attachPoints&&0<this._attachPoints.length&&a.forEach(this._attachPoints,b.hitch(this,function(c){(c=this[c])&&c.domNode&&0<=n.indexOf(c.declaredClass)&&this.own(l(c,"change",b.hitch(this,this._onDijitChanged)))}))},getValueObj:function(c){var a=null,b=this.part.fieldObj.shortType;"string"===b?a=this._getStirngValueObj(c):"number"===b?a=this._getNumberValueObj(c):"date"===b&&(a=this._getDateValueObj(c));a&&(a.type=this.part.valueObj.type,a.isValid=
!0);return a},_getStirngValueObj:function(c){var a=null;if(1===this._type){if(!this.stringTextBox.validate())return c&&this._showValidationErrorTip(this.stringTextBox),null;a={};a.value=this.stringTextBox.get("value")}else if(2===this._type){if(!this.stringCodedValuesFS.validate())return c&&this._showValidationErrorTip(this.stringCodedValuesFS),null;a={};c=this._getSelectedFilteringItem(this.stringCodedValuesFS);a.value=c.code}else if(3===this._type){if(!this.stringUniqueValuesSelect.validate())return c&&
this._showValidationErrorTip(this.stringUniqueValuesSelect),null;a={};c=this._getSelectedFilteringItem(this.stringUniqueValuesSelect);a.value=c.value}return a},_getNumberValueObj:function(c){var a=null;if(1===this._type){if(!this.numberTextBox.validate())return c&&this._showValidationErrorTip(this.numberTextBox),null;a={};a.value=parseFloat(this.numberTextBox.get("value"))}else if(2===this._type){if(!this.numberCodedValuesFS.validate())return c&&this._showValidationErrorTip(this.numberCodedValuesFS),
null;a={};c=this._getSelectedFilteringItem(this.numberCodedValuesFS);a.value=parseFloat(c.code)}else if(3===this._type){if(!this.numberTextBox1.validate())return c&&this._showValidationErrorTip(this.numberTextBox1),null;if(!this.numberTextBox2.validate())return c&&this._showValidationErrorTip(this.numberTextBox2),null;a={};a.value1=parseFloat(this.numberTextBox1.get("value"));a.value2=parseFloat(this.numberTextBox2.get("value"))}else if(4===this._type){if(!this.numberUniqueValuesSelect.validate())return c&&
this._showValidationErrorTip(this.numberUniqueValuesSelect),null;a={};c=this.numberUniqueValuesSelect.get("item");a.value=parseFloat(c.value)}return a},_getDateValueObj:function(a){var b=null;if(1===this._type){if(!this.dateTextBox.validate())return a&&this._showValidationErrorTip(this.dateTextBox),null;b={};b.value=this.dateTextBox.get("value").toDateString()}else if(2===this._type){if(!this.dateTextBox1.validate())return a&&this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return a&&
this._showValidationErrorTip(this.dateTextBox2),null;b={};b.value1=this.dateTextBox1.get("value").toDateString();b.value2=this.dateTextBox2.get("value").toDateString()}return b},build:function(a,b){this.fieldInfo=a;this.part=b;var f=b.interactiveObj;f&&(this.promptNode.innerHTML=f.prompt||"",this.hintNode.innerHTML=f.hint||"");f=this.part.fieldObj.shortType;"string"===f?this._buildString(a,this.part):"number"===f?this._buildNumber(a,this.part):"date"===f&&this._buildDate(a,this.part)},_getCodedValues:function(a){var b=
null;if((a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length)b=a.codedValues;return b},_buildString:function(c,n){h.setStyle(this.stringTextBoxContainer,"display","block");h.setStyle(this.numberTextBoxContainer,"display","none");h.setStyle(this.dateTextBoxContainer,"display","none");this._hideDijit(this.stringTextBox);this._hideDijit(this.stringCodedValuesFS);this._hideDijit(this.stringUniqueValuesSelect);var f=n.fieldObj,k=n.valueObj,d=k.type,e=this._getCodedValues(c);e?(this._type=
2,this._showDijit(this.stringCodedValuesFS),d=a.map(e,b.hitch(this,function(a,e){var c=b.mixin({},a);c.id=e;return c})),e=new m({data:d}),this.stringCodedValuesFS.set("store",e),k&&(e=a.filter(d,b.hitch(this,function(a){return a.code===k.value})),0<e.length?this.stringCodedValuesFS.set("value",e[0].id):this.stringCodedValuesFS.set("value",d[0].id))):"unique"===d?(this._type=3,this._showDijit(this.stringUniqueValuesSelect),g.getUniqueValues(this.url,f.name).then(b.hitch(this,function(e){var c=-1;e=
a.map(e,b.hitch(this,function(a,e){var b=a;"number"===f.shortType&&(a=parseFloat(a),b=this._tryLocaleNumber(a));b={id:e,value:a,label:b};k&&k.value===a&&(c=e);return b}));this.stringUniqueValuesSelect.store.setData(e);0<=c&&(e=this.stringUniqueValuesSelect.store.get(c))&&this.stringUniqueValuesSelect.set("item",e)}),b.hitch(this,function(a){console.error(a)}))):(this._type=1,this._showDijit(this.stringTextBox),this.stringTextBox.set("value",k.value||""))},_tryLocaleNumber:function(a){var b=g.localizeNumber(a);
if(null===b||void 0===b)b=a;return b},_buildNumber:function(c,d){h.setStyle(this.stringTextBoxContainer,"display","none");h.setStyle(this.numberTextBoxContainer,"display","block");h.setStyle(this.dateTextBoxContainer,"display","none");this._hideDijit(this.numberTextBox);this._hideDijit(this.numberCodedValuesFS);h.setStyle(this.numberRangeTable,"display","none");this._hideDijit(this.numberUniqueValuesSelect);var f=d.fieldObj,k=d.valueObj,l=k.type,e=d.operator,x=e===this.OPERATORS.numberOperatorIsNotBetween;
if(e===this.OPERATORS.numberOperatorIsBetween||x)this._type=3,h.setStyle(this.numberRangeTable,"display","table"),g.isValidNumber(k.value1)&&this.numberTextBox1.set("value",k.value1),g.isValidNumber(k.value2)&&this.numberTextBox2.set("value",k.value2);else if(h.setStyle(this.numberRangeTable,"display","none"),e=this._getCodedValues(c))if(this._type=2,this._showDijit(this.numberCodedValuesFS),l=a.map(e,b.hitch(this,function(a,e){var c=b.clone(a);c.id=e;return c})),e=new m({data:l}),this.numberCodedValuesFS.set("store",
e),k&&g.isValidNumber(k.value)){var v=parseFloat(k.value),e=a.filter(l,b.hitch(this,function(a){return parseFloat(a.code)===v}));0<e.length?this.numberCodedValuesFS.set("value",e[0].id):this.numberCodedValuesFS.set("value",l[0].id)}else this.numberCodedValuesFS.set("value",l[0].id);else"unique"===l?(this._type=4,this._showDijit(this.numberUniqueValuesSelect),g.getUniqueValues(this.url,f.name).then(b.hitch(this,function(e){var c=-1;e=a.map(e,b.hitch(this,function(a,e){var b=a;"number"===f.shortType&&
(a=parseFloat(a),b=this._tryLocaleNumber(a));b={id:e,value:a,label:b};k&&k.value===a&&(c=e);return b}));this.numberUniqueValuesSelect.store.setData(e);0<=c&&(e=this.numberUniqueValuesSelect.store.get(c))&&this.numberUniqueValuesSelect.set("item",e)}),b.hitch(this,function(a){console.error(a)}))):(this._type=1,this._showDijit(this.numberTextBox),k&&g.isValidNumber(k.value)&&this.numberTextBox.set("value",k.value))},_buildDate:function(a,b){h.setStyle(this.stringTextBoxContainer,"display","none");h.setStyle(this.numberTextBoxContainer,
"display","none");h.setStyle(this.dateTextBoxContainer,"display","block");var f=b.valueObj,k=b.operator,d=k===this.OPERATORS.dateOperatorIsNotBetween;k===this.OPERATORS.dateOperatorIsBetween||d?(this._type=2,h.setStyle(this.dateRangeTable,"display","table"),this._hideDijit(this.dateTextBox),this.dateTextBox1.set("value",new Date(f.value1)),this.dateTextBox2.set("value",new Date(f.value2))):(this._type=1,h.setStyle(this.dateRangeTable,"display","none"),this._showDijit(this.dateTextBox),this.dateTextBox.set("value",
new Date(f.value)))},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("item");if(b)return b}this._showValidationErrorTip(a);return null},_showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())},_showDijit:function(a){a&&a.domNode&&h.setStyle(a.domNode,"display","inline-block")},_hideDijit:function(a){a&&a.domNode&&h.setStyle(a.domNode,"display","none")},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var a=
parseFloat(this.numberTextBox1.get("value")),b=parseFloat(this.numberTextBox2.get("value"));a>b&&(this.numberTextBox1.set("value",b),this.numberTextBox2.set("value",a))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var a=this.dateTextBox1.get("value"),b=a.getTime(),f=this.dateTextBox2.get("value"),d=f.getTime();b>d&&(this.dateTextBox1.set("value",f),this.dateTextBox2.set("value",a))}},_onDijitChanged:function(){this.emit("change")}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(l,q,r,s,p){return l("dijit.form.FilteringSelect",[s,p],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(d,b,h,a){b&&b[this.searchAttr]!==this._lastQuery||!b&&d.length&&this.store.getIdentity(d[0])!=this._lastQuery||
(d.length?this.set("item",d[0],a):this.set("value","",a||void 0===a&&!this.focused,this.textbox.value,null))},_openResultList:function(d,b,h){b[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(d,b,h,a){this._onChangeActive||(b=null);if(void 0===a){if(null===d||""===d)if(d="",!q.isString(h)){this._setDisplayedValueAttr(h||"",b);
return}var m=this;this._lastQuery=d;r(this.store.get(d),function(a){m._callbackSetLabel(a?[a]:[],void 0,void 0,b)})}else this.valueNode.value=d,this.inherited(arguments,[d,b,h,a])},_setItemAttr:function(d,b,h){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(d){return d.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(d,b){null==d&&(d="");if(!this._created){if(!("displayedValue"in this.params))return;b=!1}if(this.store){this.closeDropDown();
var h=q.clone(this.query),a=this._getDisplayQueryString(d),m;this.store._oldAPI?m=a:(m=this._patternToRegExp(a),m.toString=function(){return a});this._lastQuery=h[this.searchAttr]=m;this._lastDisplayedValue=this.textbox.value=d;this._set("displayedValue",d);var g=this,c={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};q.mixin(c,this.fetchProperties);this._fetchHandle=this.store.query(h,c);r(this._fetchHandle,function(a){g._fetchHandle=null;g._callbackSetLabel(a||[],h,c,b)},function(a){g._fetchHandle=
null;g._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(l,q,r){return l("dijit.form.DateTextBox",r,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:q,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(l,q,r,s,p,d,b,h,a,m,g,c,n,f,k,y,e){var x=s("dijit.Calendar",[n,f,k],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){h.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new x._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:m.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(g(this.domNode,"keydown",m.hitch(this,"_onKeyDown")),g(this.dateRowsNode,"mouseover",m.hitch(this,"_onDayMouseOver")),g(this.dateRowsNode,"mouseout",m.hitch(this,"_onDayMouseOut")),g(this.dateRowsNode,"mousedown",m.hitch(this,"_onDayMouseDown")),g(this.dateRowsNode,"mouseup",m.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var e=
new this.dateClassObj(this.currentFocus);e.setDate(1);e.setMonth(a);a=this.dateModule.getDaysInMonth(e);var b=this.currentFocus.getDate();e.setDate(Math.min(b,a));this._setCurrentFocusAttr(e)},_onDayMouseOver:function(a){if((a=d.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!d.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))d.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",d.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),d.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!d.contains(a,"dijitCalendarDisabledDate"))d.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&d.remove(a,"dijitCalendarActiveDate")},
handleKey:function(e){var b=-1,c,f=this.currentFocus;switch(e.keyCode){case a.RIGHT_ARROW:b=1;case a.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case a.DOWN_ARROW:b=1;case a.UP_ARROW:c="week";break;case a.PAGE_DOWN:b=1;case a.PAGE_UP:c=e.ctrlKey||e.altKey?"year":"month";break;case a.END:f=this.dateModule.add(f,"month",1),c="day";case a.HOME:f=new this.dateClassObj(f);f.setDate(1);break;default:return!0}c&&(f=this.dateModule.add(f,c,b));this._setCurrentFocusAttr(f);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});x._MonthDropDownButton=s("dijit.Calendar._MonthDropDownButton",e,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new x._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var e=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
e);this.containerNode.innerHTML=(6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+e[a.getMonth()]+"\x3c/div\x3e"}});x._MonthDropDown=s("dijit.Calendar._MonthDropDown",[f,y,k],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";l.forEach(a,function(a,e){b.create("div",{className:"dijitCalendarMonthLabel",month:e,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(p.get(a.target,"month"))},onChange:function(){}});return x})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(l,q,r,s,p,d,b,h,a,m,g,c,n,f,k){var y=q("dijit.CalendarLite",[n,f],{templateString:k,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=d.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&
(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),f=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),d=new this.dateClassObj,k=0<=this.dayOffset?this.dayOffset:r.getFirstDayOfWeek(this.lang);k>b&&
(k-=7);if(!this.summary){var h=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",h[a.getMonth()])}this._date2cell={};l.forEach(this.dateCells,function(h,g){var m=g+k,l=new this.dateClassObj(a),t="dijitCalendar",z=0;m<b?(m=f-b+m+1,z=-1,t+="Previous"):m>=b+c?(m=m-b-c+1,z=1,t+="Next"):(m=m-b+1,t+="Current");z&&(l=this.dateModule.add(l,"month",z));l.setDate(m);this.dateModule.compare(l,d,"date")||(t="dijitCalendarCurrentDate "+t);this.isDisabledDate(l,
this.lang)?(t="dijitCalendarDisabledDate "+t,h.setAttribute("aria-disabled","true")):(t="dijitCalendarEnabledDate "+t,h.removeAttribute("aria-disabled"),h.setAttribute("aria-selected","false"));(z=this.getClassForDate(l,this.lang))&&(t=z+" "+t);h.className=t+"Month dijitCalendarDateTemplate";t=l.valueOf();this._date2cell[t]=h;h.dijitDateValue=t;this._setText(this.dateLabels[g],l.getDateLocalized?l.getDateLocalized(this.lang):l.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);
a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;l.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(b){this.dateModule=b.datePackage?a.getObject(b.datePackage,!1):s;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=b.datePackage?
a.getObject(b.datePackage+".locale",!1):p},_createMonthWidget:function(){return y._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,f=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),d=0<=this.dayOffset?this.dayOffset:r.getFirstDayOfWeek(this.lang);this.dayCellsHtml=c.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return f[d++%7]});a=c.substitute(this.weekTemplateString,
{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);b.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var b=a.hitch(this,function(b,c,e){this[b].dojoClick=!0;return m(this[b],"click",a.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,
c,e))}))});this.own(b("incrementMonth","month",1),b("decrementMonth","month",-1),b("nextYearLabelNode","year",1),b("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,f=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(c,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||
b)&&c.focus();f&&f!=c&&(g("webkit")?f.setAttribute("tabIndex","-1"):f.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!h.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(b){function c(a,
b){h.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}l.forEach(this._selectedCells||[],a.partial(c,!1));this._selectedCells=l.filter(l.map(b,this._getNodeByDate,this),function(a){return a});l.forEach(this._selectedCells,a.partial(c,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});y._MonthWidget=q("dijit.CalendarLite._MonthWidget",n,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",
this.lang,a),c=6==g("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+l.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return y})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(l,q,r,s,p,d,b,h){new Date("X");return s("dijit.form._DateTimeTextBox",[d,b],{templateString:h,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:q.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(a,b){var d=this._isInvalidDate(a),c=this._isInvalidDate(b);if(d||c)return d&&c?0:!d?1:-1;var d=this.format(a,this._unboundedConstraints),c=this.format(b,this._unboundedConstraints),
h=this.parse(d,this._unboundedConstraints),f=this.parse(c,this._unboundedConstraints);return d==c?0:l.compare(h,f,this._selector)},autoWidth:!0,format:function(a,b){return!a?"":this.dateLocaleModule.format(a,b)},parse:function(a,b){return this.dateLocaleModule.parse(a,b)||(this._isEmpty(a)?null:void 0)},serialize:function(a,b){a.toGregorian&&(a=a.toGregorian());return r.toISOString(a,b)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=
a||{};this.dateModule=a.datePackage?p.getObject(a.datePackage,!1):l;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?p.getObject(a.datePackage+".locale",!1):q;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(a){a.selector=this._selector;a.fullYear=!0;var b=r.fromISOString;"string"==typeof a.min&&(a.min=b(a.min),this.dateClassObj instanceof Date||(a.min=new this.dateClassObj(a.min)));"string"==typeof a.max&&(a.max=b(a.max),this.dateClassObj instanceof Date||(a.max=new this.dateClassObj(a.max)));this.inherited(arguments);this._unboundedConstraints=p.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||
isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(a,b,d){void 0!==a&&("string"==typeof a&&(a=r.fromISOString(a)),this._isInvalidDate(a)&&(a=null),a instanceof Date&&!(this.dateClassObj instanceof Date)&&(a=new this.dateClassObj(a)));this.inherited(arguments,[a,b,d]);this.value instanceof Date&&(this.filterString="");!1!==b&&this.dropDown&&this.dropDown.set("value",a,!1)},_set:function(a,b){if("value"==a){b instanceof Date&&!(this.dateClassObj instanceof Date)&&
(b=new this.dateClassObj(b));var d=this._get("value");if(d instanceof this.dateClassObj&&0==this.compare(b,d))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},openDropDown:function(a){this.dropDown&&this.dropDown.destroy();var b=p.isString(this.popupClass)?p.getObject(this.popupClass,!1):this.popupClass,d=this,c=this.get("value");this.dropDown=new b({onChange:function(a){d.set("value",
a,!0)},id:this.id+"_popup",dir:d.dir,lang:d.lang,value:c,textDir:d.textDir,currentFocus:!this._isInvalidDate(c)?c:this.dropDownDefaultValue,constraints:d.constraints,filterString:d.filterString,datePackage:d.datePackage,isDisabledDate:function(a){return!d.rangeCheck(a,d.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,b){this._setValueAttr(this.parse(a,this.constraints),b,a)}})})},"widgets/GroupFilter/SaveJSON":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/html dojo/has jimu/utils".split(" "),
function(l,q,r,s,p,d){return q([l],{declaredClass:"saveJSON",config:null,constructor:function(b){q.safeMixin(this,b)},_getDownloadUrl:function(b){return window.Blob&&window.URL&&window.URL.createObjectURL?(b=new Blob([b],{type:"text/json"}),URL.createObjectURL(b)):"data:attachment/json;charset\x3dutf-8,"+encodeURIComponent(b)},exportsJson:function(b,d){var a=JSON.stringify(d),l=new r;try{if(p("ie")&&10>p("ie")){var g=window.top.open("about:blank","_blank");g.document.write("sep\x3d,\r\n"+a);g.document.close();
g.document.execCommand("SaveAs",!0,b);g.close();this.savePrompt()}else if(10===p("ie")||this._isIE11()||this._isEdge()){var c=new Blob([a],{type:"text/json"});navigator.msSaveBlob(c,b);this.savePrompt()}else{var n=s.create("a",{href:this._getDownloadUrl(a),target:"_blank",download:b},document.body);if(p("safari")){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0);n.dispatchEvent(f)}else n.click();this.savePrompt();s.destroy(n)}l.resolve()}catch(k){l.reject(k)}return l},_isIE11:function(){return 11===
d.has("ie")},_isEdge:function(){return d.has("edge")},savePrompt:function(){this.emit("complete",{})}})})},"widgets/GroupFilter/ReadJSON":function(){define("dojo/Evented dojo/_base/declare dojo/has dojo/_base/lang jimu/utils jimu/dijit/Message".split(" "),function(l,q,r,s,p,d){return q([l],{declaredClass:"readJSON",config:null,jsonFile:null,constructor:function(b){q.safeMixin(this,b)},checkFileReader:function(){this.supportHTML5()?(console.log("HTML 5 loader"),this._processFiles(this.jsonFile)):!this.supportHTML5()&&
!r("safari")&&this.isEnabledFlash()?p.file.loadFileAPI().then(s.hitch(this,function(){console.log("loading FileAPI")})):console.log("no loader")},_processFiles:function(b){0<b.length&&(b=b[0],-1!==b.name.indexOf(".json")?b&&this.handleJson(b):new d({message:"Not a json file"}))},handleJson:function(b){if(this.supportHTML5()){var h=new FileReader;h.onload=function(a){return function(){-1<h.result.indexOf("groups")?a.completePrompt(h.result):(new d({message:"json file is Invalid"}),a.errorPrompt("error"))}}(this);
h.readAsText(b)}else window.FileAPI.readAsText(b,s.hitch(this,function(a){}))},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return r("safari")&&6>r("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var b=null;if(document.all)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(d){b=null}else navigator.plugins&&0<navigator.plugins.length&&(b=navigator.plugins["Shockwave Flash"]);
return!!b},completePrompt:function(b){this.emit("complete",{UserSettings:b})},errorPrompt:function(){this.emit("error",{UserSettings:"error"})}})})},"widgets/GroupFilter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_SingleFilterParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr class\x3d"first-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"second-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"display:none;width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"stringUniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"display:none;width:100%;" /\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"numberUniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'required:true, trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"display:none;width:100%;" /\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"third-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/GroupFilter/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"groupContainer" data-dojo-attach-point\x3d"widgetIntro"\x3e\r\n\t\t\x3cdiv class\x3d"group-picker"\x3e\r\n\t\t\t\x3ctable width\x3d"100%"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"groupHeader"\x3e${nls.labels.selectGroup}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"saveTD" data-dojo-attach-point\x3d"optionsIcon" id\x3d"saveTD" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\x3cdiv data-dojo-attach-point\x3d"groupPicker" id\x3d"groupPicker"\x3e\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" id\x3d"groupDesc" data-dojo-attach-point\x3d"groupDesc"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"container" data-dojo-attach-point\x3d"filterBlock" id\x3d"filterBlock"\x3e\r\n\t\t\x3cdiv class\x3d"filter-block" data-dojo-attach-point\x3d"filterBlockInner" id\x3d"filterBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblPredicates" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"saveContainer" data-dojo-attach-point\x3d"saveBlock" id\x3d"saveBlock"\x3e\r\n\t\t\x3cdiv class\x3d"save-block" data-dojo-attach-point\x3d"saveBlockInner" id\x3d"saveBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdFirstLabel"\x3e${nls.labels.saveHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"close-save" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cdiv class\x3d"jimu-btn saveFunction" data-dojo-attach-event\x3d"click:saveJsonToFile" \x3e${nls.buttons.save}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.uploadHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"loadProgressHeader" id\x3d"tdProgress"\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdUploadData"\x3e\x3cinput type\x3d"file" id\x3d"jsonFileInput" data-dojo-attach-point\x3d"jsonFileInput" data-dojo-attach-event\x3d"change:readJsonToConfig" accept\x3d".json"\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\x3cbr\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.layerOptionHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkAppendToDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.AppendDefHeading}\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"slAppendChoice" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"OR"\x3e${nls.inputs.optionOR}\x3c/option\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"AND"\x3e${nls.inputs.optionAND}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkPersistDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.PersistDefHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\r\n\t\x3cdiv class\x3d"buttonContainer"\x3e\r\n\t\t\x3ctable class\x3d"buttonContainerTable" border\x3d0\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"filter-add-criteria"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnCriteria" data-dojo-attach-event\x3d"click:btnNewRowAction"\x3e${nls.buttons.addCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3ctable class\x3d"buttonContainerSubtable" border\x3d0\x3e\r\n\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-apply"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"click:setFilterLayerDef"\x3e${nls.buttons.applyCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-cancel"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnReset" data-dojo-attach-event\x3d"click:resetLayerDef"\x3e${nls.buttons.removeCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/css/style.css":'.jimu-widget-map-filter {width:100%; height:100%;}.jimu-widget-map-filter .groupContainer {display: block;}.jimu-widget-map-filter .container {border-color: #e1e1e1; border-top: 3px solid; width: 100%; height: 60%; position:relative; overflow-y: auto; overflow-x: auto; display: block;}.jimu-widget-map-filter .saveContainer {width: 100%; height: 100%; position:absolute; top: 0px; left: 0px; z-index: 999; overflow-y: auto; overflow-x: auto; display: none;}.jimu-widget-map-filter .save-block {position: absolute; left: 5px; top: 5px;}.jimu-widget-map-filter .close-save {position:relative; float: right; content: url("../images/setting_default.png"); padding-right: 5px; padding-bottom: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .close-save:after {position:relative; float: right; content: url("../images/setting_default.png"); padding-right: 5px; padding-bottom: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .headerTable {width: 100%;}.jimu-widget-map-filter .groupHeader {font-size: 10pt; padding-left: 0px; padding-bottom: 5px; width: 100%;}.jimu-widget-map-filter .saveTD {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTD:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose:after {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .group-picker {padding-bottom: 5px;}.jimu-widget-map-filter .filter-block {position: absolute; left: 0px; top: 5px;}.jimu-widget-map-filter .filter-row {position: relative; width: 100%;}.jimu-widget-map-filter .tableFormat {table-layout: fixed; width:99%;}.jimu-widget-map-filter .rowHeader {color: #000000; font-weight:bold;}.jimu-widget-map-filter .saveFunction {margin-top: 5px;}.jimu-widget-map-filter .tableRow {background-color: #E3E3E3;}.jimu-widget-map-filter .tdOperatorHide {display: block; width: 75px;}.jimu-widget-map-filter .operatorSelect {}.jimu-widget-map-filter .tdValue {width: 200px; height: 20px; padding-left: 5px;}.jimu-widget-map-filter .userInputNormal {width: 95%;}.jimu-widget-map-filter .tdConjunction {width: 75px;}.jimu-widget-map-filter .conjuncSelect {width: 70px;}.jimu-widget-map-filter .tdRemove {width: 16px; text-align: right;}.jimu-widget-map-filter .tdFirstLabel {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdLabel {text-align: left; padding-left: 5px; padding-top: 15px; padding-bottom: 2px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdData {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 5px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdUploadData {text-align: left; padding-left: 5px; padding-top: 10px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdSave {text-align: right; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .loadProgressHeader {display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow:after {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .advModeOffset {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeOffset:after {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeClose {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeClose:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeOpen {content: url(""); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .deleteCell {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:after {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:hover {content: url("../images/delete_hover.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .buttonContainer {position: absolute; left: 0px; bottom: 0px; width: 100%;}.jimu-widget-map-filter .buttonContainerTable {width: 100%;}.jimu-widget-map-filter .buttonContainerSubtable {float: right;}.jimu-widget-map-filter .filter-add-criteria {text-align: left;}.jimu-widget-map-filter .filter-button-apply {text-align: right; padding-right: 5px;}.jimu-widget-map-filter .filter-button-cancel {text-align: right;}.jimu-widget-map-filter .criteriaCellSize {width: 90%; vertical-align: top; padding-top: 5px; padding-left: 2px;}.jimu-widget-map-filter .deleteCellSize {width: 20px; text-align: right; vertical-align: top; padding-top: 5px;}.jimu-widget-map-filter .hide-items {display: none;}.jimu-widget-map-filter .operator-class {}.jimu-widget-map-filter .value-class {}',
"*now":function(l){l(['dojo/i18n!*preload*widgets/GroupFilter/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","hr","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit jimu/dijit/FilterParameters dojo/dom dojo/dom-construct dojo/dom-class dojo/dom-attr dojo/dom-style dojo/on dojo/query dojo/string dojo/_base/lang dojo/_base/array dojo/date/locale dijit/form/Select dijit/form/TextBox dijit/form/DateTextBox dijit/form/NumberTextBox dijit/registry jimu/LayerInfos/LayerInfos jimu/utils jimu/FilterManager ./SaveJSON ./ReadJSON dojox/html/entities dijit/form/CheckBox".split(" "),function(l,
q,r,s,p,d,b,h,a,m,g,c,n,f,k,y,e,x,v,D,B,E,w,F,G,H,C){return l([r,q],{baseClass:"jimu-widget-map-filter",layerList:null,grpSelect:null,groupCounter:0,defaultDef:null,runTimeConfig:null,useDomain:null,useDate:null,useValue:null,runInitial:!1,postCreate:function(){this.inherited(arguments);this.defaultDef=[]},startup:function(){this.inherited(arguments);this.config.optionsMode&&h.add(this.optionsIcon,"hide-items");""!==this.config.groups[0].defaultVal&&""!==this.config.groups[0].operator&&(this.runInitial=
!0);this.createMapLayerList()},btnNewRowAction:function(){this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},createMapLayerList:function(){E.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(a){a._layerInfos&&0<a._layerInfos.length&&(this.layerList=a._layerInfos,k.forEach(this.layerList,f.hitch(this,function(a){"ArcGISTiledMapServiceLayer"!==a.originOperLayer.layerType&&"undefined"===typeof a.originOperLayer.featureCollection&&("undefined"!==typeof a.layerObject._defnExpr?
this.defaultDef.push({layer:a.id,definition:a.layerObject._defnExpr,visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.defaultDefinitionExpression&&"function"===typeof a.layerObject.getDefinitionExpression()?this.defaultDef.push({layer:a.id,definition:a.layerObject.getDefinitionExpression(),visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.layerDefinitions?this.defaultDef.push({layer:a.id,definition:a.layerObject.layerDefinitions,visible:a._visible}):this.defaultDef.push({layer:a.id,
definition:"1\x3d1",visible:a.layerObject.visible}))})),this.createGroupSelection())}))},checkDomainUse:function(a){this.useValue=this.useDomain=null;k.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&k.forEach(b.layers,f.hitch(this,function(a){k.forEach(this.layerList,f.hitch(this,function(b){a.layer===b.id&&k.forEach(b.layerObject.fields,f.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain,"undefined"!==typeof b.domain&&(this.useDomain=b.domain))}))}))}))}))},
checkDateUse:function(a){this.useDate=null;k.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&k.forEach(b.layers,f.hitch(this,function(a){k.forEach(this.layerList,f.hitch(this,function(b){a.layer===b.id&&k.forEach(b.layerObject.fields,f.hitch(this,function(b){b.name===a.field&&0<=b.type.indexOf("Date")&&(this.useDate=!0)}))}))}))}))},createGroupSelection:function(){var a=[],b="";k.forEach(this.config.groups,f.hitch(this,function(b){var c={};c.value=b.name;c.label=b.name;c.selected=
!1;a.push(c)}));this.grpSelect=(new e({options:a})).placeAt(this.groupPicker);this.grpSelect.startup();this.own(g(this.grpSelect,"change",f.hitch(this,function(a){this.resetLayerDef();this.removeAllRows();this.checkDomainUse({group:a});this.checkDateUse({group:a});this.reconstructRows(a);this.updateGroupDesc(a);setTimeout(f.hitch(this,this.setFilterLayerDef),500)})));this.checkDomainUse({group:this.grpSelect.value});this.checkDateUse({group:this.grpSelect.value});"undefined"!==typeof this.config.groups[0]&&
(b=this.config.groups[0].desc,this.groupDesc.innerHTML=b);var b=this.checkDefaultValue(this.config.groups[0]),c=this.checkDefaultOperator(this.config.groups[0]);this.createNewRow({operator:c,value:b,conjunc:"OR",state:"new"})},createNewRow:function(a){var e=d.byId("tblPredicates"),u;"new"===a.state&&(1<e.rows.length?(u=e.rows[e.rows.length-1].cells[0].firstChild,u=u.rows[2].cells[0],this.createConditionSelection(u,a)):1===e.rows.length&&(u=e.rows[e.rows.length-1].cells[0].firstChild,u=u.rows[2].cells[0],
this.createConditionSelection(u,a)));u=e.insertRow(-1);var k=u.insertCell(0),l=u.insertCell(1);h.add(k,"criteriaCellSize");h.add(l,"deleteCellSize");var A=b.create("table",{border:"0",width:"100%"},k),k=A.insertRow(-1),I=k.insertCell(0),g=A.insertRow(-1).insertCell(0),A=A.insertRow(-1).insertCell(0);m.set(A,{paddingLeft:"3px",paddingRight:"3px"});h.add(k,"operator-class");this.colorRows();this.createOperatorSelection(I,a);this.removeTableRow(l,u,e.rows.length);this.createInputFilter(g,a);this.resize();
this.config.simpleMode&&(h.add(this.btnCriteria,"hide-items"),h.add(k,"hide-items"),c(".container").style("borderTop","0px"),m.set(g,{paddingLeft:"0px",paddingRight:"0px"}));"reload"===a.state?""!==a.conjunc&&(u=e.rows[e.rows.length-1].cells[0].firstChild,u=u.rows[2].cells[0],this.createConditionSelection(u,a)):this.runInitial&&(this.runInitial=!1,setTimeout(f.hitch(this,this.setFilterLayerDef),500))},colorRows:function(){var a=d.byId("tblPredicates").rows;k.forEach(a,function(a,b){0===b%2?h.remove(a,
"tableRow"):h.add(a,"tableRow")})},createOperatorSelection:function(a,b){var c=(new e({options:[{value:"\x3d",label:this.nls.inputs.optionEQUAL},{value:"\x3c\x3e",label:this.nls.inputs.optionNOTEQUAL},{value:"\x3e",label:this.nls.inputs.optionGREATERTHAN},{value:"\x3e\x3d",label:this.nls.inputs.optionGREATERTHANEQUAL},{value:"\x3c",label:this.nls.inputs.optionLESSTHAN},{value:"\x3c\x3d",label:this.nls.inputs.optionLESSTHANEQUAL},{value:"START",label:this.nls.inputs.optionSTART},{value:"END",label:this.nls.inputs.optionEND},
{value:"LIKE",label:this.nls.inputs.optionLIKE},{value:"NOT LIKE",label:this.nls.inputs.optionNOTLIKE}],"class":"operatorSelect"})).placeAt(a);c.startup();c.set("value",C.decode(b.operator));this.own(g(c,"click",f.hitch(this,function(){})));this.own(g(c,"change",f.hitch(this,function(){})))},createInputFilter:function(a,c){b.empty(a);if(null!==this.useDomain)if("undefined"!==typeof this.useDomain.codedValues){var d=new p;d.placeAt(a);d.startup();this.createValueList(c,d)}else d="",""!==c.value&&(d=
Number(c.value)),(new D({value:d,placeHolder:n.substitute(this.nls.inputs.textboxNumber,{"0":this.useDomain.minValue,1:this.useDomain.maxValue}),"class":"userInputNormal",constraints:{min:this.useDomain.minValue,max:this.useDomain.maxValue}})).placeAt(a).startup(),this.formatSpacing(a);else!0===this.useDate?(d=new Date,d=d.getMonth()+1+"-"+d.getDate()+"-"+d.getFullYear(),""!==c.value&&(d=c.value),(new v({value:d,placeHolder:d,"class":"userInputNormal"})).placeAt(a).startup(),this.formatSpacing(a)):
!0===this.useValue?(d=new p,d.placeAt(a),d.startup(),this.createValueList(c,d)):((new x({value:c.value,placeHolder:this.nls.inputs.textboxText,"class":"userInputNormal"})).placeAt(a).startup(),this.formatSpacing(a))},createValueList:function(b,d){var e={},h=[];k.forEach(this.config.groups,f.hitch(this,function(l){l.name===this.grpSelect.value&&k.forEach(l.layers,f.hitch(this,function(l){k.forEach(this.layerList,f.hitch(this,function(f){if(l.layer===f.id&&!0===l.useDomain){var g={fieldObj:{}};g.fieldObj.name=
l.field;g.fieldObj.label=l.field;g.fieldObj.shortType=l.dataType.replace("esriFieldType","").toLowerCase();if("guid"!==g.fieldObj.shortType||"globalid"!==g.fieldObj.shortType)g.fieldObj.shortType="string";"date"!==g.fieldObj.shortType&&"string"!==g.fieldObj.shortType&&(g.fieldObj.shortType="number");g.fieldObj.type=l.dataType;g.operator=g.fieldObj.shortType+"OperatorIs";g.valueObj={};g.valueObj.isValid=!0;g.valueObj.type="unique";g.valueObj.value=b.value;g.interactiveObj={};g.interactiveObj.prompt=
"";g.interactiveObj.hint="";g.caseSensitive=!1;h.push(g);e.logicalOperator="OR";e.expr="";e.parts=h;d.build(f.layerObject.url,f.layerObject,e);f=c(".jimu-single-filter-parameter");k.forEach(f,function(b){var d=c("table",b);k.forEach(d,function(b){a.set(b,"cellpadding","1");a.set(b,"cellspacing","1")});b=c("colgroup",b);0<b.length&&a.set(b[0].childNodes[1],"width","0px")})}}))}))}))},formatSpacing:function(a){m.set(a,{paddingLeft:"2px",paddingRight:"2px"})},createConditionSelection:function(a,c){b.empty(a);
var d=(new e({options:[{value:"OR",label:this.nls.inputs.optionOR},{value:"AND",label:this.nls.inputs.optionAND}],"class":"conjuncSelect"})).placeAt(a);d.startup();d.set("value",c.conjunc)},removeTableRow:function(a,c,e){1<e&&(e=b.create("div",{"class":"deleteCell",innerHTML:""}),this.own(g(e,"click",f.hitch(this,function(){b.destroy(c);var a=d.byId("tblPredicates");1<=a.rows.length&&b.empty(a.rows[a.rows.length-1].cells[0].firstChild.rows[2].cells[0]);this.colorRows()}))),b.place(e,a))},removeAllRows:function(){var a=
d.byId("tblPredicates");if(1<=a.rows.length){var c=B.byNode(a.rows[0].cells[0].firstChild.rows[1].cells[0].childNodes[0]);"undefined"!==typeof c&&s.byId(c.id).destroyRecursive(!0);b.destroy(a.rows[0]);this.removeAllRows()}},reconstructRows:function(a){""!==a?k.forEach(this.config.groups,f.hitch(this,function(b){if(b.name===a){var c="",d="\x3d";"undefined"!==typeof b.def?0<b.def.length?k.forEach(b.def,f.hitch(this,function(a){this.createNewRow({value:a.value,operator:a.operator,conjunc:a.conjunc,state:"reload"})})):
(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"}))}})):this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},checkDefaultValue:function(a){var b="";""!==a.defaultVal&&(b=a.defaultVal);return b},checkDefaultOperator:function(a){var b="\x3d";""!==a.operator&&(b=a.operator);return b},
parseTable:function(){var a=[],b=d.byId("tblPredicates").rows;k.forEach(b,f.hitch(this,function(b,c){if(0<=c){var d=b.cells[0].firstChild,f=B.byNode(d.rows[0].cells[0].childNodes[0]),e=B.byNode(d.rows[1].cells[0].childNodes[0]),k={};"undefined"!==typeof d.rows[2].cells[0].childNodes[0]?k=B.byNode(d.rows[2].cells[0].childNodes[0]):k.value="";d="";"undefined"!==typeof e.partsObj?null!==e.getFilterExpr()&&(d=e.partsObj.parts[0].valueObj.value):d=e.value;a.push({operator:f.value,userValue:d,conjunc:k.value})}}));
return a},setFilterLayerDef:function(){var a=function(a,b,c,d,e){d=C.decode(d.replace(/'/g,"''"));if(""===d)return"\x3c\x3e"===c||"NOT LIKE"===c?[b,"\x3c\x3e '' OR",b,"IS NOT NULL",e].join(" ")+" ":[b,"\x3d '' OR",b,"IS NULL",e].join(" ")+" ";"LIKE"===c||"NOT LIKE"===c?(d="UPPER('%"+d+"%')",b="UPPER("+b+")"):"START"===c?(c="LIKE",d="UPPER('"+d+"%')",b="UPPER("+b+")"):"END"===c?(c="LIKE",d="UPPER('%"+d+"')",b="UPPER("+b+")"):!1===a&&(a=Date.parse(d),!0===isNaN(a)?(d="UPPER('"+d+"')",b="UPPER("+b+")"):
d="'"+d+"'");return[b,c,d,e].join(" ")+" "},b=this.parseTable();k.forEach(this.layerList,f.hitch(this,function(c){k.forEach(this.config.groups,f.hitch(this,function(d){if(this.grpSelect.value===d.name){var e=[];k.forEach(d.layers,f.hitch(this,function(h){var g="",l="";if(c.id===h.layer)d.def=[],l="FeatureLayer",k.forEach(b,f.hitch(this,function(b){k.forEach(c.layerObject.fields,f.hitch(this,function(c){c.name===h.field&&(-1<c.type.indexOf("Integer")||-1<c.type.indexOf("Double")?g+=a(!0,h.field,b.operator,
w.sanitizeHTML(b.userValue),b.conjunc):-1<c.type.indexOf("Date")?""!==b.userValue?(c=new Date(w.sanitizeHTML(b.userValue)),g+=a(!1,h.field,b.operator,y.format(c,{datePattern:"MMMM d, yyyy",selector:"date"}),b.conjunc)):g+=a(!1,h.field,b.operator,w.sanitizeHTML(b.userValue),b.conjunc):g+=a(!1,h.field,b.operator,w.sanitizeHTML(b.userValue),b.conjunc),d.def.push({value:w.sanitizeHTML(b.userValue),operator:b.operator,conjunc:b.conjunc}))}))}));else if(0<=h.layer.indexOf(c.id)){d.def=[];var l="MapService",
m=h.layer.split(".");k.forEach(b,f.hitch(this,function(b){if(""!==b.userValue)if(-1<h.dataType.indexOf("Integer")||-1<h.dataType.indexOf("Double"))g+=a(!0,h.field,b.operator,w.sanitizeHTML(b.userValue),b.conjunc);else if(-1<h.dataType.indexOf("Date"))if(""!==b.userValue){var c=new Date(w.sanitizeHTML(b.userValue));g+=a(!1,h.field,b.operator,y.format(c,{datePattern:"MMMM d, yyyy",selector:"date"}),b.conjunc)}else g+=a(!1,h.field,b.operator,w.sanitizeHTML(b.userValue),b.conjunc);else g+=a(!1,h.field,
b.operator,w.sanitizeHTML(b.userValue),b.conjunc);else g+=a(!1,h.field,b.operator,w.sanitizeHTML(b.userValue),b.conjunc);d.def.push({value:w.sanitizeHTML(b.userValue),operator:b.operator,conjunc:b.conjunc})}));""!==g&&(e[m[1]]=g.trim())}"FeatureLayer"===l?(console.log(g),""!==g&&(this.chkAppendToDef.checked?k.forEach(this.defaultDef,f.hitch(this,function(a){a.layer===c.id&&(a=a.definition+" "+this.slAppendChoice.value+" "+g.trim(),this._applyFilter(c.layerObject,a))})):this._applyFilter(c.layerObject,
g.trim()),c.layerObject.setVisibility(!0))):"MapService"===l&&(console.log(e),0<e.length&&(this.chkAppendToDef.checked?k.forEach(this.defaultDef,f.hitch(this,function(a){a.layer===c.id&&(k.forEach(e,f.hitch(this,function(b,c){for(var d in a.definition)"undefined"!==a.definition[d]&&e[c.toString()]&&(e[c.toString()]=a.definition[d]+" "+this.slAppendChoice.value+" "+b,console.log(b))})),console.log(e),c.layerObject.setLayerDefinitions(e))})):c.layerObject.setLayerDefinitions(e),c.layerObject.setVisibility(!0)))}));
this._publishData(d)}}))}))},resetLayerDef:function(){k.forEach(this.layerList,f.hitch(this,function(a){k.forEach(this.defaultDef,f.hitch(this,function(b){b.layer===a.id&&("undefined"!==typeof a.layerObject.defaultDefinitionExpression?this._applyFilter(a.layerObject,b.definition):"undefined"!==typeof a.layerObject.layerDefinitions?a.layerObject.setLayerDefinitions(b.definition):this._applyFilter(a.layerObject,b.definition),a.layerObject.setVisibility(b.visible))}))}))},updateGroupDesc:function(a){k.forEach(this.config.groups,
f.hitch(this,function(b){b.name===a&&(this.groupDesc.innerHTML=b.desc)}))},toggleSaveFilter:function(){var a;0<c(".saveTD").length?(a=c(".container"),0<a.length&&(h.replace(d.byId("saveTD"),"saveTDClose","saveTD"),a.style("display","none"),c(".saveContainer").style("display","block"),c(".groupContainer").style("display","none"),c(".buttonContainer").style("display","none"))):(a=c(".saveTDClose"),0<a.length&&(h.replace(a[0],"saveTD","saveTDClose"),a=c(".container"),0<a.length&&(h.replace(d.byId("saveTD"),
"saveTD","saveTDClose"),a.style("display","block"),c(".saveContainer").style("display","none"),c(".groupContainer").style("display","block"),c(".buttonContainer").style("display","block"))))},saveJsonToFile:function(){var a=new G({config:this.config});this.own(g(a,"complete",f.hitch(this,function(){console.log("save done")})));a.exportsJson(this.nls.files.jsonFile+".json",this.config)},readJsonToConfig:function(){c(".loadProgressHeader").style("display","block");c(".loadProgressShow").style("display",
"block");var a=new H({config:this.config,jsonFile:this.jsonFileInput.files});this.own(g(a,"complete",f.hitch(this,function(a){this.config=JSON.parse(a.UserSettings);this.resetLayerDef();this.removeAllRows();this.checkDomainUse({group:this.grpSelect.value});this.checkDateUse({group:this.grpSelect.value});this.reconstructRows(this.grpSelect.value);this.updateGroupDesc(this.grpSelect.value);setTimeout(f.hitch(this,this.setFilterLayerDef),500);c(".loadProgressHeader").style("display","none");c(".loadProgressShow").style("display",
"none");this.jsonFileInput.value=null;this.toggleSaveFilter()})));this.own(g(a,"error",f.hitch(this,function(){this.jsonFileInput.value=null;c(".loadProgressHeader").style("display","none");c(".loadProgressShow").style("display","none")})));a.checkFileReader()},_publishData:function(a){this.publishData({message:a})},resize:function(){var b=c(".jimu-single-filter-parameter");0<b.length&&k.forEach(b,f.hitch(this,function(b){b=c("colgroup",b);0<b.length&&a.set(b[0].childNodes[1],"width","0px")}));320>=
window.innerWidth?(h.add(this.btnCriteria,"hide-items"),c(".operator-class").style("display","none"),c(".container").style("borderTop","0px"),c(".value-class").style("paddingTop","-10px")):this.config.simpleMode||(h.remove(this.btnCriteria,"hide-items"),c(".operator-class").style("display","block"),c(".container").style("borderTop","3px solid"),c(".value-class").style("paddingTop","0px"))},_applyFilter:function(a,b){F.getInstance().applyWidgetFilter(a.id,this.id,b)},onOpen:function(){console.log("onOpen")},
onClose:function(){this.chkPersistDef.checked||(this.resetLayerDef(),this.removeAllRows(),this.reconstructRows(""))},onMinimize:function(){console.log("onMinimize")},onMaximize:function(){console.log("onMaximize")},onSignIn:function(a){console.log("onSignIn")},onSignOut:function(){console.log("onSignOut")}})});