// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/InfoSummary/setting/MySymbolPicker.html":'\x3cdiv style\x3d"width: 100%;"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tabParent"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"symbolPickerContainer" class\x3d"symbolPickerContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"div_symbolOptionsContainer" class\x3d"symbolOptionsContainer"\x3e\r\n        \x3cdiv class\x3d"label iconOptionsText"\x3e\r\n          ${nls.symbolOptionsText}\r\n        \x3c/div\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_symbolOptions" class\x3d"symbolOptions"\x3e\r\n          \x3c!--Symbol Options--\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10"\r\n               data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_rdoLayerSym" class\x3d"height30"\x3e\r\n              \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton"\r\n                     data-dojo-attach-point\x3d"rdoLayerSym"\r\n                     data-dojo-attach-event\x3d"onChange:_rdoLayerSymChanged"\r\n                     title\x3d"${nls.rdoLayer}" /\x3e\r\n              \x3cspan class\x3d"label"\x3e${nls.rdoLayer}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"jimu-r-row symPick marginLR20" data-dojo-attach-point\x3d"layerSym"\x3e \x3c/div\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_rdoEsriSym" class\x3d"height30"\x3e\r\n              \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoEsriSym" data-dojo-attach-event\x3d"onChange:_rdoEsriSymChanged" title\x3d"${nls.rdoEsri}" /\x3e\r\n              \x3cspan class\x3d"label"\x3e${nls.rdoEsri}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"symbolPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" class\x3d"jimu-r-row symPick marginLR20"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"parent_div_uploadCustomSymbol"\x3e\r\n            \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"div_rdoCustomSym" class\x3d"rdoCustomSym"\x3e\r\n                \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoCustomSym" data-dojo-attach-event\x3d"onChange:_rdoCustomSymChanged" title\x3d"${nls.rdoCustom}" /\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.rdoCustom}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"customSymbolDIV" class\x3d"jimu-r-row padTop10 sHeight marginLR20"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"uploadCustomSymbol" class\x3d"uploadCustom"\x3e\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"customSymbolPlaceholder" class\x3d"customPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3c!--Clustering Options--\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"parent_div_clusterOptions" class\x3d"clusterOptions"\x3e\r\n            \x3chr class\x3d"w" /\x3e\r\n            \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpClusterOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"div_chkCluster" class\x3d"padTop20"\x3e\r\n                \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chkClusterSym" title\x3d"${nls.chkCluster}" data-dojo-attach-event\x3d"onChange:_chkClusterChanged" /\x3e\r\n                \x3cspan class\x3d"label"\x3e${nls.chkCluster}\x3c/span\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"clusterPickerContainer" class\x3d"jimu-r-row marginLR22 grpClusterOptions"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading"\x3e${nls.defineClusterSymbol}:\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"clusterPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" class\x3d"jimu-float-trailing colorPick"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"jimu-r-row grpClusterOptions marginLR22" data-dojo-attach-point\x3d"grpClusterOptions"\x3e\r\n              \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chkClusterCnt" title\x3d"${nls.displayClusterCnt}" data-dojo-attach-event\x3d"onChange:_chkClusterCntChanged" /\x3e\r\n              \x3cspan class\x3d"label"\x3e${nls.displayClusterCnt}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"jimu-r-row grpClusterOptions" data-dojo-attach-point\x3d"featureFont" style\x3d"display: none; margin-left: 45px; margin-right: 45px;"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading"\x3e${nls.defineClusterFont}:\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"colorPicker" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-dojo-props\x3d\'color:"${_highLightColor}"\' class\x3d"marginLR30 colorPick2 jimu-float-trailing"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"label iconOptionsText padTop20"\x3e\r\n          ${nls.iconOptionsText}\r\n        \x3c/div\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_iconOptions" class\x3d"iconOptions"\x3e\r\n          \x3c!--Main Panel and cluster center Icon Options--\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpIconOptions"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_rdoLayerIcon"\x3e\r\n              \x3cinput name\x3d"b" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoLayerIcon" data-dojo-attach-event\x3d"onChange:_rdoLayerIconChanged" title\x3d"${nls.rdoLayerIcon}" /\x3e\r\n              \x3cspan class\x3d"label"\x3e${nls.rdoLayerIcon}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpCustomIconOptions"\x3e\r\n            \x3cdiv class\x3d"rdoCustomSym" data-dojo-attach-point\x3d"div_rdoCustomIcon"\x3e\r\n              \x3cinput name\x3d"b" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-attach-point\x3d"rdoCustomIcon" data-dojo-attach-event\x3d"onChange:_rdoCustomIconChanged" title\x3d"${nls.rdoCustomIcon}" /\x3e\r\n              \x3cspan class\x3d"label"\x3e${nls.rdoCustomIcon}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10 sHeight marginLR30"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"uploadCustomIcon" class\x3d"uploadCustom"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"customIconPlaceholder" class\x3d"customPlaceholder"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cinput type\x3d"file"\r\n               accept\x3d"image/png, image/jpeg, image/bmp, image/gif"\r\n               data-dojo-attach-point\x3d"fileInput"\r\n               class\x3d"fileInput"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"panelFeatureDisplayContainer" class\x3d"panelFeatureContainer"\x3e\r\n      \x3cdiv class\x3d"label iconOptionsText padTop10"\x3e\r\n        ${nls.featureOptionsText}\r\n      \x3c/div\x3e\r\n      \x3chr /\x3e\r\n      \x3cdiv class\x3d"btn-add-section enable" data-dojo-attach-point\x3d"btnAddField"\x3e\r\n        \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"btn-add-label"\x3e${nls.addField}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldOptions" class\x3d"fieldOptions"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"label iconOptionsText padTop20"\x3e\r\n        ${nls.groupOptionsText}\r\n      \x3c/div\x3e\r\n      \x3chr /\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"groupOptions" class\x3d"groupOptions"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_chkGroup"\x3e\r\n          \x3cinput data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-attach-point\x3d"chkGroup" title\x3d"${nls.chkGroup}" data-dojo-attach-event\x3d"onChange:_chkGroupChanged" /\x3e\r\n          \x3cspan class\x3d"label"\x3e${nls.chkGroup}\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"groupFieldOptions" class\x3d"groupFieldOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--Footer--\x3e\r\n  \x3cdiv class\x3d"footer padTop20"\x3e\r\n    \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/Select dijit/form/ValidationTextBox dojo/_base/lang dojo/_base/html dojo/dom-style dojo/dom-construct dojo/on dojo/dom dojox/gfx dojo/query dojo/_base/Color dijit/registry esri/symbols/jsonUtils esri/request jimu/dijit/SymbolPicker jimu/BaseWidget jimu/dijit/TabContainer3 jimu/utils jimu/dijit/SimpleTable jimu/dijit/Message jimu/dijit/ColorPicker dojo/_base/array esri/symbols/PictureMarkerSymbol dojo/text!./MySymbolPicker.html dojo/Evented".split(" "),
function(u,v,w,x,g,d,k,m,h,G,q,r,y,H,l,I,J,z,A,s,t,B,K,C,D,E,F){return u([z,v,F],{templateString:E,baseClass:"jimu-widget-InfoSummary-setting",nls:null,row:null,layerInfo:null,clusteringEnabled:null,symbolInfo:null,symbolType:"",map:null,supportsDynamic:!0,tabContainer:null,field_options:[],groupFeaturesEnabled:!1,lyrSymbolSet:[],_highLightColor:"#ffffff",panelHTML:null,svg:null,constructor:function(a){this.nls=a.nls;this.row=a.callerRow;this.layerInfo=a.layerInfo;this.renderer=a.layerInfo.renderer;
this.geometryType=a.layerInfo.geometryType;this.symbolInfo=a.symbolInfo;this.map=a.map;this.ac=a.ac;this.layerId=a.value;this.supportsDynamic=a.layerInfo.supportsDynamic;this.fields=a.layerInfo.fields},postMixInProperties:function(){this.inherited(arguments);this.nls.common=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this._setFields(this.fields);this._initTabControl();this._initSymbolPickerTab(this.geometryType);this._initFeatureOptionsTab();this.own(h(this.btnAddField,
"click",g.hitch(this,this._addFieldRow,this.fieldOptionsTable,"loSelect")))},_setFields:function(a){if(a){this.field_options=[];for(var b=[""," ",void 0,null],c=0;c<a.length;c++)this.field_options.push({value:a[c].name,label:-1===b.indexOf(a[c].alias)?a[c].alias:a[c].name})}},_initTabControl:function(){this.tabContainer=new A({tabs:[{title:this.nls.symbolOptions,content:this.symbolPickerContainer},{title:this.nls.panelFeatureDisplay,content:this.panelFeatureDisplayContainer}],isNested:!0},this.tabParent);
this.tabContainer.startup()},_initSymbolPickerTab:function(a){a=s.getTypeByGeometryType(a);this._loadLayerSymbol();this.supportsDynamic&&this._initSymbolPicker(a);this._initClusterSymbolPicker(a);this._addEventHandlers(a);this._initUI()},_initFeatureOptionsTab:function(){this.isInitalLoad=!0;this.fieldLoadCount=0;this.fieldOptionsTable=new t({fields:[{name:"field",title:this.nls.selectField,"class":"label",type:"empty",width:"100px"},{name:"label","class":"label",title:this.nls.fieldLabel,type:"empty",
width:"100px"},{name:"actions","class":"label",title:this.nls.actions,type:"actions",actions:["up","down","delete"],width:"50px"}],selectable:!1,autoHeight:!0});this.fieldOptionsTable.placeAt(this.fieldOptions);this.fieldOptionsTable.startup();this.fieldOptionsTable.on("row-delete",g.hitch(this,this._rowDeleted));this.groupOptionsTable=new t({fields:[{name:"field",title:this.nls.selectField,"class":"label",type:"empty",width:"160px"},{name:"label","class":"label",title:this.nls.fieldLabel,type:"empty",
width:"160px"}],selectable:!1,autoHeight:!0});this.groupOptionsTable.placeAt(this.groupFieldOptions);this.groupOptionsTable.startup();if(this.symbolInfo&&this.symbolInfo.featureDisplayOptions&&this.symbolInfo.featureDisplayOptions.fields){var a=this.symbolInfo.featureDisplayOptions;this.groupFeaturesEnabled=a.groupEnabled;this.chkGroup.set("checked",this.groupFeaturesEnabled);for(var b=0;b<a.fields.length;b++)this._populateLayerRow(this.fieldOptionsTable,a.fields[b],"loSelect");this._populateLayerRow(this.groupOptionsTable,
a.groupField,"goSelect")}else this._addFieldRow(this.groupOptionsTable,"goSelect");this.isInitalLoad=!1},_rowDeleted:function(a){3>this.fieldOptionsTable.getRows().length&&(d.removeClass(this.btnAddField,"btn-add-section-disabled"),d.addClass(this.btnAddField,"btn-add-section"))},_populateLayerRow:function(a,b,c){this.fieldLoadCount+=1;a=a.addRow({});a.success&&a.tr&&(a=a.tr,this._addFieldsOption(a,c),this._addLabelOption(a),a.selectFields.set("value",b.name),a.labelText.set("value",b.label))},_addFieldRow:function(a,
b){if(a===this.fieldOptionsTable&&3<=a.getRows().length)d.removeClass(this.btnAddField,"btn-add-section"),d.addClass(this.btnAddField,"btn-add-section-disabled"),new B({message:this.nls.max_records});else{this.isInitalLoad=!1;var c=a.addRow({});c.success&&c.tr&&(c=c.tr,this._addFieldsOption(c,b),this._addLabelOption(c))}},_addFieldsOption:function(a,b){var c=g.clone(this.field_options),f=r(".simple-table-cell",a)[0];f&&(d.setStyle(f,"verticalAlign","middle"),d.setStyle(f,"line-height","inherit"),
c=new w({style:{width:"100%",height:"28px"},"class":b,options:c}),c.placeAt(f),c.startup(),a.selectFields=c,this.own(h(c,"change",g.hitch(this,function(){this.fieldLoadCount&&0<this.fieldLoadCount?this.fieldLoadCount-=1:a.labelText.set("value","");a.cells[0].title=a.cells[0].innerText}))),a.cells[0].title=a.cells[0].innerText)},_addLabelOption:function(a){var b=r(".simple-table-cell",a)[1];d.setStyle(b,"verticalAlign","middle");d.setStyle(b,"line-height","inherit");var c=new x({style:{width:"100%",
height:"28px"}});c.placeAt(b);c.startup();a.labelText=c},_initUI:function(){if("undefined"!==typeof this.symbolInfo){this.symbolType=this.symbolInfo.symbolType;this.clusterType=this.symbolInfo.clusterType;this.iconType=this.symbolInfo.iconType;this.displayFeatureCount=this.symbolInfo.displayFeatureCount;this.clusteringEnabled=this.symbolInfo.clusteringEnabled;this.userDefinedSymbol=this.symbolInfo.userDefinedSymbol;this._highLightColor=this.symbolInfo._highLightColor;switch(this.symbolInfo.symbolType){case "LayerSymbol":this.symbolInfo.symbolOverride?
(this.userDefinedSymbol=!0,this.rdoEsriSym.set("checked",!0),this._rdoLayerSymChanged(!1),this._rdoCustomSymChanged(!1),this.symbolPicker.showBySymbol(l.fromJson(this.symbolInfo.symbol))):(this.rdoLayerSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoCustomSymChanged(!1));break;case "EsriSymbol":this.userDefinedSymbol=!0;this.rdoEsriSym.set("checked",!0);this._rdoLayerSymChanged(!1);this._rdoCustomSymChanged(!1);this.symbolPicker.showBySymbol(l.fromJson(this.symbolInfo.symbol));break;case "CustomSymbol":this.userDefinedSymbol=
!0,this.rdoCustomSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoLayerSymChanged(!1),this._createImageDataDiv(this.symbolInfo.symbol,!0,this.customSymbolPlaceholder)}switch(this.symbolInfo.clusterType){case "ThemeCluster":this.userDefinedSymbol=!0;this.clusterType="ThemeCluster";break;case "CustomCluster":this.userDefinedSymbol=!0,this.clusterType="CustomCluster",this.chkClusterCnt.set("checked",this.displayFeatureCount),this.colorPicker.setColor(new y(this._highLightColor))}switch(this.symbolInfo.iconType){case "LayerIcon":this.rdoLayerIcon.set("checked",
!0);break;case "CustomIcon":this.userDefinedSymbol=!0,this.rdoCustomIcon.set("checked",!0),this.symbolInfo.icon&&this.resetIcon(this.symbolInfo.icon)}"undefined"!==typeof this.symbolInfo.clusterType&&("CustomCluster"===this.symbolInfo.clusterType&&this.symbolInfo.clusterSymbol&&this.clusterPicker.showBySymbol(l.fromJson(this.symbolInfo.clusterSymbol)),this.userDefinedSymbol=!0);this.chkClusterSym.set("checked",this.symbolInfo.clusteringEnabled);this._chkClusterChanged(this.symbolInfo.clusteringEnabled)}else this.rdoLayerSym.set("checked",
!0),this._rdoEsriSymChanged(!1),this._rdoCustomSymChanged(!1),this.chkClusterSym.set("checked",!1),this.chkClusterCnt.set("checked",!1),this.rdoLayerIcon.set("checked",!0),this._rdoCustomIconChanged(!1),this.symbolType="LayerSymbol",this.iconType="LayerIcon",this.userDefinedSymbol=this.clusteringEnabled=!1;if("esriGeometryPoint"!==this.geometryType||!this.supportsDynamic)k.set(this.parent_div_uploadCustomSymbol,"display","none"),this.supportsDynamic||k.set(this.div_rdoEsriSym,"display","none")},resetIcon:function(a){this.customIconPlaceholder.innerHTML=
"\x3cdiv\x3e\x3c/div\x3e";a=m.create("div",{innerHTML:[a],title:this.nls.editCustomIcon});d.addClass(a.firstChild,"customPlaceholder");this.customIconPlaceholder.innerHTML=a.innerHTML},_addEventHandlers:function(a){"point"===a&&this.own(h(this.uploadCustomSymbol,"click",g.hitch(this,function(){this._editIcon("Symbol")})));this.own(h(this.uploadCustomIcon,"click",g.hitch(this,function(){this._editIcon("Icon")})));this.btnOk.innerText=this.nls.common.ok;this.own(h(this.btnOk,"click",g.hitch(this,function(){this._setSymbol();
this.emit("ok",this.symbolInfo)})));this.btnCancel.innerText=this.nls.common.cancel;this.own(h(this.btnCancel,"click",g.hitch(this,function(){this.emit("cancel")})))},_setSymbol:function(){var a;switch(this.symbolType){case "LayerSymbol":a=this.symbol;break;case "EsriSymbol":this.userDefinedSymbol=!0;a=this.symbolPicker.getSymbol();break;case "CustomSymbol":this.userDefinedSymbol=!0,0<this.customSymbolPlaceholder.children.length&&(a="undefined"!==typeof this.customSymbolPlaceholder.children[0].src?
new D(this.customSymbolPlaceholder.children[0].src,30,30):l.fromJson(this.symbolInfo.symbol))}var b;"LayerIcon"===this.iconType?b=a:0<this.customIconPlaceholder.children.length&&("undefined"!==typeof this.customIconPlaceholder.innerHTML?(d.removeClass(this.customIconPlaceholder.firstChild,"customPlaceholder"),d.addClass(this.customIconPlaceholder.firstChild,"customPlaceholderSettings"),b=this.customIconPlaceholder.innerHTML):b=l.fromJson(this.symbolInfo.icon));this.clusteringEnabled&&"esriGeometryPoint"===
this.geometryType?(this.clusterSymbol="ThemeCluster"===this.clusterType?"custom":this.clusterPicker.getSymbol().toJson(),this.userDefinedSymbol=!0):(this.clusterSymbol=void 0,this.clusteringEnabled=!1);a&&"undefined"!==typeof a.toJson&&(a=a.toJson());var c;c=0<this.customIconPlaceholder.children.length?this.customIconPlaceholder.children[0].src:0<this.layerSym.children.length?this.layerSym.children[0].innerHTML:this.customIconPlaceholder.outerHTML;"undefined"!==typeof b&&(this._createImageDataDiv2(b,
44,44,!0),this._createImageDataDiv2(b,28,28,!1));this.symbolInfo={symbolType:this.symbolType,symbol:a,clusterSymbol:this.clusterSymbol,clusteringEnabled:this.clusteringEnabled,displayFeatureCount:this.displayFeatureCount,_highLightColor:this.colorPicker.color.toHex(),icon:b,clusterType:this.clusterType,iconType:this.iconType,renderer:this.renderer,s:c,svg:this.svg,panelHTML:this.panelHTML,userDefinedSymbol:this.userDefinedSymbol?this.userDefinedSymbol:!1,layerId:this.layerId,selectedId:this.selectedID,
featureDisplayOptions:{groupEnabled:this.groupFeaturesEnabled,fields:this.fieldOptionsTable?this._getFields(this.fieldOptionsTable):null,groupField:this.groupOptionsTable?this._getFields(this.groupOptionsTable)[0]:null}}},_getFields:function(a){a=a.getRows();var b=[];C.forEach(a,function(a){a.selectFields&&b.push({name:a.selectFields.value,label:a.labelText.value})});return b},_rdoLayerSymChanged:function(a){a&&(this.symbolType="LayerSymbol");d.setStyle(this.layerSym,"display",a?"block":"none")},
_rdoEsriSymChanged:function(a){a&&(this.symbolType="EsriSymbol");d.setStyle(this.symbolPicker.domNode,"display",a?"block":"none")},_rdoCustomSymChanged:function(a){a&&(this.symbolType="CustomSymbol");d.setStyle(this.customSymbolDIV,"display",a?"block":"none")},_chkClusterChanged:function(a){this.clusteringEnabled=a;d.setStyle(this.grpClusterOptions,"display",a?"block":"none");d.setStyle(this.clusterPickerContainer,"display",a?"block":"none");a&&"undefined"===typeof this.clusterType&&(this.clusterType=
"CustomCluster")},_chkClusterCntChanged:function(a){this.displayFeatureCount=a;d.setStyle(this.featureFont,"display",a?"block":"none")},_rdoLayerIconChanged:function(a){a&&(this.iconType="LayerIcon");d.setStyle(this.uploadCustomIcon,"display",!a?"block":"none");d.setStyle(this.customIconPlaceholder,"display",!a?"block":"none")},_rdoCustomIconChanged:function(a){a&&(this.iconType="CustomIcon");d.setStyle(this.uploadCustomIcon,"display",a?"block":"none");d.setStyle(this.customIconPlaceholder,"display",
a?"block":"none")},_initSymbolPicker:function(a){var b="";"point"===a?b="marker":"polyline"===a?b="line":"polygon"===a&&(b="fill");this.symbolPicker.showByType(b)},_initClusterSymbolPicker:function(a){"point"===a&&this.clusterPicker.showByType("fill");k.set(this.parent_div_clusterOptions,"display","point"===a?"block":"none")},_loadLayerSymbol:function(){if("undefined"!==typeof this.renderer){var a=this.renderer,b;"undefined"!==typeof a.symbol?this._createImageDataDiv(a.symbol,!0,this.layerSym):"undefined"!==
typeof a.infos?b=a.infos:"undefined"!==typeof a.uniqueValueInfos?b=a.uniqueValueInfos:"undefined"!==typeof a.classBreakInfos?b=a.classBreakInfos:(this.rdoEsriSym.set("checked",!0),this.symbolType="EsriSymbol",this.iconType="LayerIcon",this._initSymbolPicker(s.getTypeByGeometryType(this.geometryType)),this._setFields(this.fields),this._setSymbol(),this.symbolInfo.symbolType="LayerSymbol",this.symbolInfo.symbolOverride=!0);b&&(this.layerSym.innerHTML="\x3cdiv\x3e\x3c/div\x3e",this.layerSym.appendChild(this._createCombinedImageDataDiv(b)),
d.setStyle(this.layerSym,"cursor","pointer"))}},_createImageDataDiv2:function(a,b,c,f){var d;if("string"===typeof a)d=m.create("div",{"class":"imageDataGFX",innerHTML:a}),f?this.panelHTML=d.innerHTML:this.svg=d;else{var e=l.fromJson(a);e||(e=a);e?(a=c,c=b,e.height&&e.width&&(d=e.width/e.height,e.height>e.width?c=b*d:e.width>e.height&&(a=c/d)),"undefined"!==typeof e.setWidth?"undefined"!==typeof e.setHeight?(e.setWidth(c),e.setHeight(a)):e.setWidth(2):"undefined"!==typeof e.size&&20<e.size&&e.setSize(20),
d=m.create("div",{"class":"imageDataGFX"}),b=q.createSurface(d,c,a),e=l.getShapeDescriptors(e),b.createShape(e.defaultShape).setFill(e.fill).setStroke(e.stroke).applyTransform({dx:c/2,dy:a/2}),f?this.panelHTML=d.innerHTML:this.svg=d):"undefined"!==typeof a.url&&(d=m.create("div",{"class":"imageDataGFX"}),k.set(d,"background-image","url("+a.url+")"),k.set(d,"background-repeat","no-repeat"),f?this.panelHTML=d.innerHTML:this.svg=d)}return d},_createImageDataDiv:function(a,b,c){c=m.create("div",{"class":"imageDataGFX-display"},
c);(b=b?l.fromJson(a):a)||(b=a);this.symbol=b;var d=a=26;b.height&&b.width&&b.height>b.width&&(d=b.width/b.height,a=26,d*=26);var g=q.createSurface(c,d,a);b=l.getShapeDescriptors(this.setSym(b,d,a));g.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke).applyTransform({dx:d/2,dy:a/2});this.svg=c.firstChild;return c},_createCombinedImageDataDiv:function(a){var b=m.create("div",{"class":"imageDataGFXMulti"},this.customSymbolPlaceholder);this.lyrSymbolSet=[];for(var c=this.symbolInfo&&this.symbolInfo.selectedId?
!1:!0,f=0;f<a.length;f++){var n=a[f].symbol,e=l.fromJson(n);e||(e=n);"undefined"===typeof this.symbol&&(this.symbol=e);this.lyrSymbolSet.push(e);var h=n=26;e.height&&e.width&&e.height>e.width&&(h=e.width/e.height,n=26,h*=26);var k=m.create("div",{"class":"imageDataGFX imageDataGFX2",id:"imageGFX_"+f,onclick:g.hitch(this,this.layerSymbolClick)},b),p=q.createSurface(k,h,n),e=l.getShapeDescriptors(this.setSym(e,h,n));p.createShape(e.defaultShape).setFill(e.fill).setStroke(e.stroke).applyTransform({dx:h/
2,dy:n/2});b.insertBefore(k,b.firstChild);b.appendChild(k);if(c||this.symbolInfo&&k.id===this.symbolInfo.selectedId)this.setLayerSymbol(k),c=!1;p.rawNode&&(d.setStyle(p.rawNode,"display","block"),d.setStyle(p.rawNode,"margin","auto"))}return b},layerSymbolClick:function(a){this.setLayerSymbol(a.currentTarget)},setLayerSymbol:function(a){for(var b,c=0;c<a.parentElement.children.length;c++){var f=a.parentElement.children[c];d.removeClass(f,"lyrSymbolSelected");f.id===a.id&&(b=c)}d.addClass(a,"lyrSymbolSelected");
this.selectedID=a.id;this.svg=a;this.panelHTML=a.innerHTML;this.symbol=this.lyrSymbolSet[b]},setSym:function(a,b,c){"undefined"!==typeof a.setWidth?("esriGeometryPoint"===this.geometryType&&a.setWidth(b),"undefined"!==typeof a.setHeight&&a.setHeight(c)):("undefined"!==typeof a.size&&20<a.size&&a.setSize(20),"undefined"!==typeof a.width&&(a.width=b),"undefined"!==typeof a.height&&(a.height=c));return a},_editIcon:function(a){var b=new FileReader;b.onload=g.hitch(this,function(){var c,d;"Symbol"===
a?(c=this.customSymbolPlaceholder,d=this.nls.editCustomSymbol):(c=this.customIconPlaceholder,d=this.nls.editCustomIcon);c.innerHTML="\x3cdiv\x3e\x3c/div\x3e";d=m.create("div",{"class":"customPlaceholder",innerHTML:['\x3cimg class\x3d"customPlaceholder" src\x3d"',b.result,'"/\x3e'].join(""),title:d});c.innerHTML=d.innerHTML});this.fileInput.onchange=g.hitch(this,function(){b.readAsDataURL(this.fileInput.files[0])});this.fileInput.click()},_chkGroupChanged:function(a){this.groupFeaturesEnabled=a;d.setStyle(this.groupFieldOptions,
"display",a?"inline-block":"none")},destroy:function(){this.symbolInfo=null;this.tabContainer.destroyRecursive()}})});